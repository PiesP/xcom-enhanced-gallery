// ==UserScript==
// @name         X.com Enhanced Gallery
// @namespace    https://github.com/piesp/xcom-enhanced-gallery
// @version      0.1.0
// @description  Enhanced media viewer and download functionality for X.com
// @author       PiesP
// @match        https://x.com/*
// @match        https://*.x.com/*
// @grant        GM_registerMenuCommand
// @grant        GM_setValue
// @grant        GM_getValue
// @grant        GM_download
// @grant        GM_openInTab
// @grant        GM_notification
// @connect      pbs.twimg.com
// @connect      video.twimg.com
// @run-at       document-idle
// @supportURL   https://github.com/piesp/xcom-enhanced-gallery/issues
// @downloadURL  https://github.com/piesp/xcom-enhanced-gallery/releases/latest/download/xcom-enhanced-gallery.user.js
// @updateURL    https://github.com/piesp/xcom-enhanced-gallery/releases/latest/download/xcom-enhanced-gallery.user.js
// @noframes
// ==/UserScript==

(function() {
  'use strict';
  
  
(function() {
  if (typeof document === 'undefined') { return; }
  const existingStyle = document.getElementById('xeg-styles');
  if (existingStyle) { existingStyle.remove(); }
  const style = document.createElement('style');
  style.id = 'xeg-styles';
  style.textContent = ":root{--xeg-color-primary:#4785a3;--xeg-color-primary-hover:#5496b8;--xeg-color-primary-dark:#3a6f89;--xeg-color-primary-light:#6ba7c7;--xeg-color-secondary:#64748b;--xeg-color-secondary-hover:#475569;--xeg-color-success:#10b981;--xeg-color-warning:#f59e0b;--xeg-color-error:#dc2626;--xeg-color-info:#4a90b8;--xeg-bg-primary:#fafbfc;--xeg-bg-secondary:#f1f5f9;--xeg-bg-overlay:#0f172af0;--xeg-bg-overlay-light:#0f172a14;--xeg-bg-overlay-medium:#0f172aa6;--xeg-bg-overlay-strong:#0f172ae0;--xeg-bg-overlay-dark:#0f172af5;--xeg-bg-modal:#fffffff5;--xeg-bg-card:#ffffffeb;--xeg-text-primary:#1e293b;--xeg-text-secondary:#475569;--xeg-text-tertiary:#64748b;--xeg-text-inverse:#f8fafc;--xeg-text-muted:#94a3b8;--xeg-border-light:#f3f4f6;--xeg-border-medium:#d1d5db;--xeg-border-dark:#9ca3af;--xeg-bg-dark-primary:#0f172a;--xeg-bg-dark-secondary:#1e293b;--xeg-bg-dark-overlay:#0f172af5;--xeg-bg-dark-modal:#1e293bf2;--xeg-bg-dark-card:#334155eb;--xeg-text-dark-primary:#f1f5f9;--xeg-text-dark-secondary:#cbd5e1;--xeg-text-dark-tertiary:#94a3b8;--xeg-text-dark-inverse:#1e293b;--xeg-text-dark-muted:#64748b;--xeg-border-dark-light:#374151;--xeg-border-dark-medium:#4b5563;--xeg-border-dark-dark:#6b7280;--xeg-spacing-xs:4px;--xeg-spacing-sm:8px;--xeg-spacing-md:16px;--xeg-spacing-lg:24px;--xeg-spacing-xl:32px;--xeg-spacing-2xl:48px;--xeg-spacing-3xl:64px;--xeg-font-size-xs:12px;--xeg-font-size-sm:14px;--xeg-font-size-md:16px;--xeg-font-size-lg:18px;--xeg-font-size-xl:20px;--xeg-font-size-2xl:24px;--xeg-font-size-3xl:32px;--xeg-font-line-height-tight:1.25;--xeg-font-line-height-normal:1.5;--xeg-font-line-height-relaxed:1.75;--xeg-font-weight-normal:400;--xeg-font-weight-medium:500;--xeg-font-weight-semibold:600;--xeg-font-weight-bold:700;--xeg-z-dropdown:1000;--xeg-z-sticky:1020;--xeg-z-fixed:1030;--xeg-z-modal-backdrop:1040;--xeg-z-modal:10000;--xeg-z-popover:1060;--xeg-z-tooltip:10001;--xeg-z-toast:1080;--xeg-z-gallery:9999;--xeg-shadow-sm:0 1px 2px 0 #0000000d;--xeg-shadow-md:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f;--xeg-shadow-lg:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d;--xeg-shadow-xl:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a;--xeg-radius-sm:4px;--xeg-radius-md:8px;--xeg-radius-lg:12px;--xeg-radius-xl:16px;--xeg-radius-full:9999px;--xeg-animation-duration-fast:.15s;--xeg-animation-duration-normal:.25s;--xeg-animation-duration-slow:.35s;--xeg-animation-ease-linear:linear;--xeg-animation-ease-in:ease-in;--xeg-animation-ease-out:ease-out;--xeg-animation-ease-in-out:ease-in-out;--xeg-animation-ease-bounce:cubic-bezier(.68,-.55,.265,1.55);--xeg-gallery-header-height:60px;--xeg-gallery-toolbar-height:48px;--xeg-gallery-thumbnail-size:80px;--xeg-gallery-thumbnail-gap:8px;--xeg-modal-max-width:90vw;--xeg-modal-max-height:90vh;--xeg-modal-padding:var(--xeg-spacing-lg);--xeg-button-height-sm:32px;--xeg-button-height-md:40px;--xeg-button-height-lg:48px;--xeg-button-padding-x:var(--xeg-spacing-md);--xeg-input-height:40px;--xeg-input-padding-x:var(--xeg-spacing-md);--xeg-input-border-width:1px;--xeg-bp-sm:640px;--xeg-bp-md:768px;--xeg-bp-lg:1024px;--xeg-bp-xl:1280px;--xeg-bp-2xl:1536px;--xeg-hover-bg:#0000000a;--xeg-hover-bg-dark:#ffffff0d;--xeg-focus-ring:0 0 0 2px var(--xeg-color-primary);--xeg-focus-ring-offset:#fff;--xeg-disabled-opacity:.5;--xeg-disabled-cursor:not-allowed;--xeg-transition-colors:color var(--xeg-duration-normal)var(--xeg-ease-in-out),background-color var(--xeg-duration-normal)var(--xeg-ease-in-out),border-color var(--xeg-duration-normal)var(--xeg-ease-in-out);--xeg-transition-opacity:opacity var(--xeg-duration-normal)var(--xeg-ease-in-out);--xeg-transition-transform:transform var(--xeg-duration-normal)var(--xeg-ease-in-out);--xeg-transition-all:all var(--xeg-duration-normal)var(--xeg-ease-in-out);--xeg-color-neutral-50:#f8fafc;--xeg-color-neutral-100:#f1f5f9;--xeg-color-neutral-200:#e2e8f0;--xeg-color-neutral-300:#cbd5e1;--xeg-color-neutral-400:#94a3b8;--xeg-color-neutral-500:#64748b;--xeg-color-neutral-600:#475569;--xeg-color-neutral-700:#334155;--xeg-color-neutral-800:#1e293b;--xeg-color-neutral-900:#0f172a;--xeg-color-slate-50:#f8fafc;--xeg-color-slate-100:#f1f5f9;--xeg-color-slate-200:#e2e8f0;--xeg-color-slate-300:#cbd5e1;--xeg-color-slate-400:#94a3b8;--xeg-color-slate-500:#64748b;--xeg-color-slate-600:#475569;--xeg-color-slate-700:#334155;--xeg-color-slate-800:#1e293b;--xeg-color-slate-900:#0f172a;--xeg-bg-toolbar:#f8fafcd9;--xeg-bg-toolbar-dark:#0f172aeb;--xeg-border-toolbar:#cbd5e14d;--xeg-shadow-toolbar:0 8px 32px #0f172a1f,0 4px 16px #0f172a14,0 0 0 1px #ffffff0d;--xeg-bg-button:#f8fafc99;--xeg-bg-button-hover:#e2e8f0cc;--xeg-border-button:#cbd5e166;--xeg-border-button-hover:#94a3b899;--xeg-text-button:var(--xeg-color-slate-700);--xeg-text-button-hover:var(--xeg-color-slate-800);--xeg-bg-button-navigation:#e2e8f0e6;--xeg-bg-button-navigation-hover:#cbd5e1f2;--xeg-text-button-navigation:var(--xeg-color-slate-700);--xeg-bg-button-download:var(--xeg-color-primary);--xeg-bg-button-download-hover:var(--xeg-color-primary-hover);--xeg-text-button-download:#fff;--xeg-bg-button-settings:#f1f5f9e6;--xeg-bg-button-settings-hover:#e2e8f0f2;--xeg-text-button-settings:var(--xeg-color-neutral-600);--xeg-bg-button-close:#f1f5f9e6;--xeg-bg-button-close-hover:#e2e8f0f2;--xeg-text-button-close:var(--xeg-color-neutral-600);--xeg-gallery-bg:#0f1419f2;--xeg-gallery-bg-light:#f8fafcf2;--xeg-gallery-border:var(--xeg-color-neutral-200);--xeg-gallery-item-bg:#fff;--xeg-gallery-item-border:var(--xeg-color-neutral-200);--xeg-gallery-item-shadow:#0f172a14;--xeg-bg-counter:#f1f5f9e6;--xeg-text-counter:var(--xeg-color-slate-700);--xeg-border-counter:var(--xeg-color-slate-300);--xeg-focus-ring-color:var(--xeg-color-primary);--xeg-transition-normal:.15s ease;--xeg-transition-slow:.3s ease}.xeg-theme-dark{--xeg-bg-toolbar:var(--xeg-bg-toolbar-dark);--xeg-border-toolbar:#47556966;--xeg-shadow-toolbar:0 8px 32px #0000004d,0 4px 16px #0003,0 0 0 1px #ffffff08;--xeg-bg-button:#33415599;--xeg-bg-button-hover:#475569cc;--xeg-border-button:#94a3b84d;--xeg-text-button:var(--xeg-color-slate-200);--xeg-text-button-hover:var(--xeg-color-slate-100);--xeg-gallery-bg:#0f1419fa;--xeg-bg-counter:#334155e6;--xeg-text-counter:var(--xeg-color-slate-200);--xeg-border-counter:var(--xeg-color-slate-600)}@media (prefers-color-scheme:dark){:root:not(.xeg-theme-light){--xeg-bg-primary:var(--xeg-dark-bg-primary);--xeg-bg-secondary:var(--xeg-dark-bg-secondary);--xeg-bg-overlay:var(--xeg-dark-bg-overlay);--xeg-bg-modal:var(--xeg-dark-bg-modal);--xeg-bg-card:var(--xeg-dark-bg-card);--xeg-text-primary:var(--xeg-dark-text-primary);--xeg-text-secondary:var(--xeg-dark-text-secondary);--xeg-text-tertiary:var(--xeg-dark-text-tertiary);--xeg-text-inverse:var(--xeg-dark-text-inverse);--xeg-text-muted:var(--xeg-dark-text-muted);--xeg-border-light:var(--xeg-dark-border-light);--xeg-border-medium:var(--xeg-dark-border-medium);--xeg-border-dark:var(--xeg-dark-border-dark);--xeg-bg-toolbar:var(--xeg-bg-toolbar-dark);--xeg-border-toolbar:var(--xeg-color-slate-700);--xeg-shadow-toolbar:0 4px 20px #0006,0 2px 8px #0003,0 0 0 1px #ffffff1a;--xeg-bg-button:#334155e6;--xeg-bg-button-hover:#475569f2;--xeg-border-button:var(--xeg-color-slate-600);--xeg-text-button:var(--xeg-color-slate-200);--xeg-text-button-hover:var(--xeg-color-slate-100);--xeg-gallery-bg:#0f1419fa;--xeg-bg-counter:#334155e6;--xeg-text-counter:var(--xeg-color-slate-200);--xeg-border-counter:var(--xeg-color-slate-600);--xeg-hover-bg:var(--xeg-hover-bg-dark)}}@media (prefers-contrast:high){:root{--xeg-border-light:var(--xeg-border-dark);--xeg-text-secondary:var(--xeg-text-primary);--xeg-bg-toolbar:#fff;--xeg-bg-button:#fff;--xeg-gallery-bg:#000}}@media (prefers-color-scheme:light){:root:not(.xeg-theme-dark):not(.xeg-theme-auto-dark){--xeg-auto-primary:#5294c7;--xeg-auto-secondary:#6b7280;--xeg-auto-surface:#fffffff2;--xeg-auto-overlay:#f8fafceb;--xeg-auto-text:#1e293b;--xeg-auto-text-secondary:#475569;--xeg-auto-border:#cbd5e166;--xeg-auto-shadow:#0f172a14;--xeg-auto-glass-bg:#ffffffbf;--xeg-auto-glass-border:#fff3;--xeg-auto-glass-shadow:0 8px 32px #0f172a1a,0 4px 16px #0f172a0f}}@media (prefers-color-scheme:dark){:root:not(.xeg-theme-light):not(.xeg-theme-auto-light){--xeg-auto-primary:#6ba7c7;--xeg-auto-secondary:#94a3b8;--xeg-auto-surface:#0f172af2;--xeg-auto-overlay:#0f172af5;--xeg-auto-text:#f1f5f9;--xeg-auto-text-secondary:#cbd5e1;--xeg-auto-border:#47556966;--xeg-auto-shadow:#0000004d;--xeg-auto-glass-bg:#0f172acc;--xeg-auto-glass-border:#ffffff1a;--xeg-auto-glass-shadow:0 8px 32px #00000040,0 4px 16px #00000026}}.xeg-theme-auto-morning{--xeg-auto-primary:#4a8bc2;--xeg-auto-surface:#f0f9fff2;--xeg-auto-overlay:linear-gradient(135deg,#f0f9ffe6,#e0f2fef2)}.xeg-theme-auto-day{--xeg-auto-primary:#3b82f6;--xeg-auto-surface:#fffffffa;--xeg-auto-overlay:#f8fafcf2}.xeg-theme-auto-evening{--xeg-auto-primary:#f59e0b;--xeg-auto-surface:#fffbebf2;--xeg-auto-overlay:linear-gradient(135deg,#fffbebe6,#fef3c8f2)}.xeg-theme-auto-night{--xeg-auto-primary:#6366f1;--xeg-auto-surface:#0f172afa;--xeg-auto-overlay:linear-gradient(135deg,#0f172af2,#1e293bfa);--xeg-auto-text:#e2e8f0;--xeg-auto-text-secondary:#94a3b8}.xeg-content-warm{--xeg-auto-primary:#f97316;--xeg-auto-glass-bg:#fff7edcc;--xeg-auto-glass-border:#fb923c33}.xeg-content-cool{--xeg-auto-primary:#0ea5e9;--xeg-auto-glass-bg:#f0f9ffcc;--xeg-auto-glass-border:#0ea5e933}.xeg-content-vibrant{--xeg-auto-primary:#ec4899;--xeg-auto-glass-bg:#fdf2f8cc;--xeg-auto-glass-border:#ec489933}.xeg-content-neutral{--xeg-auto-primary:#6b7280;--xeg-auto-glass-bg:#f9fafbcc;--xeg-auto-glass-border:#6b728033}@media (prefers-contrast:high){:root{--xeg-auto-primary:#000;--xeg-auto-text:#000;--xeg-auto-text-secondary:#000;--xeg-auto-border:#000;--xeg-auto-surface:#fff;--xeg-auto-overlay:#fff;--xeg-auto-glass-bg:#fff;--xeg-auto-glass-border:#000;--xeg-auto-glass-shadow:none}.xeg-theme-auto-night,.xeg-theme-dark{--xeg-auto-primary:#fff;--xeg-auto-text:#fff;--xeg-auto-text-secondary:#fff;--xeg-auto-border:#fff;--xeg-auto-surface:#000;--xeg-auto-overlay:#000;--xeg-auto-glass-bg:#000;--xeg-auto-glass-border:#fff}}@media (prefers-reduced-motion:reduce){:root{--xeg-auto-transition:none;--xeg-auto-animation-duration:0s}.xeg-theme-auto-day,.xeg-theme-auto-evening,.xeg-theme-auto-morning,.xeg-theme-auto-night{transition:none!important}}.xeg-auto-theme-transition{transition:color .6s cubic-bezier(.4,0,.2,1),background-color .6s cubic-bezier(.4,0,.2,1),background-image .6s cubic-bezier(.4,0,.2,1),border-color .6s cubic-bezier(.4,0,.2,1),box-shadow .6s cubic-bezier(.4,0,.2,1)}.xeg-gallery-container *,.xeg-gallery-layer *,[data-xeg-element] *,[data-xeg-gallery] *{transition:inherit}.xeg-auto-bg{background:var(--xeg-auto-surface)!important}.xeg-auto-text{color:var(--xeg-auto-text)!important}.xeg-auto-primary{color:var(--xeg-auto-primary)!important}.xeg-auto-glass{background:var(--xeg-auto-glass-bg)!important;border:1px solid var(--xeg-auto-glass-border)!important;box-shadow:var(--xeg-auto-glass-shadow)!important;-webkit-backdrop-filter:blur(12px)!important}@media (max-width:768px){:root{--xeg-auto-glass-bg:var(--xeg-auto-surface);--xeg-auto-glass-shadow:0 2px 8px var(--xeg-auto-shadow)}}@media (max-width:480px){:root{--xeg-auto-glass-bg:var(--xeg-auto-surface);--xeg-auto-glass-border:var(--xeg-auto-border);--xeg-auto-glass-shadow:none}.xeg-auto-theme-transition{transition-duration:.3s}}.xeg-auto-optimized{will-change:background-color,color,border-color}.xeg-auto-optimized:hover{will-change:auto}.xeg-auto-contained{contain:style}@supports not (color:color-mix(in srgb,red,blue)){:root{--xeg-auto-primary:#4785a3;--xeg-auto-secondary:#64748b}}@supports not ((-webkit-backdrop-filter:blur(10px)) or (backdrop-filter:blur(10px))){:root{--xeg-auto-glass-bg:var(--xeg-auto-surface)}}@media (max-width:768px){.xeg-gallery-toolbar{height:50px;padding:0 12px}.xeg-toolbar-section-center,.xeg-toolbar-section-left,.xeg-toolbar-section-right{gap:8px}.xeg-toolbar-button{min-width:32px;height:32px;padding:6px 10px;font-size:12px}.xeg-gallery-counter{margin-left:8px;font-size:12px}.xeg-gallery-viewer{padding:50px 12px 12px}.xeg-gallery-nav-left,.xeg-gallery-nav-right{width:40px;height:40px;font-size:16px}.xeg-gallery-nav-left{left:12px}.xeg-gallery-nav-right{right:12px}.xeg-gallery-thumbnails{max-width:calc(100vw - 24px);bottom:12px}.xeg-thumbnails-container{gap:6px;padding:8px}.xeg-thumbnail-image{width:60px;height:60px}}@media (prefers-color-scheme:light){.xeg-gallery-overlay{background:#fffffff2}.xeg-gallery-toolbar{color:#1f2937;background:#ffffffe6}.xeg-toolbar-button{color:#1f2937;background:#0000001a}.xeg-toolbar-button:hover{background:#0003}.xeg-gallery-counter,.xeg-progress-text{color:#000c}.xeg-gallery-error{color:#000000b3}.xeg-gallery-nav-left,.xeg-gallery-nav-right{color:#1f2937;background:#0000001a}.xeg-gallery-nav-left:hover,.xeg-gallery-nav-right:hover{background:#0003}.xeg-thumbnails-container{background:#ffffffe6}}@media (prefers-reduced-motion:reduce){.xeg-gallery-nav-left,.xeg-gallery-nav-right,.xeg-gallery-overlay,.xeg-progress-fill,.xeg-thumbnail,.xeg-toolbar-button{transition:none}}@media (prefers-contrast:high){.xeg-gallery-overlay{background:#000}.xeg-gallery-toolbar{background:#000;border-bottom:2px solid #fff}.xeg-gallery-nav-left,.xeg-gallery-nav-right,.xeg-toolbar-button{color:#000;background:#fff;border:2px solid #000}}@supports (container-type:size){:root{--supports-container-queries:1}}@supports selector(:has(*)){:root{--supports-has-selector:1}}:root{--xeg-color-primary-hover:color-mix(in srgb,var(--xeg-color-primary)90%,#fff);--xeg-color-primary-dark:color-mix(in srgb,var(--xeg-color-primary)70%,#000);--xeg-color-secondary-hover:color-mix(in srgb,var(--xeg-color-secondary)85%,#fff);--xeg-color-text-primary:var(--xeg-text-primary);--xeg-color-surface-tertiary:#ffffff2e;--xeg-color-surface-hover:#ffffff47;--xeg-color-primary-alpha-20:color-mix(in srgb,var(--xeg-color-primary)20%,transparent);--xeg-color-primary-alpha-30:color-mix(in srgb,var(--xeg-color-primary)30%,transparent);--xeg-color-error-alpha-10:color-mix(in srgb,var(--xeg-color-error)10%,transparent);--xeg-color-error-alpha-30:color-mix(in srgb,var(--xeg-color-error)30%,transparent);--xeg-overlay-background:radial-gradient(ellipse at center,#0f172ae0 0%,#0f172af5 100%);--xeg-overlay-background-alpha:#0f172acc;--xeg-overlay-background-high-contrast:#0f172afa;--xeg-container-max-width:1200px;--xeg-container-max-width-sm:480px;--xeg-container-max-width-md:768px;--xeg-gallery-item-shadow:#0f172a1a;--xeg-color-light:#fff;--xeg-transition-duration-fast:.15s;--xeg-transition-duration-medium:.25s}.xeg-theme-dark{--xeg-bg-primary:var(--xeg-dark-bg-primary);--xeg-bg-secondary:var(--xeg-dark-bg-secondary);--xeg-bg-overlay:var(--xeg-dark-bg-overlay);--xeg-bg-modal:var(--xeg-dark-bg-modal);--xeg-bg-card:var(--xeg-dark-bg-card);--xeg-text-primary:var(--xeg-dark-text-primary);--xeg-text-secondary:var(--xeg-dark-text-secondary);--xeg-text-tertiary:var(--xeg-dark-text-tertiary);--xeg-text-inverse:var(--xeg-dark-text-inverse);--xeg-text-muted:var(--xeg-dark-text-muted);--xeg-border-light:var(--xeg-dark-border-light);--xeg-border-medium:var(--xeg-dark-border-medium);--xeg-border-dark:var(--xeg-dark-border-dark);--xeg-hover-bg:var(--xeg-hover-bg-dark);--xeg-color-text-primary:var(--xeg-dark-text-primary);--xeg-color-surface-tertiary:#ffffff1f;--xeg-color-surface-hover:#fff3;--xeg-overlay-background:radial-gradient(ellipse at center,#0f172af0 0%,#0f172afa 100%);--xeg-overlay-background-alpha:#0f172ad9;--xeg-overlay-background-high-contrast:#0f172afc}@media (prefers-color-scheme:dark){:root:not(.xeg-theme-light){--xeg-bg-primary:var(--xeg-dark-bg-primary);--xeg-bg-secondary:var(--xeg-dark-bg-secondary);--xeg-bg-overlay:var(--xeg-dark-bg-overlay);--xeg-bg-modal:var(--xeg-dark-bg-modal);--xeg-bg-card:var(--xeg-dark-bg-card);--xeg-text-primary:var(--xeg-dark-text-primary);--xeg-text-secondary:var(--xeg-dark-text-secondary);--xeg-text-tertiary:var(--xeg-dark-text-tertiary);--xeg-text-inverse:var(--xeg-dark-text-inverse);--xeg-text-muted:var(--xeg-dark-text-muted);--xeg-border-light:var(--xeg-dark-border-light);--xeg-border-medium:var(--xeg-dark-border-medium);--xeg-border-dark:var(--xeg-dark-border-dark);--xeg-hover-bg:var(--xeg-hover-bg-dark);--xeg-color-text-primary:var(--xeg-dark-text-primary);--xeg-color-surface-tertiary:#ffffff26;--xeg-color-surface-hover:#ffffff40;--xeg-overlay-background:#000000f2;--xeg-overlay-background-alpha:#000c}}@media (prefers-reduced-motion:reduce){:root{--xeg-duration-fast:0s;--xeg-duration-normal:0s;--xeg-duration-slow:0s}}@media (prefers-contrast:high){:root{--xeg-border-light:var(--xeg-border-dark);--xeg-text-secondary:var(--xeg-text-primary)}}.xeg-container{box-sizing:border-box;color:var(--xeg-text-primary);background-color:var(--xeg-bg-primary);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;line-height:1.5}.xeg-container *,.xeg-container :after,.xeg-container :before{box-sizing:inherit}.xeg-container :focus-visible{outline:2px solid var(--xeg-color-primary);outline-offset:2px}.xeg-sr-only{clip:rect(0,0,0,0);white-space:nowrap;border:0;width:1px;height:1px;margin:-1px;padding:0;position:absolute;overflow:hidden}.xeg-transition{transition:var(--xeg-transition-all)}.xeg-btn{padding:var(--xeg-spacing-sm)var(--xeg-spacing-md);border:1px solid var(--xeg-border-medium);border-radius:var(--xeg-radius-md);color:var(--xeg-text-primary);font-size:var(--xeg-font-size-sm);font-weight:var(--xeg-font-weight-medium);cursor:pointer;min-height:var(--xeg-button-height-md);-webkit-backdrop-filter:blur(8px);background:#f8fafc99;justify-content:center;align-items:center;text-decoration:none;transition:all .2s;display:inline-flex;box-shadow:0 2px 8px #0f172a14}.xeg-btn:hover{background:#e2e8f0cc;transform:translateY(-1px);box-shadow:0 4px 16px #0f172a1f}.xeg-btn:disabled{opacity:var(--xeg-disabled-opacity);cursor:var(--xeg-disabled-cursor)}.xeg-btn-primary{background-color:var(--xeg-color-primary);color:var(--xeg-text-inverse);border-color:var(--xeg-color-primary)}.xeg-btn-primary:hover{background-color:var(--xeg-color-primary-hover);border-color:var(--xeg-color-primary-hover)}.xeg-btn-sm{min-height:var(--xeg-button-height-sm);padding:var(--xeg-spacing-xs)var(--xeg-spacing-sm);font-size:var(--xeg-font-size-xs)}.xeg-btn-lg{min-height:var(--xeg-button-height-lg);padding:var(--xeg-spacing-md)var(--xeg-spacing-lg);font-size:var(--xeg-font-size-md)}.xeg-card{border-radius:var(--xeg-radius-lg);padding:var(--xeg-spacing-md);-webkit-backdrop-filter:blur(12px);background:#ffffffeb;border:1px solid #cbd5e14d;box-shadow:0 4px 16px #0f172a14,0 2px 8px #0f172a0d}.xeg-card-header{padding-bottom:var(--xeg-spacing-md);margin-bottom:var(--xeg-spacing-md);border-bottom:1px solid var(--xeg-border-light)}.xeg-card-body{padding:0}.xeg-card-footer{padding-top:var(--xeg-spacing-md);margin-top:var(--xeg-spacing-md);border-top:1px solid var(--xeg-border-light)}.xeg-modal-backdrop{background:var(--xeg-overlay-background);width:100%;height:100%;z-index:var(--xeg-z-modal-backdrop);-webkit-backdrop-filter:blur(8px);justify-content:center;align-items:center;display:flex;position:fixed;top:0;left:0}.xeg-modal{border-radius:var(--xeg-radius-xl);z-index:var(--xeg-z-modal);max-width:var(--xeg-modal-max-width);max-height:var(--xeg-modal-max-height);margin:var(--xeg-spacing-lg);padding:var(--xeg-modal-padding);-webkit-backdrop-filter:blur(16px);background:#fffffff2;border:1px solid #cbd5e133;overflow:auto;box-shadow:0 20px 64px #0f172a26,0 8px 32px #0f172a1a}.xeg-hidden{display:none!important}.xeg-visible{display:block!important}.xeg-text-center{text-align:center}.xeg-text-left{text-align:left}.xeg-text-right{text-align:right}.xeg-flex{display:flex}.xeg-flex-col{flex-direction:column}.xeg-flex-row{flex-direction:row}.xeg-items-center{align-items:center}.xeg-items-start{align-items:flex-start}.xeg-items-end{align-items:flex-end}.xeg-justify-center{justify-content:center}.xeg-justify-between{justify-content:space-between}.xeg-justify-start{justify-content:flex-start}.xeg-justify-end{justify-content:flex-end}.xeg-w-full{width:100%}.xeg-h-full{height:100%}.xeg-w-auto{width:auto}.xeg-h-auto{height:auto}.xeg-p-0{padding:0}.xeg-p-1{padding:var(--xeg-spacing-xs)}.xeg-p-2{padding:var(--xeg-spacing-sm)}.xeg-p-3{padding:var(--xeg-spacing-md)}.xeg-p-4{padding:var(--xeg-spacing-lg)}.xeg-m-0{margin:0}.xeg-m-1{margin:var(--xeg-spacing-xs)}.xeg-m-2{margin:var(--xeg-spacing-sm)}.xeg-m-3{margin:var(--xeg-spacing-md)}.xeg-m-4{margin:var(--xeg-spacing-lg)}.xeg-mt-0{margin-top:0}.xeg-mt-1{margin-top:var(--xeg-spacing-xs)}.xeg-mt-2{margin-top:var(--xeg-spacing-sm)}.xeg-mt-3{margin-top:var(--xeg-spacing-md)}.xeg-mt-4{margin-top:var(--xeg-spacing-lg)}.xeg-mb-0{margin-bottom:0}.xeg-mb-1{margin-bottom:var(--xeg-spacing-xs)}.xeg-mb-2{margin-bottom:var(--xeg-spacing-sm)}.xeg-mb-3{margin-bottom:var(--xeg-spacing-md)}.xeg-mb-4{margin-bottom:var(--xeg-spacing-lg)}.xeg-ml-0{margin-left:0}.xeg-ml-1{margin-left:var(--xeg-spacing-xs)}.xeg-ml-2{margin-left:var(--xeg-spacing-sm)}.xeg-ml-3{margin-left:var(--xeg-spacing-md)}.xeg-ml-4{margin-left:var(--xeg-spacing-lg)}.xeg-mr-0{margin-right:0}.xeg-mr-1{margin-right:var(--xeg-spacing-xs)}.xeg-mr-2{margin-right:var(--xeg-spacing-sm)}.xeg-mr-3{margin-right:var(--xeg-spacing-md)}.xeg-mr-4{margin-right:var(--xeg-spacing-lg)}body.xeg-gallery-open{touch-action:none!important;overscroll-behavior:none!important;overflow:hidden!important}.xeg-gallery-layer{width:100vw!important;height:100vh!important;z-index:var(--xeg-z-gallery-overlay)!important;-webkit-backdrop-filter:blur(8px)!important;isolation:isolate!important;background:#000000f2!important;position:fixed!important;top:0!important;left:0!important}.xeg-gallery-layer *,.xeg-gallery-root,.xeg-gallery-root *,[data-xeg-element],[data-xeg-element] *,[data-xeg-gallery],[data-xeg-gallery] *{pointer-events:auto!important}@media (max-width:640px){.xeg-modal{margin:var(--xeg-spacing-sm);max-width:calc(100vw - var(--xeg-spacing-md))}.xeg-card{padding:var(--xeg-spacing-sm)}}@media (prefers-reduced-motion:reduce){.xeg-btn,.xeg-modal,.xeg-transition{transition:none!important;animation:none!important}}@media (prefers-contrast:high){.xeg-btn,.xeg-card{border-width:2px}}.xeg-theme-dark .xeg-container{--lightningcss-light:;--lightningcss-dark:initial;color-scheme:dark}@media (prefers-color-scheme:dark){:root:not(.xeg-theme-light) .xeg-container{--lightningcss-light:;--lightningcss-dark:initial;color-scheme:dark}}.xeg-gallery-trigger{cursor:pointer;z-index:1000;-webkit-backdrop-filter:blur(4px);background:#000000b3;border:none;border-radius:6px;outline:none;justify-content:center;align-items:center;width:32px;height:32px;font-size:0;transition:all .2s;display:flex;position:absolute;top:8px;right:8px}.xeg-gallery-trigger:hover{transform:scale(1.05);background:#1d9bf0cc!important}.xeg-gallery-trigger:active{transform:scale(.95)}.xeg-gallery-trigger:focus{box-shadow:0 0 0 2px #1d9bf080}[data-testid=tweet]{position:relative!important}[data-testid=tweetPhoto] .xeg-gallery-trigger,[data-testid=videoComponent] .xeg-gallery-trigger{top:8px;right:8px}@media (prefers-color-scheme:dark){.xeg-gallery-trigger{-webkit-backdrop-filter:blur(8px);background:#ffffff1a}.xeg-gallery-trigger:hover{background:#1d9bf0cc!important}}@media (hover:none) and (pointer:coarse){.xeg-gallery-trigger{width:40px;height:40px}.xeg-gallery-trigger:hover{transform:none}.xeg-gallery-trigger:active{transform:scale(.95);background:#1d9bf0cc!important}}.xeg-gallery-trigger svg{fill:#fff;pointer-events:none;width:16px;height:16px;transition:fill .2s}.xeg-gallery-trigger:after{content:\"갤러리 열기\";clip:rect(0,0,0,0);white-space:nowrap;width:1px;height:1px;position:absolute;left:-9999px;overflow:hidden}@keyframes galleryTriggerPulse{0%{box-shadow:0 0 #1d9bf0b3}70%{box-shadow:0 0 0 10px #1d9bf000}to{box-shadow:0 0 #1d9bf000}}.xeg-gallery-trigger.newly-created{animation:2s infinite galleryTriggerPulse}.xeg-gallery-trigger{z-index:9999!important}.kO70E{justify-content:center;align-items:center;gap:var(--xeg-spacing-sm);padding:var(--xeg-spacing-sm)var(--xeg-spacing-md);border:1px solid var(--xeg-border-button);border-radius:var(--xeg-radius-md);font-size:var(--xeg-font-size-sm);font-weight:var(--xeg-font-weight-medium);cursor:pointer;min-height:var(--xeg-button-height-md);background:var(--xeg-bg-button);color:var(--xeg-text-button);-webkit-backdrop-filter:blur(8px);outline:none;text-decoration:none;transition:all .3s cubic-bezier(.4,0,.2,1);display:inline-flex;position:relative;overflow:hidden;box-shadow:0 2px 8px #0f172a14,0 1px 4px #0f172a0d}.kO70E:focus-visible{outline:var(--xeg-focus-ring);outline-offset:var(--xeg-focus-ring-offset)}.kO70E:disabled{opacity:var(--xeg-disabled-opacity);cursor:var(--xeg-disabled-cursor);pointer-events:none}.r-V67{background:var(--xeg-color-primary);color:var(--xeg-text-inverse);border-color:var(--xeg-color-primary);box-shadow:0 2px 8px #4785a326,0 1px 4px #4785a31a}.r-V67:hover:not(:disabled){background:var(--xeg-color-primary-hover);border-color:var(--xeg-color-primary-hover);transform:translateY(-2px);box-shadow:0 6px 20px #4785a340,0 3px 10px #4785a326}.LmHa-{color:var(--xeg-text-primary);background:#f8fafc99;border:1px solid #cbd5e166}.LmHa-:hover:not(:disabled){background:#e2e8f0cc;border-color:#94a3b899;transform:translateY(-1px)}.GxXeW{color:var(--xeg-text-primary);background:0 0;border-color:#0000}.GxXeW:hover:not(:disabled){background:#f8fafc1a;border-color:#cbd5e133}.NH-Q1{background:var(--xeg-color-error);color:#fff}.NH-Q1:hover:not(:disabled){background:var(--xeg-color-error);filter:brightness(.9);box-shadow:0 4px 12px color-mix(in srgb,var(--xeg-color-error)30%,transparent)}._15ywo{border-radius:6px;padding:6px 12px;font-size:12px}.J7bOc{padding:var(--xeg-spacing-sm)var(--xeg-spacing-md);border-radius:8px;font-size:14px}.wUyoI{border-radius:10px;padding:12px 24px;font-size:16px}.XYc0m{border-radius:50%;width:40px;height:40px;padding:0}.XYc0m._15ywo{width:32px;height:32px}.XYc0m.wUyoI{width:48px;height:48px}.CfJMD{position:relative}.CfJMD:after{content:\"\";border:2px solid #0000;border-top-color:currentColor;border-radius:50%;width:16px;height:16px;margin:-8px 0 0 -8px;animation:1s linear infinite -LxVZ;position:absolute;top:50%;left:50%}.CfJMD>*{opacity:0}@keyframes -LxVZ{to{transform:rotate(1turn)}}.caLxn{width:100%}.kO70E:before{content:\"\";background:#ffffff4d;border-radius:50%;width:0;height:0;transition:width .3s,height .3s;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.kO70E:active:before{width:100px;height:100px}@media (prefers-color-scheme:light){.LmHa-{color:#0f1419;border-color:var(--xeg-bg-overlay-light);background:#0000000d}.LmHa-:hover:not(:disabled){background:var(--xeg-bg-overlay-light);border-color:var(--xeg-border-medium)}.GxXeW{color:#0f1419}.GxXeW:hover:not(:disabled){background:#0000000d}}@media (prefers-reduced-motion:reduce){.kO70E{transition:none}.kO70E:hover:not(:disabled){transform:none}.CfJMD:after{animation:none}}.ZFHVp{-webkit-backdrop-filter:blur(12px);isolation:isolate;background:#ffffffeb;border:1px solid #fff3;border-left:4px solid;border-radius:12px;min-width:320px;max-width:480px;margin-bottom:12px;padding:18px;animation:.4s cubic-bezier(.4,0,.2,1) EGn7K;position:relative;box-shadow:0 8px 32px #0f172a26,0 4px 16px #0f172a1a}.ZFHVp._77OPw{background:#4785a314;border-color:#4785a333}.ZFHVp.-xmqE{background:#10b98114;border-color:#10b98133}.ZFHVp._8TZRU{background:#f59e0b14;border-color:#f59e0b33}.ZFHVp.fIfdy{background:#dc262614;border-color:#dc262633}.fLa9j{flex-direction:column;gap:8px;display:flex}.gPkSr{justify-content:space-between;align-items:flex-start;gap:12px;display:flex}.N1Mhw{color:var(--xeg-text-primary);margin:0;font-size:14px;font-weight:600;line-height:1.3}.Xsl3l{margin:0;font-size:13px;line-height:1.4}.Xsl3l,.f3X-0{color:var(--xeg-text-secondary)}.f3X-0{cursor:pointer;background:0 0;border:none;border-radius:4px;flex-shrink:0;justify-content:center;align-items:center;width:20px;height:20px;padding:0;font-size:18px;line-height:1;transition:background-color .15s;display:flex}.f3X-0:hover{background-color:#5364711a}.UYZjw{margin-top:4px}.fCIaz{background:var(--xeg-color-primary);color:#fff;cursor:pointer;-webkit-backdrop-filter:blur(4px);border:1px solid #4785a34d;border-radius:8px;padding:8px 16px;font-size:13px;font-weight:600;transition:all .3s cubic-bezier(.4,0,.2,1);box-shadow:0 2px 8px #4785a326}.fCIaz:hover{background:var(--xeg-color-primary-hover);transform:translateY(-2px);box-shadow:0 4px 16px #4785a340}@keyframes EGn7K{0%{opacity:0;transform:translate(100%)scale(.95)}to{opacity:1;transform:translate(0)scale(1)}}@media (prefers-reduced-motion:reduce){.ZFHVp{animation:none}.fCIaz{transition:none}.fCIaz:hover{transform:none}}.fLg7u{background:var(--xeg-bg-toolbar);border:1px solid var(--xeg-border-toolbar);min-height:48px;box-shadow:var(--xeg-shadow-toolbar);-webkit-backdrop-filter:blur(12px)saturate(120%);-webkit-user-select:none;user-select:none;z-index:10002;isolation:isolate;border-radius:16px;gap:12px;padding:8px 16px;transition:all .3s cubic-bezier(.4,0,.2,1);display:inline-flex;position:fixed;top:20px;left:50%;transform:translate(-50%)}.f8g4u,.fLg7u{justify-content:space-between;align-items:center}.f8g4u{gap:8px;width:100%;max-width:100%;display:flex;overflow:hidden}.dBJnf{position:relative}.CyUjf,.dBJnf,.hZtD9{align-items:center;gap:2px;display:flex}.CyUjf,.hZtD9{flex:1}.CyUjf{justify-content:flex-start}.hZtD9{justify-content:flex-end}.DoE8Y{flex:none;justify-content:center;align-items:center;display:flex}.dBJnf:after{display:none}.FKnOO{color:var(--xeg-color-neutral-500)}._4eoja{background:var(--xeg-bg-button);border:1px solid var(--xeg-border-button);color:var(--xeg-text-button);cursor:pointer;-webkit-backdrop-filter:blur(8px);border-radius:10px;justify-content:center;align-items:center;width:40px;height:40px;font-size:14px;font-weight:500;transition:all .3s cubic-bezier(.4,0,.2,1);display:flex;position:relative;overflow:hidden;box-shadow:0 2px 8px #0f172a14,0 1px 4px #0f172a0d}._4eoja:hover:not(:disabled){background:var(--xeg-bg-button-hover);color:var(--xeg-text-button-hover);transform:translateY(-2px)scale(1.05);box-shadow:0 4px 16px #0f172a1f,0 2px 8px #0f172a14}._4eoja:active:not(:disabled){transform:translateY(0)scale(1);box-shadow:0 2px 8px #0f172a14,0 1px 4px #0f172a0d}._4eoja.sebGk{background:var(--xeg-color-primary);color:#fff;box-shadow:0 0 0 2px var(--xeg-color-primary-alpha-30),0 4px 16px #4785a340}._4eoja:disabled{background:var(--xeg-color-neutral-100);border-color:var(--xeg-color-neutral-200);color:var(--xeg-color-neutral-400);cursor:not-allowed;box-shadow:none;transform:none}.nUxyF{gap:8px}.PAXbY{background:var(--xeg-bg-button-navigation);border-color:var(--xeg-color-neutral-300);color:var(--xeg-text-button-navigation)}.PAXbY:hover:not(:disabled){background:var(--xeg-bg-button-navigation-hover);color:var(--xeg-color-neutral-800)}.PAXbY.sebGk,.PAXbY:active:not(:disabled){background:var(--xeg-color-primary);color:#fff}.GG869{flex-direction:column;align-items:center;gap:4px;min-width:80px;display:flex}._2cjmv{color:var(--xeg-text-counter);font-size:var(--xeg-font-size-md);text-align:center;white-space:nowrap;background:var(--xeg-bg-counter);border:1px solid var(--xeg-border-counter);border-radius:6px;padding:4px 8px;font-weight:600}.JEXmP{color:var(--xeg-text-primary);font-weight:700}.FKnOO{color:#ffffffb3;margin:0 2px}.d1et2{color:var(--xeg-color-neutral-600)}.vB6NL{background:var(--xeg-color-neutral-200);width:60px;height:2px;margin:4px 0;overflow:hidden}.LWQwI,.vB6NL{border-radius:1px}.LWQwI{background:linear-gradient(to right,var(--xeg-color-primary)0,var(--xeg-color-primary-light)100%);transform-origin:0;width:100%;height:100%;transition:width .3s}.EdOEV{background:var(--xeg-color-neutral-100);border:1px solid var(--xeg-color-neutral-200);border-radius:8px;gap:2px;padding:2px;display:flex}.Q7dUY{width:30px;height:30px;color:var(--xeg-color-neutral-600);transition:var(--xeg-transition-normal);background:0 0;border:none;border-radius:6px}.Q7dUY.bt8jv{background:var(--xeg-color-primary);color:#fff}.atmJJ{position:relative}.njlfQ{background:var(--xeg-bg-button-download);border-color:var(--xeg-color-primary);color:var(--xeg-text-button-download)}.njlfQ:hover:not(:disabled){background:var(--xeg-bg-button-download-hover);border-color:var(--xeg-color-primary-hover)}.AU-dP{background:var(--xeg-color-success);border-color:var(--xeg-color-success);color:#fff}.AU-dP:hover:not(:disabled){background:var(--xeg-color-success-light);border-color:var(--xeg-color-success-light)}._7e9VX{text-align:center;background:#8b45b3cc;border-radius:8px;min-width:14px;padding:2px 4px;font-size:9px;font-weight:700;line-height:1;top:-4px;right:-4px}._7e9VX,.a0GDK{color:#fff;position:absolute}.a0GDK{background:#4caf50e6;border-radius:50%;justify-content:center;align-items:center;width:12px;height:12px;font-size:8px;animation:1s linear infinite m4eyx;display:flex;top:-6px;right:-6px}@keyframes m4eyx{0%{transform:rotate(0)}to{transform:rotate(1turn)}}.V6D-I{background:var(--xeg-bg-button-settings);border-color:var(--xeg-color-neutral-300);color:var(--xeg-text-button-settings)}.V6D-I:hover:not(:disabled){background:var(--xeg-bg-button-settings-hover);border-color:var(--xeg-color-neutral-400)}.Vn14N{background:var(--xeg-bg-button-close);border-color:var(--xeg-color-neutral-300);color:var(--xeg-text-button-close)}.Vn14N:hover:not(:disabled){background:var(--xeg-bg-button-close-hover);border-color:var(--xeg-color-error);color:var(--xeg-color-error)}@media (max-width:768px){.fLg7u{padding:12px 16px}.f8g4u{gap:12px}.dBJnf{gap:6px}._4eoja{min-width:36px;min-height:36px;padding:6px 10px;font-size:13px}._2cjmv{font-size:14px}.vB6NL{width:50px}.Q7dUY{min-width:32px;min-height:32px;padding:4px 8px}}@media (max-width:480px){.fLg7u{padding:10px 12px}.f8g4u{flex-wrap:wrap;justify-content:center;gap:8px}.dBJnf{gap:4px}._4eoja{min-width:32px;min-height:32px;padding:5px 8px}.GG869{min-width:70px}._2cjmv{font-size:13px}.vB6NL{width:40px;height:2px}.EdOEV{border-radius:6px}.Q7dUY{min-width:28px;min-height:28px;padding:3px 6px}._7e9VX{padding:1px 4px;font-size:9px}}@media (prefers-contrast:high){.fLg7u{-webkit-backdrop-filter:none;background:#fff;border:2px solid #000;box-shadow:0 4px 20px #00000080}._4eoja{color:#000;background:#f0f0f0;border:1px solid #000}._4eoja:hover:not(:disabled){background:#dcdcdc;border:2px solid #000}.PAXbY{background:#0064c8}.PAXbY,.atmJJ{color:#fff;border:1px solid #000}.atmJJ{background:#009632}.Vn14N{color:#fff;background:#c80000;border:1px solid #000}}[data-theme=dark] .fLg7u{background:#000;border:2px solid #fff}[data-theme=dark] ._4eoja{color:#fff;background:#282828;border:1px solid #fff}@media (prefers-color-scheme:dark) and (prefers-contrast:high){.fLg7u{background:#000;border:2px solid #fff}._4eoja{color:#fff;background:#282828;border:1px solid #fff}}@media (prefers-reduced-transparency:reduce){.fLg7u{-webkit-backdrop-filter:none;background:#fff;box-shadow:0 4px 16px #00000026,0 2px 8px #0000001a}[data-theme=dark] .fLg7u{background:#1e293b}}@media (max-width:768px){.fLg7u{-webkit-backdrop-filter:blur(16px)saturate(180%);background:#fffffffc;min-height:48px;padding:8px 12px}[data-theme=dark] .fLg7u{background:#0f172afc}}@media (max-width:480px){.fLg7u{border-radius:8px;width:calc(100vw - 20px);max-width:none;left:10px;transform:none}}@media (prefers-reduced-motion:reduce){.LWQwI,._4eoja,.a0GDK{transition:none;animation:none}._4eoja:hover:not(:disabled){transform:none}}.fLg7u.OzLl1{-webkit-backdrop-filter:none!important;background:#fff!important;border:2px solid #0000004d!important;box-shadow:0 4px 20px #0006,0 2px 8px #0003!important}[data-theme=dark] .fLg7u.OzLl1{background:#0f172a!important;border:2px solid #ffffff4d!important;box-shadow:0 4px 20px #0009,0 2px 8px #0006!important}.OzLl1 ._4eoja{color:#000000e6;background:#fffffff2;border:1px solid #0003}.OzLl1 ._4eoja:hover:not(:disabled){background:#f5f5f5fa;border-color:#0000004d;box-shadow:0 2px 8px #00000026}[data-theme=dark] .OzLl1 ._4eoja{color:#ffffffe6;background:#334155f2;border:1px solid #fff3}@supports (container-type:size){:root{--supports-container-queries:1}}:root{--xeg-gallery-z-index:10000;--xeg-toolbar-z-index:10001;--xeg-transition-fast:transform .2s cubic-bezier(.16,1,.3,1),opacity .2s cubic-bezier(.16,1,.3,1);--xeg-transition-normal:transform .3s cubic-bezier(.23,1,.32,1),opacity .3s cubic-bezier(.23,1,.32,1);--xeg-transition-smooth:transform .4s cubic-bezier(.16,1,.3,1);--xeg-spacing-gallery:clamp(10px,2.5vw,20px);--xeg-spacing-mobile:clamp(8px,2vw,15px);--xeg-spacing-compact:clamp(5px,1.5vw,10px);--xeg-toolbar-height:clamp(60px,10vh,80px);--xeg-backdrop-blur:8px;--xeg-shadow-soft:0 8px 32px var(--xeg-gallery-item-shadow)}.X9gZR{background:var(--xeg-gallery-bg);z-index:var(--xeg-gallery-z-index);will-change:opacity,transform;contain:layout style paint;opacity:0;transition:var(--xeg-transition-normal);cursor:default;pointer-events:auto;flex-direction:column;display:flex;position:fixed;top:0;bottom:0;left:0;right:0;transform:scale(1.02);container:gallery-container/size}.X9gZR._5oV6P{opacity:1;transform:scaleX(1)}.X9gZR.yhK-D{justify-content:center;align-items:center}.X9gZR:has(.meO3U:hover){--toolbar-interaction:1}.X9gZR:has(.LxHLC){--has-active-item:1}.X9gZR *{pointer-events:auto}.meO3U{z-index:var(--xeg-toolbar-z-index);transition:var(--xeg-transition-normal);will-change:transform,opacity;contain:layout style;background:linear-gradient(#000c 0,#0006 70%,#0000);padding-block-end:var(--xeg-spacing-gallery);position:fixed;top:0;left:0;right:0;transform:translateZ(0)}.Bf-LG{opacity:1!important;transform:translateZ(0)!important}.Bf-LG,.a31o9{transition:var(--xeg-transition-fast);will-change:transform,opacity}.a31o9{opacity:0!important;transform:translateY(-100%)!important}.GpJm7{position:relative;overflow:hidden;container-name:content-area}.GpJm7,.lbBLC{contain:layout style;pointer-events:auto;flex-direction:column;flex:1;display:flex;transform:translateZ(0);container-type:size}.lbBLC{scroll-behavior:smooth;scrollbar-width:thin;scrollbar-color:var(--xeg-neutral-300)transparent;padding:var(--xeg-spacing-gallery);gap:var(--xeg-spacing-gallery);will-change:scroll-position;scroll-snap-type:y proximity;overflow:hidden auto;container-name:items-list}.lbBLC::-webkit-scrollbar{width:clamp(6px,1vw,8px)}.lbBLC::-webkit-scrollbar-track{background:0 0}.lbBLC::-webkit-scrollbar-thumb{background:var(--xeg-neutral-300);border-radius:4px;transition:background .2s cubic-bezier(.16,1,.3,1)}.lbBLC::-webkit-scrollbar-thumb:hover{background:var(--xeg-neutral-400)}.LxHLC{contain:layout style;position:relative}.LxHLC:before{content:\"\";border:3px solid var(--xeg-color-primary);pointer-events:none;z-index:1;will-change:box-shadow,transform;border-radius:12px;animation:2s cubic-bezier(.16,1,.3,1) infinite alternate YBPBl,.3s cubic-bezier(.16,1,.3,1) forwards LCzSt;position:absolute;top:-12px;bottom:-12px;left:-12px;right:-12px;transform:translateZ(0)}@keyframes YBPBl{0%{box-shadow:0 0 8px color-mix(in srgb,var(--xeg-color-primary)50%,transparent)}to{box-shadow:0 0 24px color-mix(in srgb,var(--xeg-color-primary)80%,transparent)}}@keyframes LCzSt{0%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.xI8D5{animation:.3s cubic-bezier(.16,1,.3,1) xI8D5}@keyframes xI8D5{0%{opacity:0;transform:translate(-50%,10px)scale(.95)}to{opacity:1;transform:translate(-50%)scaleX(1)}}.fwsrV{text-align:center;color:var(--xeg-text-secondary);max-inline-size:min(400px,90vw);padding:clamp(30px,5vw,40px)}.fwsrV h3{color:var(--xeg-text-primary);margin:0 0 clamp(12px,2vw,16px);font-size:clamp(20px,4vw,24px);font-weight:600;line-height:1.2}.fwsrV p{color:var(--xeg-text-tertiary);margin:0;font-size:clamp(14px,2.5vw,16px);line-height:1.5}@container gallery-container (width<=768px){.lbBLC{padding:var(--xeg-spacing-mobile);gap:var(--xeg-spacing-mobile)}.meO3U{padding-block-end:var(--xeg-spacing-mobile)}}@container gallery-container (width<=480px){.lbBLC{padding:var(--xeg-spacing-compact);gap:var(--xeg-spacing-compact)}}@media (max-width:768px){.lbBLC{padding:var(--xeg-spacing-mobile);gap:var(--xeg-spacing-mobile)}.meO3U{padding-block-end:var(--xeg-spacing-mobile)}}@media (max-width:480px){.lbBLC{padding:var(--xeg-spacing-compact);gap:var(--xeg-spacing-compact)}}@media (prefers-contrast:high){:root{--xeg-gallery-bg:#000}.meO3U{background:linear-gradient(#000 0,#000c 70%,#0000)}.LxHLC:before{border-color:#fff}}@media (prefers-reduced-motion:reduce){:root{--xeg-transition-fast:none;--xeg-transition-normal:none;--xeg-transition-smooth:none}.X9gZR,.meO3U,.xI8D5{transition:none;animation:none}.LxHLC:before{box-shadow:0 0 15px color-mix(in srgb,var(--xeg-color-primary)70%,transparent);border-width:3px;animation:none}.lbBLC{scroll-behavior:auto;scroll-snap-type:none}.X9gZR,.meO3U{will-change:auto;transform:none}}@media (prefers-color-scheme:light){.X9gZR:has(.fwsrV){background:#fffffff2}.fwsrV{color:#000c}.fwsrV h3{color:#000000e6}.fwsrV p{color:#000000b3}}.fdlfq{margin-top:1rem}.XJJci{z-index:calc(var(--xeg-gallery-z-index) + 2);pointer-events:none;flex-direction:column;gap:10px;display:flex;position:fixed;top:20px;right:20px}.XJJci>*{pointer-events:auto}.PFezc{background-color:var(--xeg-color-surface-dark,#000);border-radius:8px;justify-content:center;align-items:center;width:100%;height:100%;display:flex;position:relative;overflow:hidden}.PFezc:focus{outline:2px solid var(--xeg-color-primary,#1d9bf0);outline-offset:2px}.Hmn5P{object-fit:contain;border-radius:6px;width:auto;max-width:100%;height:auto;max-height:100%}.kMw-b{background-color:var(--xeg-color-surface-dark,#1a1a1a);border-radius:8px;flex-direction:column;justify-content:center;align-items:center;width:100%;height:100%;min-height:200px;display:flex;position:relative}.fLAGl{border-top:3px solid var(--xeg-color-secondary,#2f3336);border:3px solid var(--xeg-color-secondary,#2f3336);border-top-color:var(--xeg-color-primary,#1d9bf0);width:40px;height:40px;margin-bottom:var(--xeg-spacing-md,16px);border-radius:50%;animation:1s linear infinite EE9Oh}.E01ZT{color:var(--xeg-color-text-secondary,#71767b);text-align:center;font-size:14px}.y6EGs{background-color:var(--xeg-color-surface-dark,#1a1a1a);border-radius:8px;width:100%;height:100%;min-height:200px;position:relative}.dXUVn,.y6EGs{justify-content:center;align-items:center;display:flex}.dXUVn{text-align:center;color:var(--xeg-color-text-error,#f4212e);padding:var(--xeg-spacing-lg,24px);flex-direction:column;max-width:300px}._49LwT{margin-bottom:var(--xeg-spacing-sm,8px);font-size:24px}@keyframes EE9Oh{0%{transform:rotate(0)}to{transform:rotate(1turn)}}@media (max-width:768px){.Hmn5P,._3KADf{border-radius:4px}.dXUVn{padding:16px}._1-6PE{border-width:2px;width:32px;height:32px}}@media (prefers-contrast:high){._3KADf:focus{outline-width:3px}._1-6PE{border-width:4px}}@media (prefers-reduced-motion:reduce){._1-6PE{animation:none}}.huYoS{margin-bottom:var(--xeg-spacing-md,16px);border-radius:var(--xeg-radius-lg,8px);transition:var(--xeg-transition-all,all .3s ease);cursor:default;text-align:center;pointer-events:auto;background:0 0;border:none;flex-direction:column;align-items:center;width:100%;padding:0;display:flex;position:relative;overflow:visible}.huYoS:hover{box-shadow:var(--xeg-shadow-lg);transform:translateY(-2px)}.huYoS:focus{outline:var(--xeg-focus-ring);outline-offset:var(--xeg-focus-ring-offset)}.huYoS.xm-1c{box-shadow:0 0 0 3px var(--xeg-color-primary);border-radius:var(--xeg-radius-lg,8px);transition:box-shadow .2s}._8-c8d{width:-moz-fit-content;width:fit-content;max-width:100%;margin:0 auto;position:relative}._8-c8d,.lhkEW{background:var(--xeg-bg-secondary);justify-content:center;align-items:center;min-height:200px;display:flex}.lhkEW{position:absolute;top:0;bottom:0;left:0;right:0}._6YYDY{width:var(--xeg-spacing-lg);height:var(--xeg-spacing-lg);border-top:2px solid var(--xeg-border-light);border:2px solid var(--xeg-border-light);border-top-color:var(--xeg-color-primary);border-radius:var(--xeg-radius-full);animation:1s linear infinite EYyXZ}@keyframes EYyXZ{0%{transform:rotate(0)}to{transform:rotate(1turn)}}.FWlk5{border-radius:var(--xeg-radius-md,4px);object-fit:contain;pointer-events:none;-webkit-user-select:none;user-select:none;display:block}.FWlk5.yYtGJ{object-fit:none;width:auto!important;max-width:none!important;height:auto!important;max-height:none!important}.FWlk5.Uc0oU{object-fit:contain;width:100%;max-width:100vw;height:auto}.FWlk5.M9Z6M{width:auto}.FWlk5.-Mlrh,.FWlk5.M9Z6M{object-fit:contain;height:auto;max-height:80vh}.FWlk5.-Mlrh{width:100%;max-width:100vw}.qb9K3{padding:var(--xeg-spacing-3xl)var(--xeg-spacing-lg);background:var(--xeg-bg-secondary);color:var(--xeg-text-secondary);flex-direction:column;justify-content:center;align-items:center;min-height:200px;display:flex}.Wno7U{font-size:var(--xeg-font-size-2xl);margin-bottom:var(--xeg-spacing-sm)}._8-wis{font-size:var(--xeg-font-size-sm);text-align:center}.PjdGb{top:var(--xeg-spacing-sm);right:var(--xeg-spacing-sm);gap:var(--xeg-spacing-sm);opacity:0;transition:var(--xeg-transition-opacity);display:flex;position:absolute}.huYoS:hover .PjdGb{opacity:1}._7a-5M{min-width:var(--xeg-spacing-lg);height:var(--xeg-spacing-lg);background:var(--xeg-bg-overlay-medium);color:var(--xeg-text-inverse);font-size:var(--xeg-font-size-xs);font-weight:var(--xeg-font-weight-semibold);border-radius:var(--xeg-radius-lg);padding:0 var(--xeg-spacing-sm);justify-content:center;align-items:center;display:flex}._3r-xC{padding:var(--xeg-spacing-sm);background:var(--xeg-bg-primary)}.TyK4e{font-size:var(--xeg-font-size-sm);font-weight:var(--xeg-font-weight-medium);color:var(--xeg-text-primary);margin-bottom:var(--xeg-spacing-xs);text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.-W7qa{font-size:var(--xeg-font-size-xs);color:var(--xeg-text-secondary)}.feyj6{top:var(--xeg-spacing-sm);right:var(--xeg-spacing-sm);background:var(--xeg-bg-overlay-medium);color:var(--xeg-text-inverse);border-radius:var(--xeg-radius-full);cursor:pointer;opacity:0;width:32px;height:32px;transition:var(--xeg-transition-opacity);font-size:var(--xeg-font-size-md);border:none;justify-content:center;align-items:center;display:flex;position:absolute}.huYoS:hover .feyj6{opacity:1}.feyj6:hover{background:var(--xeg-bg-overlay-strong)}.nVAwF{display:block}.GsweP{background:var(--xeg-bg-secondary);color:var(--xeg-text-secondary);flex-direction:column;justify-content:center;align-items:center;min-height:200px;display:flex;position:absolute;top:0;bottom:0;left:0;right:0}.huYoS.y9iPu .FWlk5{opacity:1}.huYoS.GsweP{border:1px solid var(--xeg-color-error,#e0245e)}.huYoS.yYtGJ ._8-c8d{scrollbar-width:thin;scrollbar-color:var(--xeg-bg-overlay-light)transparent;width:-moz-fit-content;width:fit-content;max-width:100vw;max-height:80vh;overflow:auto}.huYoS.Uc0oU ._8-c8d{width:100%}.huYoS.M9Z6M ._8-c8d{width:-moz-fit-content;width:fit-content;max-width:100%}.huYoS.-Mlrh ._8-c8d{width:100%}.huYoS.yYtGJ ._8-c8d::-webkit-scrollbar{width:8px;height:8px}.huYoS.yYtGJ ._8-c8d::-webkit-scrollbar-track{background:0 0}.huYoS.yYtGJ ._8-c8d::-webkit-scrollbar-thumb{background:var(--xeg-bg-overlay-light);border-radius:4px;transition:background .2s}.huYoS.yYtGJ ._8-c8d::-webkit-scrollbar-thumb:hover{background:var(--xeg-bg-overlay-medium)}.huYoS.yYtGJ .FWlk5{cursor:grab;min-width:auto;min-height:auto}.huYoS.yYtGJ .FWlk5:active{cursor:grabbing}.feyj6{pointer-events:auto}.hV2D2{pointer-events:none!important}.huYoS~.EA8ao,.huYoS~[data-testid],.huYoS~[role=dialog]{pointer-events:none!important;z-index:9999!important}.GUevP{border-radius:8px;width:100%;height:auto;overflow:hidden}.GUevP.yYtGJ{object-fit:none;width:auto!important;max-width:none!important;height:auto!important;max-height:none!important}.GUevP.Uc0oU{object-fit:contain;width:100%;max-width:100vw;height:auto}.GUevP.M9Z6M{width:auto}.GUevP.-Mlrh,.GUevP.M9Z6M{object-fit:contain;height:auto;max-height:80vh}.GUevP.-Mlrh{width:100%;max-width:100vw}.xeg-gallery-overlay{z-index:var(--xeg-z-gallery);background:var(--xeg-gallery-bg);opacity:1;pointer-events:auto;justify-content:center;align-items:center;transition:opacity .3s ease-in-out;display:flex;position:fixed;top:0;bottom:0;left:0;right:0}.xeg-gallery-container{flex-direction:column;width:100%;max-width:100vw;height:100%;max-height:100vh;display:flex;position:relative}.xeg-gallery-toolbar{background:var(--xeg-bg-toolbar);border-bottom:1px solid var(--xeg-border-toolbar);-webkit-backdrop-filter:blur(12px);z-index:1005;height:60px;color:var(--xeg-text-button);box-shadow:var(--xeg-shadow-toolbar);justify-content:space-between;align-items:center;padding:0 20px;display:flex;position:absolute;top:0;left:0;right:0}.xeg-toolbar-section-center,.xeg-toolbar-section-left,.xeg-toolbar-section-right{align-items:center;gap:12px;display:flex}.xeg-toolbar-section-center{flex:1;justify-content:center}.xeg-toolbar-button{background:var(--xeg-bg-button);border:1px solid var(--xeg-border-button);color:var(--xeg-text-button);cursor:pointer;-webkit-backdrop-filter:blur(8px);border-radius:10px;justify-content:center;align-items:center;min-width:36px;height:36px;padding:8px 12px;font-size:14px;font-weight:500;transition:all .2s cubic-bezier(.4,0,.2,1);display:flex;box-shadow:0 2px 8px #0f172a14,0 1px 4px #0f172a0d}.xeg-toolbar-button:hover{background:var(--xeg-bg-button-hover);color:var(--xeg-text-button-hover);transform:translateY(-2px);box-shadow:0 4px 16px #0f172a1f,0 2px 8px #0f172a14}.xeg-toolbar-button:active{transform:translateY(0)}.xeg-toolbar-button:disabled{opacity:.5;cursor:not-allowed;transform:none}.xeg-toolbar-button.active{background:var(--xeg-color-primary);color:#fff;border-color:var(--xeg-color-primary)}.xeg-gallery-counter{color:var(--xeg-text-counter);background:var(--xeg-bg-counter);border:1px solid var(--xeg-border-counter);border-radius:8px;margin-left:16px;padding:6px 12px;font-size:14px;font-weight:600;box-shadow:0 2px 8px #0f172a0f}.xeg-fit-buttons,.xeg-gallery-counter{-webkit-backdrop-filter:blur(8px)}.xeg-fit-buttons{background:var(--xeg-neutral-100);border:1px solid var(--xeg-neutral-200);border-radius:8px;gap:4px;padding:4px;display:flex}.xeg-download-progress{background:var(--xeg-bg-toolbar);border:1px solid var(--xeg-border-toolbar);text-align:center;min-width:200px;box-shadow:0 4px 12px var(--xeg-shadow-toolbar);-webkit-backdrop-filter:blur(8px);border-radius:8px;padding:12px 16px;position:absolute;bottom:-50px;left:50%;transform:translate(-50%)}.xeg-progress-bar{background:var(--xeg-neutral-200);border-radius:2px;width:100%;height:4px;margin-bottom:8px;overflow:hidden}.xeg-progress-fill{background:linear-gradient(to right,var(--xeg-color-primary)0,var(--xeg-color-primary-hover)100%);height:100%;transition:width .3s}.xeg-progress-text{color:var(--xeg-button-text);font-size:12px;font-weight:500}.xeg-gallery-viewer{flex:1;padding:60px 20px 20px;position:relative}.xeg-gallery-media,.xeg-gallery-viewer{justify-content:center;align-items:center;display:flex}.xeg-gallery-media{max-width:100%;max-height:100%}.xeg-gallery-image,.xeg-gallery-video{object-fit:contain;border-radius:8px;max-width:100%;max-height:100%;box-shadow:0 4px 20px #0000004d}.xeg-gallery-error{color:#ffffffb3;justify-content:center;align-items:center;font-size:16px;display:flex}.xeg-gallery-nav-left,.xeg-gallery-nav-right{background:var(--xeg-bg-button-navigation);border:1px solid var(--xeg-border-button);width:50px;height:50px;color:var(--xeg-text-button-navigation);cursor:pointer;z-index:1002;-webkit-backdrop-filter:blur(12px);border-radius:50%;justify-content:center;align-items:center;font-size:20px;transition:all .3s cubic-bezier(.4,0,.2,1);display:flex;position:absolute;top:50%;transform:translateY(-50%);box-shadow:0 4px 16px #0f172a1a,0 2px 8px #0f172a0f}.xeg-gallery-nav-left{left:20px}.xeg-gallery-nav-right{right:20px}.xeg-gallery-nav-left:hover,.xeg-gallery-nav-right:hover{background:var(--xeg-bg-button-navigation-hover);transform:translateY(-50%)translateY(-3px)scale(1.05);box-shadow:0 8px 24px #0f172a26,0 4px 12px #0f172a1a}.xeg-gallery-nav-left:active,.xeg-gallery-nav-right:active{transform:translateY(-50%)translateY(0)}.xeg-gallery-nav-left:disabled,.xeg-gallery-nav-right:disabled{opacity:.5;cursor:not-allowed;transform:translateY(-50%)}.xeg-gallery-thumbnails{z-index:1002;max-width:calc(100vw - 40px);position:absolute;bottom:20px;left:50%;transform:translate(-50%)}.xeg-thumbnails-container{background:var(--xeg-bg-toolbar);border:1px solid var(--xeg-border-toolbar);-webkit-backdrop-filter:blur(12px);box-shadow:var(--xeg-shadow-toolbar);scrollbar-width:none;-ms-overflow-style:none;border-radius:16px;gap:8px;padding:14px;display:flex;overflow-x:auto}.xeg-thumbnails-container::-webkit-scrollbar{display:none}.xeg-thumbnail{cursor:pointer;background:0 0;border:2px solid #0000;border-radius:10px;flex-shrink:0;padding:0;transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;box-shadow:0 2px 8px #0f172a14}.xeg-thumbnail:hover{border-color:var(--xeg-neutral-400);transform:scale(1.08);box-shadow:0 4px 16px #0f172a1f}.xeg-thumbnail-active{border-color:var(--xeg-color-primary);box-shadow:0 4px 16px #0f172a1f,0 0 0 1px var(--xeg-color-primary-alpha-30);transform:scale(1.12)}.xeg-thumbnail-image{object-fit:cover;border-radius:6px;width:80px;height:80px;display:block}.xeg-thumbnail-indicator{background:var(--xeg-color-primary);border:2px solid #fff;border-radius:50%;width:8px;height:8px;position:absolute;top:4px;right:4px}.xeg-gallery-backdrop{z-index:1000;cursor:pointer;position:absolute;top:0;bottom:0;left:0;right:0}.xeg-gallery-open{overflow:hidden}@media (max-width:768px){.xeg-gallery-toolbar{height:50px;padding:0 12px}.xeg-toolbar-section-center,.xeg-toolbar-section-left,.xeg-toolbar-section-right{gap:8px}.xeg-toolbar-button{min-width:32px;height:32px;padding:6px 10px;font-size:12px}.xeg-gallery-counter{margin-left:8px;font-size:12px}.xeg-gallery-viewer{padding:50px 12px 12px}.xeg-gallery-nav-left,.xeg-gallery-nav-right{width:40px;height:40px;font-size:16px}.xeg-gallery-nav-left{left:12px}.xeg-gallery-nav-right{right:12px}.xeg-gallery-thumbnails{max-width:calc(100vw - 24px);bottom:12px}.xeg-thumbnails-container{gap:6px;padding:8px}.xeg-thumbnail-image{width:60px;height:60px}}@media (prefers-color-scheme:light){.xeg-gallery-overlay{background:#fffffff2}.xeg-gallery-toolbar{color:#1f2937;background:#ffffffe6}.xeg-toolbar-button{color:#1f2937;background:#0000001a}.xeg-toolbar-button:hover{background:#0003}.xeg-gallery-counter,.xeg-progress-text{color:#000c}.xeg-gallery-error{color:#000000b3}.xeg-gallery-nav-left,.xeg-gallery-nav-right{color:#1f2937;background:#0000001a}.xeg-gallery-nav-left:hover,.xeg-gallery-nav-right:hover{background:#0003}.xeg-thumbnails-container{background:#ffffffe6}}@media (prefers-reduced-motion:reduce){.xeg-gallery-nav-left,.xeg-gallery-nav-right,.xeg-gallery-overlay,.xeg-progress-fill,.xeg-thumbnail,.xeg-toolbar-button{transition:none}}@media (prefers-contrast:high){.xeg-gallery-overlay{background:#000}.xeg-gallery-toolbar{background:#000;border-bottom:2px solid #fff}.xeg-gallery-nav-left,.xeg-gallery-nav-right,.xeg-toolbar-button{color:#000;background:#fff;border:2px solid #000}}";
  (document.head || document.documentElement).appendChild(style);
  console.log('[XEG] CSS injected: ' + 55397 + ' chars');
})();
  try {
    !function(){var e,t,n,r,i,a,o=function(e){function t(e){return t='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e},t(e)}function n(e){var n=function(e){if('object'!=t(e)||!e)return e
var n=e[Symbol.toPrimitive]
if(void 0!==n){var r=n.call(e,'string')
if('object'!=t(r))return r
throw TypeError('@@toPrimitive must return a primitive value.')}return e+''}(e)
return'symbol'==t(n)?n:n+''}return e.defineProperty=function(e,t,r){return(t=n(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e}({}),s=Object.defineProperty,l=Object.getOwnPropertyDescriptor,c=Object.getOwnPropertyNames,u=Object.prototype.hasOwnProperty,d=(e,t)=>function(){return e&&(t=(0,e[c(e)[0]])(e=0)),t},f=(e,t)=>{for(var n in t)s(e,n,{get:t[n],enumerable:!0})},g=e=>((e,t,n,r)=>{if(t&&'object'==typeof t||'function'==typeof t)for(var i,a=c(t),o=0,d=a.length;d>o;o++)u.call(e,i=a[o])||void 0===i||s(e,i,{get:(e=>t[e]).bind(null,i),enumerable:!(r=l(t,i))||r.enumerable})
return e})(s({},'__esModule',{value:!0}),e),p=d({'\\0vite/preload-helper.js'(){t=function(e,t,n){function r(e){const t=new Event('vite:preloadError',{cancelable:!0})
if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return 0,Promise.resolve().then((t=>{for(const e of t||[])'rejected'===e.status&&r(e.reason)
return e().catch(r)}))}}})
function m(){try{if('undefined'!=typeof window){const e=window.GM_info,t=window.unsafeWindow
if(void 0!==e||void 0!==t)return'info'}}catch{}try{if('undefined'!=typeof process)return'info'}catch{}return'info'}function v(e,t){return r[e]>=r[t.level]}var y,_,w,b,I,S,E,x,T,M,C,k,A,P,U,D,L,R,z,N,O,$,F,V,G,B,H,j,W,q,Z,Y,X,K,J,Q,ee,te,ne,re,ie,ae,oe,se,le,ce,ue,de,he,fe,ge,pe,me,ve,ye,_e,we,be,Ie,Se,Ee,xe,Te,Me,Ce,ke,Ae,Pe,Ue,De,Le,Re,ze,Ne,Oe,$e,Fe,Ve,Ge,Be,He,je,We,qe,Ze,Ye,Xe,Ke,Je,Qe,et,tt,nt,rt,it,at,ot,st,lt,ct,ut,dt,ht,ft,gt,pt,mt,vt,yt,_t,wt,bt,It=d({'src/infrastructure/logging/logger.ts'(){n={level:m(),prefix:'[XEG]',includeTimestamp:!0,includeStackTrace:!0},r={debug:0,info:1,warn:2,error:3},i={},a=function(e={}){const t={...n,...e}
return{info:(...e)=>{v('info',t),0},warn:(...e)=>{v('warn',t),0},error:(...e)=>{if(v('error',t)&&(void 0,t.includeStackTrace&&e.length>0)){const t=e[0]
t instanceof Error&&t.stack,0}},debug:(...e)=>{v('debug',t),0},time:e=>{v('debug',t)&&(i['__timer_'+e]=Date.now())},timeEnd:e=>{if(v('debug',t)){const t='__timer_'+e
'number'==typeof i[t]?(Date.now(),void 0,delete i[t]):void 0}}}}({level:'warn',includeTimestamp:!1,includeStackTrace:!1})}}),St=d({'src/core/constants/MEDIA_CONSTANTS.ts'(){y=100,_={GUEST_AUTHORIZATION:'Bearer AAAAAAAAAAAAAAAAAAAAANRILgAAAAAAnNwIzUejRCOuH5E6I8xnZz4puTs%3D1Zv7ttfk8LF81IUq16cHjhLTvJu4FA33AGWWjCpTnA',TWEET_RESULT_BY_REST_ID_QUERY_ID:'zAz9764BcLZOJ0JU2wrd1A',USER_BY_SCREEN_NAME_QUERY_ID:'1VOOyvKkiI3FMmkeDNxM9A'}}}),Et={}
function xt(e,t){return'function'==typeof e&&(t=e,e={}),this.ondata=t,e}function Tt(e,t,n){return n||(n=t,t={}),'function'!=typeof n&&X(7),Te(e,t,[_e],(function(e){return Ee(Mt(e.data[0],e.data[1]))}),0,n)}function Mt(e,t){return he(e,t||{},0,0)}function Ct(e,t,n){return n||(n=t,t={}),'function'!=typeof n&&X(7),Te(e,t,[ye],(function(e){return Ee(kt(e.data[0],xe(e.data[1])))}),1,n)}function kt(e,t){return K(e,{i:2},t&&t.out,t&&t.dictionary)}function At(e,t,n){return n||(n=t,t={}),'function'!=typeof n&&X(7),Te(e,t,[_e,we,function(){return[Pt]}],(function(e){return Ee(Pt(e.data[0],e.data[1]))}),2,n)}function Pt(e,t){t||(t={})
var n=ue(),r=e.length
n.p(e)
var i=he(e,t,ze(t),8),a=i.length
return De(i,t),Ue(i,a-8,n.d()),Ue(i,a-4,r),i}function Ut(e,t,n){return n||(n=t,t={}),'function'!=typeof n&&X(7),Te(e,t,[ye,be,function(){return[Dt]}],(function(e){return Ee(Dt(e.data[0],e.data[1]))}),3,n)}function Dt(e,t){var n=Le(e)
return n+8>e.length&&X(6,'invalid gzip data'),K(e.subarray(n,-8),{i:2},t&&t.out||new I(Re(e)),t&&t.dictionary)}function Lt(e,t,n){return n||(n=t,t={}),'function'!=typeof n&&X(7),Te(e,t,[_e,Ie,function(){return[Rt]}],(function(e){return Ee(Rt(e.data[0],e.data[1]))}),4,n)}function Rt(e,t){t||(t={})
var n=de()
n.p(e)
var r=he(e,t,t.dictionary?6:2,4)
return Ne(r,t),Ue(r,r.length-4,n.d()),r}function zt(e,t,n){return n||(n=t,t={}),'function'!=typeof n&&X(7),Te(e,t,[ye,Se,function(){return[Nt]}],(function(e){return Ee(Nt(e.data[0],xe(e.data[1])))}),5,n)}function Nt(e,t){return K(e.subarray(Oe(e,t&&t.dictionary),-4),{i:2},t&&t.out,t&&t.dictionary)}function Ot(e,t,n){return n||(n=t,t={}),'function'!=typeof n&&X(7),31==e[0]&&139==e[1]&&8==e[2]?Ut(e,t,n):8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31?Ct(e,t,n):zt(e,t,n)}function $t(e,t){return 31==e[0]&&139==e[1]&&8==e[2]?Dt(e,t):8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31?kt(e,t):Nt(e,t)}function Ft(e,t){if(t){for(var n=new I(e.length),r=0;e.length>r;++r)n[r]=e.charCodeAt(r)
return n}if(et)return et.encode(e)
var i=e.length,a=new I(e.length+(e.length>>1)),o=0,s=function(e){a[o++]=e}
for(r=0;i>r;++r){if(o+5>a.length){var l=new I(o+8+(i-r<<1))
l.set(a),a=l}var c=e.charCodeAt(r)
128>c||t?s(c):2048>c?(s(192|c>>6),s(128|63&c)):c>55295&&57344>c?(s(240|(c=65536+(1047552&c)|1023&e.charCodeAt(++r))>>18),s(128|c>>12&63),s(128|c>>6&63),s(128|63&c)):(s(224|c>>12),s(128|c>>6&63),s(128|63&c))}return q(a,0,o)}function Vt(e,t){if(t){for(var n='',r=0;e.length>r;r+=16384)n+=String.fromCharCode.apply(null,e.subarray(r,r+16384))
return n}if(tt)return tt.decode(e)
var i=rt(e),a=i.s
return(n=i.r).length&&X(8),a}function Gt(e,t,n){n||(n=t,t={}),'function'!=typeof n&&X(7)
var r={}
Qe(e,'',r,t)
var i=Object.keys(r),a=i.length,o=0,s=0,l=a,c=Array(a),u=[],d=function(){for(var e=0;u.length>e;++e)u[e]()},f=function(e,t){bt((function(){n(e,t)}))}
bt((function(){f=n}))
var g=function(){var e=new I(s+22),t=o,n=s-o
s=0
for(var r=0;l>r;++r){var i=c[r]
try{var a=i.c.length
dt(e,s,i,i.f,i.u,a)
var u=30+i.f.length+ut(i.extra),d=s+u
e.set(i.c,d),dt(e,o,i,i.f,i.u,a,s,i.m),o+=16+u+(i.m?i.m.length:0),s=d+a}catch(g){return f(g,null)}}ht(e,o,c.length,n,t),f(null,e)}
a||g()
for(var p=function(e){var t=i[e],n=r[t],l=n[0],p=n[1],m=ue(),v=l.length
m.p(l)
var y=Ft(t),_=y.length,w=p.comment,b=w&&Ft(w),I=b&&b.length,S=ut(p.extra),E=0==p.level?0:8,x=function(n,r){if(n)d(),f(n,null)
else{var i=r.length
c[e]=fe(p,{size:v,crc:m.d(),c:r,f:y,m:b,u:_!=t.length||b&&w.length!=I,compression:E}),o+=30+_+S+i,s+=76+2*(_+S)+(I||0)+i,--a||g()}}
if(_>65535&&x(X(11,0,1),null),E)if(16e4>v)try{x(null,Mt(l,p))}catch(T){x(T,null)}else u.push(Tt(l,p,x))
else x(null,l)},m=0;l>m;++m)p(m)
return d}function Bt(e,t){t||(t={})
var n={},r=[]
Qe(e,'',n,t)
var i=0,a=0
for(var o in n){var s=n[o],l=s[0],c=s[1],u=0==c.level?0:8,d=(x=Ft(o)).length,f=c.comment,g=f&&Ft(f),p=g&&g.length,m=ut(c.extra)
d>65535&&X(11)
var v=u?Mt(l,c):l,y=v.length,_=ue()
_.p(l),r.push(fe(c,{size:l.length,crc:_.d(),c:v,f:x,m:g,u:d!=o.length||g&&f.length!=p,o:i,compression:u})),i+=30+d+m+y,a+=76+2*(d+m)+(p||0)+y}for(var w=new I(a+22),b=i,S=a-i,E=0;r.length>E;++E){var x
dt(w,(x=r[E]).o,x,x.f,x.u,x.c.length)
var T=30+x.f.length+ut(x.extra)
w.set(x.c,x.o+T),dt(w,i,x,x.f,x.u,x.c.length,x.o,x.m),i+=16+T+(x.m?x.m.length:0)}return ht(w,i,r.length,S,b),w}function Ht(e,t,n){n||(n=t,t={}),'function'!=typeof n&&X(7)
var r=[],i=function(){for(var e=0;r.length>e;++e)r[e]()},a={},o=function(e,t){bt((function(){n(e,t)}))}
bt((function(){o=n}))
for(var s=e.length-22;101010256!=Ae(e,s);--s)if(!s||e.length-s>65558)return o(X(13,0,1),null),i
var l=ke(e,s+8)
if(l){var c=l,u=Ae(e,s+16),d=4294967295==u||65535==c
if(d){var f=Ae(e,s-12);(d=101075792==Ae(e,f))&&(c=l=Ae(e,f+32),u=Ae(e,f+48))}for(var g=t&&t.filter,p=function(t){var n=lt(e,u,d),s=n[0],c=n[1],f=n[2],p=n[3],m=n[4],v=st(e,n[5])
u=m
var y=function(e,t){e?(i(),o(e,null)):(t&&(a[p]=t),--l||o(null,a))}
if(!g||g({name:p,size:c,originalSize:f,compression:s}))if(s)if(8==s){var _=e.subarray(v,v+c)
if(524288>f||c>.8*f)try{y(null,kt(_,{out:new I(f)}))}catch(w){y(w,null)}else r.push(Ct(_,{size:f},y))}else y(X(14,'unknown compression type '+s,1),null)
else y(null,q(e,v,v+c))
else y(null,null)},m=0;c>m;++m)p()}else o(null,{})
return i}function jt(e,t){for(var n={},r=e.length-22;101010256!=Ae(e,r);--r)r&&65558>=e.length-r||X(13)
var i=ke(e,r+8)
if(!i)return{}
var a=Ae(e,r+16),o=4294967295==a||65535==i
if(o){var s=Ae(e,r-12);(o=101075792==Ae(e,s))&&(i=Ae(e,s+32),a=Ae(e,s+48))}for(var l=t&&t.filter,c=0;i>c;++c){var u=lt(e,a,o),d=u[0],f=u[1],g=u[2],p=u[3],m=u[4],v=st(e,u[5])
a=m,l&&!l({name:p,size:f,originalSize:g,compression:d})||(d?8==d?n[p]=kt(e.subarray(v,v+f),{out:new I(g)}):X(14,'unknown compression type '+d):n[p]=q(e,v,v+f))}return n}f(Et,{AsyncCompress:()=>He,AsyncDecompress:()=>Je,AsyncDeflate:()=>Fe,AsyncGunzip:()=>We,AsyncGzip:()=>He,AsyncInflate:()=>Ge,AsyncUnzipInflate:()=>_t,AsyncUnzlib:()=>Xe,AsyncZipDeflate:()=>pt,AsyncZlib:()=>Ze,Compress:()=>Be,DecodeUTF8:()=>it,Decompress:()=>Ke,Deflate:()=>$e,EncodeUTF8:()=>at,FlateErrorCode:()=>Z,Gunzip:()=>je,Gzip:()=>Be,Inflate:()=>Ve,Unzip:()=>wt,UnzipInflate:()=>yt,UnzipPassThrough:()=>vt,Unzlib:()=>Ye,Zip:()=>mt,ZipDeflate:()=>gt,ZipPassThrough:()=>ft,Zlib:()=>qe,compress:()=>At,compressSync:()=>Pt,decompress:()=>Ot,decompressSync:()=>$t,deflate:()=>Tt,deflateSync:()=>Mt,gunzip:()=>Ut,gunzipSync:()=>Dt,gzip:()=>At,gzipSync:()=>Pt,inflate:()=>Ct,inflateSync:()=>kt,strFromU8:()=>Vt,strToU8:()=>Ft,unzip:()=>Ht,unzipSync:()=>jt,unzlib:()=>zt,unzlibSync:()=>Nt,zip:()=>Gt,zipSync:()=>Bt,zlib:()=>Lt,zlibSync:()=>Rt})
var Wt,qt,Zt,Yt,Xt,Kt,Jt,Qt,en,tn,nn,rn,an,on,sn,ln,cn,un=d({'node_modules/fflate/esm/browser.js'(){w={},b=function(e,t,n,r,i){var a=new Worker(w[t]||(w[t]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:'text/javascript'}))))
return a.onmessage=function(e){var t=e.data,n=t.$e$
if(n){var r=Error(n[0])
r.code=n[1],r.stack=n[2],i(r,null)}else i(null,t)},a.postMessage(n,r),a},I=Uint8Array,S=Uint16Array,E=Int32Array,x=new I([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),T=new I([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),M=new I([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),k=(C=function(e,t){for(var n=new S(31),r=0;31>r;++r)n[r]=t+=1<<e[r-1]
var i=new E(n[30])
for(r=1;30>r;++r)for(var a=n[r];n[r+1]>a;++a)i[a]=a-n[r]<<5|r
return{b:n,r:i}})(x,2),P=k.r,(A=k.b)[28]=258,P[258]=28,U=C(T,0),D=U.b,L=U.r,R=new S(32768)
for(var e=0;32768>e;++e){var t=(43690&e)>>1|(21845&e)<<1
R[e]=((65280&(t=(61680&(t=(52428&t)>>2|(13107&t)<<2))>>4|(3855&t)<<4))>>8|(255&t)<<8)>>1}for(z=function(e,t,n){for(var r=e.length,i=0,a=new S(t);r>i;++i)e[i]&&++a[e[i]-1]
var o,s=new S(t)
for(i=1;t>i;++i)s[i]=s[i-1]+a[i-1]<<1
if(n){o=new S(1<<t)
var l=15-t
for(i=0;r>i;++i)if(e[i])for(var c=i<<4|e[i],u=t-e[i],d=s[e[i]-1]++<<u,f=d|(1<<u)-1;f>=d;++d)o[R[d]>>l]=c}else for(o=new S(r),i=0;r>i;++i)e[i]&&(o[i]=R[s[e[i]-1]++]>>15-e[i])
return o},N=new I(288),e=0;144>e;++e)N[e]=8
for(e=144;256>e;++e)N[e]=9
for(e=256;280>e;++e)N[e]=7
for(e=280;288>e;++e)N[e]=8
for(O=new I(32),e=0;32>e;++e)O[e]=5
$=z(N,9,0),F=z(N,9,1),V=z(O,5,0),G=z(O,5,1),B=function(e){for(var t=e[0],n=1;e.length>n;++n)e[n]>t&&(t=e[n])
return t},H=function(e,t,n){var r=t/8|0
return(e[r]|e[r+1]<<8)>>(7&t)&n},j=function(e,t){var n=t/8|0
return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},W=function(e){return(e+7)/8|0},q=function(e,t,n){return(null==t||0>t)&&(t=0),(null==n||n>e.length)&&(n=e.length),new I(e.subarray(t,n))},Z={UnexpectedEOF:0,InvalidBlockType:1,InvalidLengthLiteral:2,InvalidDistance:3,StreamFinished:4,NoStreamHandler:5,InvalidHeader:6,NoCallback:7,InvalidUTF8:8,ExtraFieldTooLong:9,InvalidDate:10,FilenameTooLong:11,StreamFinishing:12,InvalidZipData:13,UnknownCompressionMethod:14},Y=['unexpected EOF','invalid block type','invalid length/literal','invalid distance','stream finished','no stream handler',,'no callback','invalid UTF-8 data','extra field too long','date not in range 1980-2099','filename too long','stream finishing','invalid zip data'],X=function(e,t,n){var r=Error(t||Y[e])
if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,X),!n)throw r
return r},K=function(e,t,n,r){var i=e.length,a=r?r.length:0
if(!i||t.f&&!t.l)return n||new I(0)
var o=!n,s=o||2!=t.i,l=t.i
o&&(n=new I(3*i))
var c=function(e){var t=n.length
if(e>t){var r=new I(Math.max(2*t,e))
r.set(n),n=r}},u=t.f||0,d=t.p||0,f=t.b||0,g=t.l,p=t.d,m=t.m,v=t.n,y=8*i
do{if(!g){u=H(e,d,1)
var _=H(e,d+1,3)
if(d+=3,!_){var w=e[(O=W(d)+4)-4]|e[O-3]<<8,b=O+w
if(b>i){l&&X(0)
break}s&&c(f+w),n.set(e.subarray(O,b),f),t.b=f+=w,t.p=d=8*b,t.f=u
continue}if(1==_)g=F,p=G,m=9,v=5
else if(2==_){var S=H(e,d,31)+257,E=H(e,d+10,15)+4,C=S+H(e,d+5,31)+1
d+=14
for(var k=new I(C),P=new I(19),U=0;E>U;++U)P[M[U]]=H(e,d+3*U,7)
d+=3*E
var L=B(P),R=(1<<L)-1,N=z(P,L,1)
for(U=0;C>U;){var O,$=N[H(e,d,R)]
if(d+=15&$,16>(O=$>>4))k[U++]=O
else{var V=0,Z=0
for(16==O?(Z=3+H(e,d,3),d+=2,V=k[U-1]):17==O?(Z=3+H(e,d,7),d+=3):18==O&&(Z=11+H(e,d,127),d+=7);Z--;)k[U++]=V}}var Y=k.subarray(0,S),K=k.subarray(S)
m=B(Y),v=B(K),g=z(Y,m,1),p=z(K,v,1)}else X(1)
if(d>y){l&&X(0)
break}}s&&c(f+131072)
for(var J=(1<<m)-1,Q=(1<<v)-1,ee=d;;ee=d){var te=(V=g[j(e,d)&J])>>4
if((d+=15&V)>y){l&&X(0)
break}if(V||X(2),256>te)n[f++]=te
else{if(256==te){ee=d,g=null
break}var ne=te-254
te>264&&(ne=H(e,d,(1<<(ae=x[U=te-257]))-1)+A[U],d+=ae)
var re=p[j(e,d)&Q],ie=re>>4
if(re||X(3),d+=15&re,K=D[ie],ie>3){var ae=T[ie]
K+=j(e,d)&(1<<ae)-1,d+=ae}if(d>y){l&&X(0)
break}s&&c(f+131072)
var oe=f+ne
if(K>f){var se=a-K,le=Math.min(K,oe)
for(0>se+f&&X(3);le>f;++f)n[f]=r[se+f]}for(;oe>f;++f)n[f]=n[f-K]}}t.l=g,t.p=ee,t.b=f,t.f=u,g&&(u=1,t.m=m,t.d=p,t.n=v)}while(!u)
return f!=n.length&&o?q(n,0,f):n.subarray(0,f)},J=function(e,t,n){var r=t/8|0
e[r]|=n<<=7&t,e[r+1]|=n>>8},Q=function(e,t,n){var r=t/8|0
e[r]|=n<<=7&t,e[r+1]|=n>>8,e[r+2]|=n>>16},ee=function(e,t){for(var n=[],r=0;e.length>r;++r)e[r]&&n.push({s:r,f:e[r]})
var i=n.length,a=n.slice()
if(!i)return{t:se,l:0}
if(1==i){var o=new I(n[0].s+1)
return o[n[0].s]=1,{t:o,l:1}}n.sort((function(e,t){return e.f-t.f})),n.push({s:-1,f:25001})
var s=n[0],l=n[1],c=0,u=1,d=2
for(n[0]={s:-1,f:s.f+l.f,l:s,r:l};u!=i-1;)s=n[n[d].f>n[c].f?c++:d++],l=n[c!=u&&n[d].f>n[c].f?c++:d++],n[u++]={s:-1,f:s.f+l.f,l:s,r:l}
var f=a[0].s
for(r=1;i>r;++r)a[r].s>f&&(f=a[r].s)
var g=new S(f+1),p=te(n[u-1],g,0)
if(p>t){r=0
var m=0,v=p-t,y=1<<v
for(a.sort((function(e,t){return g[t.s]-g[e.s]||e.f-t.f}));i>r;++r){var _=a[r].s
if(t>=g[_])break
m+=y-(1<<p-g[_]),g[_]=t}for(m>>=v;m>0;){var w=a[r].s
t>g[w]?m-=1<<t-g[w]++-1:++r}for(;r>=0&&m;--r){var b=a[r].s
g[b]==t&&(--g[b],++m)}p=t}return{t:new I(g),l:p}},te=function(e,t,n){return-1==e.s?Math.max(te(e.l,t,n+1),te(e.r,t,n+1)):t[e.s]=n},ne=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new S(++t),r=0,i=e[0],a=1,o=function(e){n[r++]=e},s=1;t>=s;++s)if(e[s]==i&&s!=t)++a
else{if(!i&&a>2){for(;a>138;a-=138)o(32754)
a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(i),--a;a>6;a-=6)o(8304)
a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(i)
a=1,i=e[s]}return{c:n.subarray(0,r),n:t}},re=function(e,t){for(var n=0,r=0;t.length>r;++r)n+=e[r]*t[r]
return n},ie=function(e,t,n){var r=n.length,i=W(t+2)
e[i]=255&r,e[i+1]=r>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1]
for(var a=0;r>a;++a)e[i+a+4]=n[a]
return 8*(i+4+r)},ae=function(e,t,n,r,i,a,o,s,l,c,u){J(t,u++,n),++i[256]
for(var d=ee(i,15),f=d.t,g=d.l,p=ee(a,15),m=p.t,v=p.l,y=ne(f),_=y.c,w=y.n,b=ne(m),I=b.c,E=b.n,C=new S(19),k=0;_.length>k;++k)++C[31&_[k]]
for(k=0;I.length>k;++k)++C[31&I[k]]
for(var A=ee(C,7),P=A.t,U=A.l,D=19;D>4&&!P[M[D-1]];--D);var L,R,F,G,B=c+5<<3,H=re(i,N)+re(a,O)+o,j=re(i,f)+re(a,m)+o+14+3*D+re(C,P)+2*C[16]+3*C[17]+7*C[18]
if(l>=0&&H>=B&&j>=B)return ie(t,u,e.subarray(l,l+c))
if(J(t,u,1+(H>j)),u+=2,H>j){L=z(f,g,0),R=f,F=z(m,v,0),G=m
var W=z(P,U,0)
for(J(t,u,w-257),J(t,u+5,E-1),J(t,u+10,D-4),u+=14,k=0;D>k;++k)J(t,u+3*k,P[M[k]])
u+=3*D
for(var q=[_,I],Z=0;2>Z;++Z){var Y=q[Z]
for(k=0;Y.length>k;++k)J(t,u,W[K=31&Y[k]]),u+=P[K],K>15&&(J(t,u,Y[k]>>5&127),u+=Y[k]>>12)}}else L=$,R=N,F=V,G=O
for(k=0;s>k;++k){var X=r[k]
if(X>255){var K
Q(t,u,L[257+(K=X>>18&31)]),u+=R[K+257],K>7&&(J(t,u,X>>23&31),u+=x[K])
var te=31&X
Q(t,u,F[te]),u+=G[te],te>3&&(Q(t,u,X>>5&8191),u+=T[te])}else Q(t,u,L[X]),u+=R[X]}return Q(t,u,L[256]),u+R[256]},oe=new E([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),se=new I(0),le=function(e,t,n,r,i,a){var o=a.z||e.length,s=new I(r+o+5*(1+Math.ceil(o/7e3))+i),l=s.subarray(r,s.length-i),c=a.l,u=7&(a.r||0)
if(t){u&&(l[0]=a.r>>3)
for(var d=oe[t-1],f=d>>13,g=8191&d,p=(1<<n)-1,m=a.p||new S(32768),v=a.h||new S(p+1),y=Math.ceil(n/3),_=2*y,w=function(t){return(e[t]^e[t+1]<<y^e[t+2]<<_)&p},b=new E(25e3),M=new S(288),C=new S(32),k=0,A=0,U=a.i||0,D=0,R=a.w||0,z=0;o>U+2;++U){var N=w(U),O=32767&U,$=v[N]
if(m[O]=$,v[N]=O,U>=R){var F=o-U
if((k>7e3||D>24576)&&(F>423||!c)){u=ae(e,l,0,b,M,C,A,D,z,U-z,u),D=k=A=0,z=U
for(var V=0;286>V;++V)M[V]=0
for(V=0;30>V;++V)C[V]=0}var G=2,B=0,H=g,j=O-$&32767
if(F>2&&N==w(U-j))for(var Z=Math.min(f,F)-1,Y=Math.min(32767,U),X=Math.min(258,F);Y>=j&&--H&&O!=$;){if(e[U+G]==e[U+G-j]){for(var K=0;X>K&&e[U+K]==e[U+K-j];++K);if(K>G){if(G=K,B=j,K>Z)break
var J=Math.min(j,K-2),Q=0
for(V=0;J>V;++V){var ee=U-j+V&32767,te=ee-m[ee]&32767
te>Q&&(Q=te,$=ee)}}}j+=(O=$)-($=m[O])&32767}if(B){b[D++]=268435456|P[G]<<18|L[B]
var ne=31&P[G],re=31&L[B]
A+=x[ne]+T[re],++M[257+ne],++C[re],R=U+G,++k}else b[D++]=e[U],++M[e[U]]}}for(U=Math.max(U,R);o>U;++U)b[D++]=e[U],++M[e[U]]
u=ae(e,l,c,b,M,C,A,D,z,U-z,u),c||(a.r=7&u|l[u/8|0]<<3,u-=7,a.h=v,a.p=m,a.i=U,a.w=R)}else{for(U=a.w||0;o+c>U;U+=65535){var se=U+65535
o>se||(l[u/8|0]=c,se=o),u=ie(l,u+1,e.subarray(U,se))}a.i=o}return q(s,0,r+W(u)+i)},ce=function(){for(var e=new Int32Array(256),t=0;256>t;++t){for(var n=t,r=9;--r;)n=(1&n&&-306674912)^n>>>1
e[t]=n}return e}(),ue=function(){var e=-1
return{p:function(t){for(var n=e,r=0;t.length>r;++r)n=ce[255&n^t[r]]^n>>>8
e=n},d:function(){return~e}}},de=function(){var e=1,t=0
return{p:function(n){for(var r=e,i=t,a=0|n.length,o=0;o!=a;){for(var s=Math.min(o+2655,a);s>o;++o)i+=r+=n[o]
r=(65535&r)+15*(r>>16),i=(65535&i)+15*(i>>16)}e=r,t=i},d:function(){return(255&(e%=65521))<<24|(65280&e)<<8|(255&(t%=65521))<<8|t>>8}}},he=function(e,t,n,r,i){if(!i&&(i={l:1},t.dictionary)){var a=t.dictionary.subarray(-32768),o=new I(a.length+e.length)
o.set(a),o.set(e,a.length),e=o,i.w=a.length}return le(e,null==t.level?6:t.level,null==t.mem?i.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,n,r,i)},fe=function(e,t){var n={}
for(var r in e)n[r]=e[r]
for(var r in t)n[r]=t[r]
return n},ge=function(e,t,n){for(var r=e(),i=''+e,a=i.slice(i.indexOf('[')+1,i.lastIndexOf(']')).replace(/\s+/g,'').split(','),o=0;r.length>o;++o){var s=r[o],l=a[o]
if('function'==typeof s){t+=';'+l+'='
var c=''+s
if(s.prototype)if(-1!=c.indexOf('[native code]')){var u=c.indexOf(' ',8)+1
t+=c.slice(u,c.indexOf('(',u))}else for(var d in t+=c,s.prototype)t+=';'+l+'.prototype.'+d+'='+s.prototype[d]
else t+=c}else n[l]=s}return t},pe=[],me=function(e){var t=[]
for(var n in e)e[n].buffer&&t.push((e[n]=new e[n].constructor(e[n])).buffer)
return t},ve=function(e,t,n,r){if(!pe[n]){for(var i='',a={},o=e.length-1,s=0;o>s;++s)i=ge(e[s],i,a)
pe[n]={c:ge(e[o],i,a),e:a}}var l=fe({},pe[n].e)
return b(pe[n].c+';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage='+t+'}',n,l,me(l),r)},ye=function(){return[I,S,E,x,T,M,A,D,F,G,R,Y,z,B,H,j,W,q,X,K,kt,Ee,xe]},_e=function(){return[I,S,E,x,T,M,P,L,$,N,V,O,R,oe,se,z,J,Q,ee,te,ne,re,ie,ae,W,q,le,he,Mt,Ee]},we=function(){return[De,ze,Ue,ue,ce]},be=function(){return[Le,Re]},Ie=function(){return[Ne,Ue,de]},Se=function(){return[Oe]},Ee=function(e){return postMessage(e,[e.buffer])},xe=function(e){return e&&{out:e.size&&new I(e.size),dictionary:e.dictionary}},Te=function(e,t,n,r,i,a){var o=ve(n,r,i,(function(e,t){o.terminate(),a(e,t)}))
return o.postMessage([e,t],t.consume?[e.buffer]:[]),function(){o.terminate()}},Me=function(e){return e.ondata=function(e,t){return postMessage([e,t],[e.buffer])},function(t){t.data.length?(e.push(t.data[0],t.data[1]),postMessage([t.data[0].length])):e.flush()}},Ce=function(e,t,n,r,i,a,o){var s,l=ve(e,r,i,(function(e,n){e?(l.terminate(),t.ondata.call(t,e)):Array.isArray(n)?1==n.length?(t.queuedSize-=n[0],t.ondrain&&t.ondrain(n[0])):(n[1]&&l.terminate(),t.ondata.call(t,e,n[0],n[1])):o(n)}))
l.postMessage(n),t.queuedSize=0,t.push=function(e,n){t.ondata||X(5),s&&t.ondata(X(4,0,1),null,!!n),t.queuedSize+=e.length,l.postMessage([e,s=n],[e.buffer])},t.terminate=function(){l.terminate()},a&&(t.flush=function(){l.postMessage([])})},ke=function(e,t){return e[t]|e[t+1]<<8},Ae=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},Pe=function(e,t){return Ae(e,t)+4294967296*Ae(e,t+4)},Ue=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},De=function(e,t){var n=t.filename
if(e[0]=31,e[1]=139,e[2]=8,e[8]=2>t.level?4:9==t.level?2:0,e[9]=3,0!=t.mtime&&Ue(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),n){e[3]=8
for(var r=0;n.length>=r;++r)e[r+10]=n.charCodeAt(r)}},Le=function(e){31==e[0]&&139==e[1]&&8==e[2]||X(6,'invalid gzip data')
var t=e[3],n=10
4&t&&(n+=2+(e[10]|e[11]<<8))
for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[n++]);return n+(2&t)},Re=function(e){var t=e.length
return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},ze=function(e){return 10+(e.filename?e.filename.length+1:0)},Ne=function(e,t){var n=t.level,r=0==n?0:6>n?1:9==n?3:2
if(e[0]=120,e[1]=r<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=de()
i.p(t.dictionary),Ue(e,2,i.d())}},Oe=function(e,t){return(8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31)&&X(6,'invalid zlib data'),(e[1]>>5&1)==+!t&&X(6,'invalid zlib data: '+(32&e[1]?'need':'unexpected')+' dictionary'),2+(e[1]>>3&4)},$e=function(){function e(e,t){if('function'==typeof e&&(t=e,e={}),this.ondata=t,this.o=e||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new I(98304),this.o.dictionary){var n=this.o.dictionary.subarray(-32768)
this.b.set(n,32768-n.length),this.s.i=32768-n.length}}return e.prototype.p=function(e,t){this.ondata(he(e,this.o,0,0,this.s),t)},e.prototype.push=function(e,t){this.ondata||X(5),this.s.l&&X(4)
var n=e.length+this.s.z
if(n>this.b.length){if(n>2*this.b.length-32768){var r=new I(-32768&n)
r.set(this.b.subarray(0,this.s.z)),this.b=r}var i=this.b.length-this.s.z
this.b.set(e.subarray(0,i),this.s.z),this.s.z=this.b.length,this.p(this.b,!1),this.b.set(this.b.subarray(-32768)),this.b.set(e.subarray(i),32768),this.s.z=e.length-i+32768,this.s.i=32766,this.s.w=32768}else this.b.set(e,this.s.z),this.s.z+=e.length
this.s.l=1&t,(this.s.z>this.s.w+8191||t)&&(this.p(this.b,t||!1),this.s.w=this.s.i,this.s.i-=2)},e.prototype.flush=function(){this.ondata||X(5),this.s.l&&X(4),this.p(this.b,!1),this.s.w=this.s.i,this.s.i-=2},e}(),Fe=function(){return function(e,t){Ce([_e,function(){return[Me,$e]}],this,xt.call(this,e,t),(function(e){var t=new $e(e.data)
onmessage=Me(t)}),6,1)}}(),Ve=function(){function e(e,t){'function'==typeof e&&(t=e,e={}),this.ondata=t
var n=e&&e.dictionary&&e.dictionary.subarray(-32768)
this.s={i:0,b:n?n.length:0},this.o=new I(32768),this.p=new I(0),n&&this.o.set(n)}return e.prototype.e=function(e){if(this.ondata||X(5),this.d&&X(4),this.p.length){if(e.length){var t=new I(this.p.length+e.length)
t.set(this.p),t.set(e,this.p.length),this.p=t}}else this.p=e},e.prototype.c=function(e){this.s.i=+(this.d=e||!1)
var t=this.s.b,n=K(this.p,this.s,this.o)
this.ondata(q(n,t,this.s.b),this.d),this.o=q(n,this.s.b-32768),this.s.b=this.o.length,this.p=q(this.p,this.s.p/8|0),this.s.p&=7},e.prototype.push=function(e,t){this.e(e),this.c(t)},e}(),Ge=function(){return function(e,t){Ce([ye,function(){return[Me,Ve]}],this,xt.call(this,e,t),(function(e){var t=new Ve(e.data)
onmessage=Me(t)}),7,0)}}(),Be=function(){function e(e,t){this.c=ue(),this.l=0,this.v=1,$e.call(this,e,t)}return e.prototype.push=function(e,t){this.c.p(e),this.l+=e.length,$e.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){var n=he(e,this.o,this.v&&ze(this.o),t&&8,this.s)
this.v&&(De(n,this.o),this.v=0),t&&(Ue(n,n.length-8,this.c.d()),Ue(n,n.length-4,this.l)),this.ondata(n,t)},e.prototype.flush=function(){$e.prototype.flush.call(this)},e}(),He=function(){return function(e,t){Ce([_e,we,function(){return[Me,$e,Be]}],this,xt.call(this,e,t),(function(e){var t=new Be(e.data)
onmessage=Me(t)}),8,1)}}(),je=function(){function e(e,t){this.v=1,this.r=0,Ve.call(this,e,t)}return e.prototype.push=function(e,t){if(Ve.prototype.e.call(this,e),this.r+=e.length,this.v){var n=this.p.subarray(this.v-1),r=n.length>3?Le(n):4
if(r>n.length){if(!t)return}else this.v>1&&this.onmember&&this.onmember(this.r-n.length)
this.p=n.subarray(r),this.v=0}Ve.prototype.c.call(this,t),!this.s.f||this.s.l||t||(this.v=W(this.s.p)+9,this.s={i:0},this.o=new I(0),this.push(new I(0),t))},e}(),We=function(){return function(e,t){var n=this
Ce([ye,be,function(){return[Me,Ve,je]}],this,xt.call(this,e,t),(function(e){var t=new je(e.data)
t.onmember=function(e){return postMessage(e)},onmessage=Me(t)}),9,0,(function(e){return n.onmember&&n.onmember(e)}))}}(),qe=function(){function e(e,t){this.c=de(),this.v=1,$e.call(this,e,t)}return e.prototype.push=function(e,t){this.c.p(e),$e.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){var n=he(e,this.o,this.v&&(this.o.dictionary?6:2),t&&4,this.s)
this.v&&(Ne(n,this.o),this.v=0),t&&Ue(n,n.length-4,this.c.d()),this.ondata(n,t)},e.prototype.flush=function(){$e.prototype.flush.call(this)},e}(),Ze=function(){return function(e,t){Ce([_e,Ie,function(){return[Me,$e,qe]}],this,xt.call(this,e,t),(function(e){var t=new qe(e.data)
onmessage=Me(t)}),10,1)}}(),Ye=function(){function e(e,t){Ve.call(this,e,t),this.v=e&&e.dictionary?2:1}return e.prototype.push=function(e,t){if(Ve.prototype.e.call(this,e),this.v){if(6>this.p.length&&!t)return
this.p=this.p.subarray(Oe(this.p,this.v-1)),this.v=0}t&&(4>this.p.length&&X(6,'invalid zlib data'),this.p=this.p.subarray(0,-4)),Ve.prototype.c.call(this,t)},e}(),Xe=function(){return function(e,t){Ce([ye,Se,function(){return[Me,Ve,Ye]}],this,xt.call(this,e,t),(function(e){var t=new Ye(e.data)
onmessage=Me(t)}),11,0)}}(),Ke=function(){function e(e,t){this.o=xt.call(this,e,t)||{},this.G=je,this.I=Ve,this.Z=Ye}return e.prototype.i=function(){var e=this
this.s.ondata=function(t,n){e.ondata(t,n)}},e.prototype.push=function(e,t){if(this.ondata||X(5),this.s)this.s.push(e,t)
else{if(this.p&&this.p.length){var n=new I(this.p.length+e.length)
n.set(this.p),n.set(e,this.p.length)}else this.p=e
this.p.length>2&&(this.s=31==this.p[0]&&139==this.p[1]&&8==this.p[2]?new this.G(this.o):8!=(15&this.p[0])||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(this.o):new this.Z(this.o),this.i(),this.s.push(this.p,t),this.p=null)}},e}(),Je=function(){function e(e,t){Ke.call(this,e,t),this.queuedSize=0,this.G=We,this.I=Ge,this.Z=Xe}return e.prototype.i=function(){var e=this
this.s.ondata=function(t,n,r){e.ondata(t,n,r)},this.s.ondrain=function(t){e.queuedSize-=t,e.ondrain&&e.ondrain(t)}},e.prototype.push=function(e,t){this.queuedSize+=e.length,Ke.prototype.push.call(this,e,t)},e}(),Qe=function(e,t,n,r){for(var i in e){var a=e[i],o=t+i,s=r
Array.isArray(a)&&(s=fe(r,a[1]),a=a[0]),a instanceof I?n[o]=[a,s]:(n[o+='/']=[new I(0),s],Qe(a,o,n,r))}},et='undefined'!=typeof TextEncoder&&new TextEncoder,tt='undefined'!=typeof TextDecoder&&new TextDecoder,nt=0
try{tt.decode(se,{stream:!0}),nt=1}catch(n){}rt=function(e){for(var t='',n=0;;){var r=e[n++],i=(r>127)+(r>223)+(r>239)
if(n+i>e.length)return{s:t,r:q(e,n-1)}
i?3==i?(r=((15&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536,t+=String.fromCharCode(55296|r>>10,56320|1023&r)):t+=String.fromCharCode(1&i?(31&r)<<6|63&e[n++]:(15&r)<<12|(63&e[n++])<<6|63&e[n++]):t+=String.fromCharCode(r)}},it=function(){function e(e){this.ondata=e,nt?this.t=new TextDecoder:this.p=se}return e.prototype.push=function(e,t){if(this.ondata||X(5),t=!!t,this.t)return this.ondata(this.t.decode(e,{stream:!0}),t),t&&(this.t.decode().length&&X(8),this.t=null),void 0
this.p||X(4)
var n=new I(this.p.length+e.length)
n.set(this.p),n.set(e,this.p.length)
var r=rt(n),i=r.s,a=r.r
t?(a.length&&X(8),this.p=null):this.p=a,this.ondata(i,t)},e}(),at=function(){function e(e){this.ondata=e}return e.prototype.push=function(e,t){this.ondata||X(5),this.d&&X(4),this.ondata(Ft(e),this.d=t||!1)},e}(),ot=function(e){return 1==e?3:6>e?2:9==e?1:0},st=function(e,t){return t+30+ke(e,t+26)+ke(e,t+28)},lt=function(e,t,n){var r=ke(e,t+28),i=Vt(e.subarray(t+46,t+46+r),!(2048&ke(e,t+8))),a=t+46+r,o=Ae(e,t+20),s=n&&4294967295==o?ct(e,a):[o,Ae(e,t+24),Ae(e,t+42)],l=s[0],c=s[1],u=s[2]
return[ke(e,t+10),l,c,i,a+ke(e,t+30)+ke(e,t+32),u]},ct=function(e,t){for(;1!=ke(e,t);t+=4+ke(e,t+2));return[Pe(e,t+12),Pe(e,t+4),Pe(e,t+20)]},ut=function(e){var t=0
if(e)for(var n in e){var r=e[n].length
r>65535&&X(9),t+=r+4}return t},dt=function(e,t,n,r,i,a,o,s){var l=r.length,c=n.extra,u=s&&s.length,d=ut(c)
Ue(e,t,null!=o?33639248:67324752),t+=4,null!=o&&(e[t++]=20,e[t++]=n.os),e[t]=20,t+=2,e[t++]=n.flag<<1|(0>a&&8),e[t++]=i&&8,e[t++]=255&n.compression,e[t++]=n.compression>>8
var f=new Date(null==n.mtime?Date.now():n.mtime),g=f.getFullYear()-1980
if((0>g||g>119)&&X(10),Ue(e,t,g<<25|f.getMonth()+1<<21|f.getDate()<<16|f.getHours()<<11|f.getMinutes()<<5|f.getSeconds()>>1),t+=4,-1!=a&&(Ue(e,t,n.crc),Ue(e,t+4,0>a?-a-2:a),Ue(e,t+8,n.size)),Ue(e,t+12,l),Ue(e,t+14,d),t+=16,null!=o&&(Ue(e,t,u),Ue(e,t+6,n.attrs),Ue(e,t+10,o),t+=14),e.set(r,t),t+=l,d)for(var p in c){var m=c[p],v=m.length
Ue(e,t,+p),Ue(e,t+2,v),e.set(m,t+4),t+=4+v}return u&&(e.set(s,t),t+=u),t},ht=function(e,t,n,r,i){Ue(e,t,101010256),Ue(e,t+8,n),Ue(e,t+10,n),Ue(e,t+12,r),Ue(e,t+16,i)},ft=function(){function e(e){this.filename=e,this.c=ue(),this.size=0,this.compression=0}return e.prototype.process=function(e,t){this.ondata(null,e,t)},e.prototype.push=function(e,t){this.ondata||X(5),this.c.p(e),this.size+=e.length,t&&(this.crc=this.c.d()),this.process(e,t||!1)},e}(),gt=function(){function e(e,t){var n=this
t||(t={}),ft.call(this,e),this.d=new $e(t,(function(e,t){n.ondata(null,e,t)})),this.compression=8,this.flag=ot(t.level)}return e.prototype.process=function(e,t){try{this.d.push(e,t)}catch(n){this.ondata(n,null,t)}},e.prototype.push=function(e,t){ft.prototype.push.call(this,e,t)},e}(),pt=function(){function e(e,t){var n=this
t||(t={}),ft.call(this,e),this.d=new Fe(t,(function(e,t,r){n.ondata(e,t,r)})),this.compression=8,this.flag=ot(t.level),this.terminate=this.d.terminate}return e.prototype.process=function(e,t){this.d.push(e,t)},e.prototype.push=function(e,t){ft.prototype.push.call(this,e,t)},e}(),mt=function(){function e(e){this.ondata=e,this.u=[],this.d=1}return e.prototype.add=function(e){var t=this
if(this.ondata||X(5),2&this.d)this.ondata(X(4+8*(1&this.d),0,1),null,!1)
else{var n=Ft(e.filename),r=n.length,i=e.comment,a=i&&Ft(i),o=r!=e.filename.length||a&&i.length!=a.length,s=r+ut(e.extra)+30
r>65535&&this.ondata(X(11,0,1),null,!1)
var l=new I(s)
dt(l,0,e,n,o,-1)
var c=[l],u=function(){for(var e=0,n=c;n.length>e;e++)t.ondata(null,n[e],!1)
c=[]},d=this.d
this.d=0
var f=this.u.length,g=fe(e,{f:n,u:o,o:a,t:function(){e.terminate&&e.terminate()},r:function(){if(u(),d){var e=t.u[f+1]
e?e.r():t.d=1}d=1}}),p=0
e.ondata=function(n,r,i){if(n)t.ondata(n,r,i),t.terminate()
else if(p+=r.length,c.push(r),i){var a=new I(16)
Ue(a,0,134695760),Ue(a,4,e.crc),Ue(a,8,p),Ue(a,12,e.size),c.push(a),g.c=p,g.b=s+p+16,g.crc=e.crc,g.size=e.size,d&&g.r(),d=1}else d&&u()},this.u.push(g)}},e.prototype.end=function(){var e=this
if(2&this.d)return this.ondata(X(4+8*(1&this.d),0,1),null,!0),void 0
this.d?this.e():this.u.push({r:function(){1&e.d&&(e.u.splice(-1,1),e.e())},t:function(){}}),this.d=3},e.prototype.e=function(){for(var e=0,t=0,n=0,r=0,i=this.u;i.length>r;r++)n+=46+(l=i[r]).f.length+ut(l.extra)+(l.o?l.o.length:0)
for(var a=new I(n+22),o=0,s=this.u;s.length>o;o++){var l
dt(a,e,l=s[o],l.f,l.u,-l.c-2,t,l.o),e+=46+l.f.length+ut(l.extra)+(l.o?l.o.length:0),t+=l.b}ht(a,e,this.u.length,n,t),this.ondata(null,a,!0),this.d=2},e.prototype.terminate=function(){for(var e=0,t=this.u;t.length>e;e++)t[e].t()
this.d=2},e}(),vt=function(){function e(){}return e.prototype.push=function(e,t){this.ondata(null,e,t)},e.compression=0,e}(),yt=function(){function e(){var e=this
this.i=new Ve((function(t,n){e.ondata(null,t,n)}))}return e.prototype.push=function(e,t){try{this.i.push(e,t)}catch(n){this.ondata(n,null,t)}},e.compression=8,e}(),_t=function(){function e(e,t){var n=this
32e4>t?this.i=new Ve((function(e,t){n.ondata(null,e,t)})):(this.i=new Ge((function(e,t,r){n.ondata(e,t,r)})),this.terminate=this.i.terminate)}return e.prototype.push=function(e,t){this.i.terminate&&(e=q(e,0)),this.i.push(e,t)},e.compression=8,e}(),wt=function(){function e(e){this.onfile=e,this.k=[],this.o={0:vt},this.p=se}return e.prototype.push=function(e,t){var n=this
if(this.onfile||X(5),this.p||X(4),this.c>0){var r=Math.min(this.c,e.length),i=e.subarray(0,r)
if(this.c-=r,this.d?this.d.push(i,!this.c):this.k[0].push(i),(e=e.subarray(r)).length)return this.push(e,t)}else{var a=0,o=0,s=void 0,l=void 0
this.p.length?e.length?((l=new I(this.p.length+e.length)).set(this.p),l.set(e,this.p.length)):l=this.p:l=e
for(var c=l.length,u=this.c,d=u&&this.d,f=function(){var e,t=Ae(l,o)
if(67324752==t){a=1,s=o,g.d=null,g.c=0
var r=ke(l,o+6),i=ke(l,o+8),d=2048&r,f=8&r,p=ke(l,o+26),m=ke(l,o+28)
if(c>o+30+p+m){var v=[]
g.k.unshift(v),a=2
var y,_=Ae(l,o+18),w=Ae(l,o+22),b=Vt(l.subarray(o+30,o+=30+p),!d)
4294967295==_?(e=f?[-2]:ct(l,o),_=e[0],w=e[1]):f&&(_=-1),o+=m,g.c=_
var I={name:b,compression:i,start:function(){if(I.ondata||X(5),_){var e=n.o[i]
e||I.ondata(X(14,'unknown compression type '+i,1),null,!1),(y=0>_?new e(b):new e(b,_,w)).ondata=function(e,t,n){I.ondata(e,t,n)}
for(var t=0,r=v;r.length>t;t++)y.push(r[t],!1)
n.k[0]==v&&n.c?n.d=y:y.push(se,!0)}else I.ondata(null,se,!0)},terminate:function(){y&&y.terminate&&y.terminate()}}
0>_||(I.size=_,I.originalSize=w),g.onfile(I)}return'break'}if(u){if(134695760==t)return s=o+=12+(-2==u&&8),a=3,g.c=0,'break'
if(33639248==t)return s=o-=4,a=3,g.c=0,'break'}},g=this;c-4>o&&'break'!==f();++o);if(this.p=se,0>u){var p=l.subarray(0,a?s-12-(-2==u&&8)-(134695760==Ae(l,s-16)&&4):o)
d?d.push(p,!!a):this.k[+(2==a)].push(p)}if(2&a)return this.push(l.subarray(o),t)
this.p=l.subarray(o)}t&&(this.c&&X(13),this.p=null)},e.prototype.register=function(e){this.o[e.compression]=e},e}(),bt='function'==typeof queueMicrotask?queueMicrotask:'function'==typeof setTimeout?setTimeout:function(e){e()}}}),dn={}
function hn(e,t){for(var n in t)e[n]=t[n]
return e}function fn(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function gn(e,t,n){var r,i,a,o={}
for(a in t)'key'==a?r=t[a]:'ref'==a?i=t[a]:o[a]=t[a]
if(arguments.length>2&&(o.children=arguments.length>3?Wt.call(arguments,2):n),'function'==typeof e&&null!=e.defaultProps)for(a in e.defaultProps)void 0===o[a]&&(o[a]=e.defaultProps[a])
return pn(e,o,r,i,null)}function pn(e,t,n,r,i){var a={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==i?++Zt:i,__i:-1,__u:0}
return null==i&&null!=qt.vnode&&qt.vnode(a),a}function mn(){return{current:null}}function vn(e){return e.children}function yn(e,t){this.props=e,this.context=t}function _n(e,t){if(null==t)return e.__?_n(e.__,e.__i+1):null
for(var n;e.__k.length>t;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e
return'function'==typeof e.type?_n(e):null}function wn(e){var t,n
if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;e.__k.length>t;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e
break}return wn(e)}}function bn(e){(!e.__d&&(e.__d=!0)&&Xt.push(e)&&!In.__r++||Kt!=qt.debounceRendering)&&((Kt=qt.debounceRendering)||Jt)(In)}function In(){for(var e,t,n,r,i,a,o,s=1;Xt.length;)Xt.length>s&&Xt.sort(Qt),e=Xt.shift(),s=Xt.length,e.__d&&(n=void 0,i=(r=(t=e).__v).__e,a=[],o=[],t.__P&&((n=hn({},r)).__v=r.__v+1,qt.vnode&&qt.vnode(n),An(t.__P,n,r,t.__n,t.__P.namespaceURI,32&r.__u?[i]:null,a,null==i?_n(r):i,!!(32&r.__u),o),n.__v=r.__v,n.__.__k[n.__i]=n,Pn(a,n,o),n.__e!=i&&wn(n)))
In.__r=0}function Sn(e,t,n,r,i,a,o,s,l,c,u){var d,f,g,p,m,v,y=r&&r.__k||sn,_=t.length
for(l=function(e,t,n,r,i){var a,o,s,l,c,u=n.length,d=u,f=0
for(e.__k=Array(i),a=0;i>a;a++)null!=(o=t[a])&&'boolean'!=typeof o&&'function'!=typeof o?(l=a+f,(o=e.__k[a]='string'==typeof o||'number'==typeof o||'bigint'==typeof o||o.constructor==String?pn(null,o,null,null,null):cn(o)?pn(vn,{children:o},null,null,null):null==o.constructor&&o.__b>0?pn(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=e,o.__b=e.__b+1,s=null,-1!=(c=o.__i=Tn(o,n,l,d))&&(d--,(s=n[c])&&(s.__u|=2)),null==s||null==s.__v?(-1==c&&(i>u?f--:u>i&&f++),'function'!=typeof o.type&&(o.__u|=4)):c!=l&&(c==l-1?f--:c==l+1?f++:(c>l?f--:f++,o.__u|=4))):e.__k[a]=null
if(d)for(a=0;u>a;a++)null!=(s=n[a])&&!(2&s.__u)&&(s.__e==r&&(r=_n(s)),Ln(s,s))
return r}(n,t,y,l,_),d=0;_>d;d++)null!=(g=n.__k[d])&&(f=-1==g.__i?on:y[g.__i]||on,g.__i=d,v=An(e,g,f,i,a,o,s,l,c,u),p=g.__e,g.ref&&f.ref!=g.ref&&(f.ref&&Dn(f.ref,null,g),u.push(g.ref,g.__c||p,g)),null==m&&null!=p&&(m=p),4&g.__u||f.__k===g.__k?l=En(g,l,e):'function'==typeof g.type&&void 0!==v?l=v:p&&(l=p.nextSibling),g.__u&=-7)
return n.__e=m,l}function En(e,t,n){var r,i
if('function'==typeof e.type){for(r=e.__k,i=0;r&&r.length>i;i++)r[i]&&(r[i].__=e,t=En(r[i],t,n))
return t}e.__e!=t&&(t&&e.type&&!n.contains(t)&&(t=_n(e)),n.insertBefore(e.__e,t||null),t=e.__e)
do{t=t&&t.nextSibling}while(null!=t&&8==t.nodeType)
return t}function xn(e,t){return t=t||[],null==e||'boolean'==typeof e||(cn(e)?e.some((function(e){xn(e,t)})):t.push(e)),t}function Tn(e,t,n,r){var i,a,o=e.key,s=e.type,l=t[n]
if(null===l&&null==e.key||l&&o==l.key&&s==l.type&&!(2&l.__u))return n
if(r>(null==l||2&l.__u?0:1))for(i=n-1,a=n+1;i>=0||t.length>a;){if(i>=0){if((l=t[i])&&!(2&l.__u)&&o==l.key&&s==l.type)return i
i--}if(t.length>a){if((l=t[a])&&!(2&l.__u)&&o==l.key&&s==l.type)return a
a++}}return-1}function Mn(e,t,n){'-'==t[0]?e.setProperty(t,null==n?'':n):e[t]=null==n?'':'number'!=typeof n||ln.test(t)?n:n+'px'}function Cn(e,t,n,r,i){var a,o
e:if('style'==t)if('string'==typeof n)e.style.cssText=n
else{if('string'==typeof r&&(e.style.cssText=r=''),r)for(t in r)n&&t in n||Mn(e.style,t,'')
if(n)for(t in n)r&&n[t]==r[t]||Mn(e.style,t,n[t])}else if('o'==t[0]&&'n'==t[1])a=t!=(t=t.replace(en,'$1')),o=t.toLowerCase(),t=o in e||'onFocusOut'==t||'onFocusIn'==t?o.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=n,n?r?n.u=r.u:(n.u=tn,e.addEventListener(t,a?rn:nn,a)):e.removeEventListener(t,a?rn:nn,a)
else{if('http://www.w3.org/2000/svg'==i)t=t.replace(/xlink(H|:h)/,'h').replace(/sName$/,'s')
else if('width'!=t&&'height'!=t&&'href'!=t&&'list'!=t&&'form'!=t&&'tabIndex'!=t&&'download'!=t&&'rowSpan'!=t&&'colSpan'!=t&&'role'!=t&&'popover'!=t&&t in e)try{e[t]=null==n?'':n
break e}catch(s){}'function'==typeof n||(null==n||!1===n&&'-'!=t[4]?e.removeAttribute(t):e.setAttribute(t,'popover'==t&&1==n?'':n))}}function kn(e){return function(t){if(this.l){var n=this.l[t.type+e]
if(null==t.t)t.t=tn++
else if(n.u>t.t)return
return n(qt.event?qt.event(t):t)}}}function An(e,t,n,r,i,a,o,s,l,c){var u,d,f,g,p,m,v,y,_,w,b,I,S,E,x,T,M,C=t.type
if(null!=t.constructor)return null
128&n.__u&&(l=!!(32&n.__u),a=[s=t.__e=n.__e]),(u=qt.__b)&&u(t)
e:if('function'==typeof C)try{if(y=t.props,_='prototype'in C&&C.prototype.render,w=(u=C.contextType)&&r[u.__c],b=u?w?w.props.value:u.__:r,n.__c?v=(d=t.__c=n.__c).__=d.__E:(_?t.__c=d=new C(y,b):(t.__c=d=new yn(y,b),d.constructor=C,d.render=Rn),w&&w.sub(d),d.props=y,d.state||(d.state={}),d.context=b,d.__n=r,f=d.__d=!0,d.__h=[],d._sb=[]),_&&null==d.__s&&(d.__s=d.state),_&&null!=C.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=hn({},d.__s)),hn(d.__s,C.getDerivedStateFromProps(y,d.__s))),g=d.props,p=d.state,d.__v=t,f)_&&null==C.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),_&&null!=d.componentDidMount&&d.__h.push(d.componentDidMount)
else{if(_&&null==C.getDerivedStateFromProps&&y!==g&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(y,b),!d.__e&&null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(y,d.__s,b)||t.__v==n.__v){for(t.__v!=n.__v&&(d.props=y,d.state=d.__s,d.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some((function(e){e&&(e.__=t)})),I=0;d._sb.length>I;I++)d.__h.push(d._sb[I])
d._sb=[],d.__h.length&&o.push(d)
break e}null!=d.componentWillUpdate&&d.componentWillUpdate(y,d.__s,b),_&&null!=d.componentDidUpdate&&d.__h.push((function(){d.componentDidUpdate(g,p,m)}))}if(d.context=b,d.props=y,d.__P=e,d.__e=!1,S=qt.__r,E=0,_){for(d.state=d.__s,d.__d=!1,S&&S(t),u=d.render(d.props,d.state,d.context),x=0;d._sb.length>x;x++)d.__h.push(d._sb[x])
d._sb=[]}else do{d.__d=!1,S&&S(t),u=d.render(d.props,d.state,d.context),d.state=d.__s}while(d.__d&&25>++E)
d.state=d.__s,null!=d.getChildContext&&(r=hn(hn({},r),d.getChildContext())),_&&!f&&null!=d.getSnapshotBeforeUpdate&&(m=d.getSnapshotBeforeUpdate(g,p)),T=u,null!=u&&u.type===vn&&null==u.key&&(T=Un(u.props.children)),s=Sn(e,cn(T)?T:[T],t,n,r,i,a,o,s,l,c),d.base=t.__e,t.__u&=-161,d.__h.length&&o.push(d),v&&(d.__E=d.__=null)}catch(k){if(t.__v=null,l||null!=a)if(k.then){for(t.__u|=l?160:128;s&&8==s.nodeType&&s.nextSibling;)s=s.nextSibling
a[a.indexOf(s)]=null,t.__e=s}else for(M=a.length;M--;)fn(a[M])
else t.__e=n.__e,t.__k=n.__k
qt.__e(k,t,n)}else null==a&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):s=t.__e=function(e,t,n,r,i,a,o,s,l){var c,u,d,f,g,p,m,v=n.props,y=t.props,_=t.type
if('svg'==_?i='http://www.w3.org/2000/svg':'math'==_?i='http://www.w3.org/1998/Math/MathML':i||(i='http://www.w3.org/1999/xhtml'),null!=a)for(c=0;a.length>c;c++)if((g=a[c])&&'setAttribute'in g==!!_&&(_?g.localName==_:3==g.nodeType)){e=g,a[c]=null
break}if(null==e){if(null==_)return document.createTextNode(y)
e=document.createElementNS(i,_,y.is&&y),s&&(qt.__m&&qt.__m(t,a),s=!1),a=null}if(null==_)v===y||s&&e.data==y||(e.data=y)
else{if(a=a&&Wt.call(e.childNodes),v=n.props||on,!s&&null!=a)for(v={},c=0;e.attributes.length>c;c++)v[(g=e.attributes[c]).name]=g.value
for(c in v)if(g=v[c],'children'==c);else if('dangerouslySetInnerHTML'==c)d=g
else if(!(c in y)){if('value'==c&&'defaultValue'in y||'checked'==c&&'defaultChecked'in y)continue
Cn(e,c,null,g,i)}for(c in y)g=y[c],'children'==c?f=g:'dangerouslySetInnerHTML'==c?u=g:'value'==c?p=g:'checked'==c?m=g:s&&'function'!=typeof g||v[c]===g||Cn(e,c,g,v[c],i)
if(u)s||d&&(u.__html==d.__html||u.__html==e.innerHTML)||(e.innerHTML=u.__html),t.__k=[]
else if(d&&(e.innerHTML=''),Sn('template'==t.type?e.content:e,cn(f)?f:[f],t,n,r,'foreignObject'==_?'http://www.w3.org/1999/xhtml':i,a,o,a?a[0]:n.__k&&_n(n,0),s,l),null!=a)for(c=a.length;c--;)fn(a[c])
s||(c='value','progress'==_&&null==p?e.removeAttribute('value'):null!=p&&(p!==e[c]||'progress'==_&&!p||'option'==_&&p!=v[c])&&Cn(e,c,p,v[c],i),c='checked',null!=m&&m!=e[c]&&Cn(e,c,m,v[c],i))}return e}(n.__e,t,n,r,i,a,o,l,c)
return(u=qt.diffed)&&u(t),128&t.__u?void 0:s}function Pn(e,t,n){for(var r=0;n.length>r;r++)Dn(n[r],n[++r],n[++r])
qt.__c&&qt.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(n){qt.__e(n,t.__v)}}))}function Un(e){return'object'!=typeof e||null==e||e.__b&&e.__b>0?e:cn(e)?e.map(Un):hn({},e)}function Dn(e,t,n){try{if('function'==typeof e){var r='function'==typeof e.__u
r&&e.__u(),r&&null==t||(e.__u=e(t))}else e.current=t}catch(i){qt.__e(i,n)}}function Ln(e,t,n){var r,i
if(qt.unmount&&qt.unmount(e),(r=e.ref)&&(r.current&&r.current!=e.__e||Dn(r,null,t)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(a){qt.__e(a,t)}r.base=r.__P=null}if(r=e.__k)for(i=0;r.length>i;i++)r[i]&&Ln(r[i],t,n||'function'!=typeof e.type)
n||fn(e.__e),e.__c=e.__=e.__e=void 0}function Rn(e,t,n){return this.constructor(e,n)}function zn(e,t,n){var r,i,a,o
t==document&&(t=document.documentElement),qt.__&&qt.__(e,t),i=(r='function'==typeof n)?null:n&&n.__k||t.__k,a=[],o=[],An(t,e=(!r&&n||t).__k=gn(vn,null,[e]),i||on,on,t.namespaceURI,!r&&n?[n]:i?null:t.firstChild?Wt.call(t.childNodes):null,a,!r&&n?n:i?i.__e:t.firstChild,r,o),Pn(a,e,o)}function Nn(e,t){zn(e,t,Nn)}function On(e,t,n){var r,i,a,o,s=hn({},e.props)
for(a in e.type&&e.type.defaultProps&&(o=e.type.defaultProps),t)'key'==a?r=t[a]:'ref'==a?i=t[a]:s[a]=void 0===t[a]&&null!=o?o[a]:t[a]
return arguments.length>2&&(s.children=arguments.length>3?Wt.call(arguments,2):n),pn(e.type,s,r||e.key,i||e.ref,null)}function $n(e){function t(e){var n,r
return this.getChildContext||(n=new Set,(r={})[t.__c]=this,this.getChildContext=function(){return r},this.componentWillUnmount=function(){n=null},this.shouldComponentUpdate=function(e){this.props.value!=e.value&&n.forEach((function(e){e.__e=!0,bn(e)}))},this.sub=function(e){n.add(e)
var t=e.componentWillUnmount
e.componentWillUnmount=function(){n&&n.delete(e),t&&t.call(e)}}),e.children}return t.__c='__cC'+an++,t.__=e,t.Provider=t.__l=(t.Consumer=function(e,t){return e.children(t)}).contextType=t,t}f(dn,{Component:()=>yn,Fragment:()=>vn,cloneElement:()=>On,createContext:()=>$n,createElement:()=>gn,createRef:()=>mn,h:()=>gn,hydrate:()=>Nn,isValidElement:()=>Yt,options:()=>qt,render:()=>zn,toChildArray:()=>xn})
var Fn,Vn,Gn,Bn,Hn,jn,Wn,qn,Zn,Yn,Xn,Kn,Jn,Qn,er=d({'node_modules/preact/dist/preact.module.js'(){on={},ln=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,cn=Array.isArray,Wt=(sn=[]).slice,qt={__e:function(e,t,n,r){for(var i,a,o;t=t.__;)if((i=t.__c)&&!i.__)try{if((a=i.constructor)&&null!=a.getDerivedStateFromError&&(i.setState(a.getDerivedStateFromError(e)),o=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(e,r||{}),o=i.__d),o)return i.__E=i}catch(s){e=s}throw e}},Zt=0,Yt=function(e){return null!=e&&null==e.constructor},yn.prototype.setState=function(e,t){var n
n=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=hn({},this.state),'function'==typeof e&&(e=e(hn({},n),this.props)),e&&hn(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),bn(this))},yn.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),bn(this))},yn.prototype.render=vn,Xt=[],Jt='function'==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Qt=function(e,t){return e.__v.__b-t.__v.__b},In.__r=0,en=/(PointerCapture)$|Capture$/i,tn=0,nn=kn(!1),rn=kn(!0),an=0}}),tr={}
function nr(e,t){Wn.__h&&Wn.__h(Vn,e,Hn||t),Hn=0
var n=Vn.__H||(Vn.__H={__:[],__h:[]})
return e>=n.__.length&&n.__.push({}),n.__[e]}function rr(e){return Hn=1,ir(wr,e)}function ir(e,t,n){var r=nr(Fn++,2)
if(r.t=e,!r.__c&&(r.__=[n?n(t):wr(void 0,t),function(e){var t=r.__N?r.__N[0]:r.__[0],n=r.t(t,e)
t!==n&&(r.__N=[n,r.__[1]],r.__c.setState({}))}],r.__c=Vn,!Vn.__f)){var i=function(e,t,n){if(!r.__c.__H)return!0
var i=r.__c.__H.__.filter((function(e){return!!e.__c}))
if(i.every((function(e){return!e.__N})))return!a||a.call(this,e,t,n)
var o=r.__c.props!==e
return i.forEach((function(e){if(e.__N){var t=e.__[0]
e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(o=!0)}})),a&&a.call(this,e,t,n)||o}
Vn.__f=!0
var a=Vn.shouldComponentUpdate,o=Vn.componentWillUpdate
Vn.componentWillUpdate=function(e,t,n){if(this.__e){var r=a
a=void 0,i(e,t,n),a=r}o&&o.call(this,e,t,n)},Vn.shouldComponentUpdate=i}return r.__N||r.__}function ar(e,t){var n=nr(Fn++,3)
!Wn.__s&&_r(n.__H,t)&&(n.__=e,n.u=t,Vn.__H.__h.push(n))}function or(e,t){var n=nr(Fn++,4)
!Wn.__s&&_r(n.__H,t)&&(n.__=e,n.u=t,Vn.__h.push(n))}function sr(e){return Hn=5,cr((function(){return{current:e}}),[])}function lr(e,t,n){Hn=6,or((function(){if('function'==typeof e){var n=e(t())
return function(){e(null),n&&'function'==typeof n&&n()}}if(e)return e.current=t(),function(){return e.current=null}}),null==n?n:n.concat(e))}function cr(e,t){var n=nr(Fn++,7)
return _r(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function ur(e,t){return Hn=8,cr((function(){return e}),t)}function dr(e){var t=Vn.context[e.__c],n=nr(Fn++,9)
return n.c=e,t?(n.__??(n.__=!0,t.sub(Vn)),t.props.value):e.__}function hr(e,t){Wn.useDebugValue&&Wn.useDebugValue(t?t(e):e)}function fr(e){var t=nr(Fn++,10),n=rr()
return t.__=e,Vn.componentDidCatch||(Vn.componentDidCatch=function(e,r){t.__&&t.__(e,r),n[1](e)}),[n[0],function(){n[1](void 0)}]}function gr(){var e=nr(Fn++,11)
if(!e.__){for(var t=Vn.__v;null!==t&&!t.__m&&null!==t.__;)t=t.__
var n=t.__m||(t.__m=[0,0])
e.__='P'+n[0]+'-'+n[1]++}return e.__}function pr(){for(var e;e=jn.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(vr),e.__H.__h.forEach(yr),e.__H.__h=[]}catch(t){e.__H.__h=[],Wn.__e(t,e.__v)}}function mr(e){var t,n=function(){clearTimeout(r),Qn&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,35)
Qn&&(t=requestAnimationFrame(n))}function vr(e){var t=Vn,n=e.__c
'function'==typeof n&&(e.__c=void 0,n()),Vn=t}function yr(e){var t=Vn
e.__c=e.__(),Vn=t}function _r(e,t){return!e||e.length!==t.length||t.some((function(t,n){return t!==e[n]}))}function wr(e,t){return'function'==typeof t?t(e):t}f(tr,{useCallback:()=>ur,useContext:()=>dr,useDebugValue:()=>hr,useEffect:()=>ar,useErrorBoundary:()=>fr,useId:()=>gr,useImperativeHandle:()=>lr,useLayoutEffect:()=>or,useMemo:()=>cr,useReducer:()=>ir,useRef:()=>sr,useState:()=>rr})
var br,Ir,Sr,Er,xr,Tr,Mr,Cr,kr,Ar,Pr,Ur,Dr,Lr,Rr,zr,Nr,Or,$r,Fr,Vr,Gr,Br,Hr,jr,Wr,qr,Zr=d({'node_modules/preact/hooks/dist/hooks.module.js'(){er(),Hn=0,jn=[],qn=(Wn=qt).__b,Zn=Wn.__r,Yn=Wn.diffed,Xn=Wn.__c,Kn=Wn.unmount,Jn=Wn.__,Wn.__b=function(e){Vn=null,qn&&qn(e)},Wn.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Jn&&Jn(e,t)},Wn.__r=function(e){Zn&&Zn(e),Fn=0
var t=(Vn=e.__c).__H
t&&(Gn===Vn?(t.__h=[],Vn.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.u=e.__N=void 0}))):(t.__h.forEach(vr),t.__h.forEach(yr),t.__h=[],Fn=0)),Gn=Vn},Wn.diffed=function(e){Yn&&Yn(e)
var t=e.__c
t&&t.__H&&(t.__H.__h.length&&(1!==jn.push(t)&&Bn===Wn.requestAnimationFrame||((Bn=Wn.requestAnimationFrame)||mr)(pr)),t.__H.__.forEach((function(e){e.u&&(e.__H=e.u),e.u=void 0}))),Gn=Vn=null},Wn.__c=function(e,t){t.some((function(e){try{e.__h.forEach(vr),e.__h=e.__h.filter((function(e){return!e.__||yr(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Wn.__e(n,e.__v)}})),Xn&&Xn(e,t)},Wn.unmount=function(e){Kn&&Kn(e)
var t,n=e.__c
n&&n.__H&&(n.__H.__.forEach((function(e){try{vr(e)}catch(n){t=n}})),n.__H=void 0,t&&Wn.__e(t,n.__v))},Qn='function'==typeof requestAnimationFrame}}),Yr={}
function Xr(e,t){for(var n in t)e[n]=t[n]
return e}function Kr(e,t){for(var n in e)if('__source'!==n&&!(n in t))return!0
for(var r in t)if('__source'!==r&&e[r]!==t[r])return!0
return!1}function Jr(e,t){var n=t(),r=rr({t:{__:n,u:t}}),i=r[0].t,a=r[1]
return or((function(){i.__=n,i.u=t,Qr(i)&&a({t:i})}),[e,n,t]),ar((function(){return Qr(i)&&a({t:i}),e((function(){Qr(i)&&a({t:i})}))}),[e]),n}function Qr(e){var t,n,r=e.u,i=e.__
try{var a=r()
return!((t=i)===(n=a)&&(0!==t||1/t==1/n)||t!=t&&n!=n)}catch(o){return!0}}function ei(e){e()}function ti(e){return e}function ni(){return[!1,ei]}function ri(e,t){this.props=e,this.context=t}function ii(e,t){function n(e){var n=this.props.ref,r=n==e.ref
return!r&&n&&(n.call?n(null):n.current=null),t?!t(this.props,e)||!r:Kr(this.props,e)}function r(t){return this.shouldComponentUpdate=n,gn(e,t)}return r.displayName='Memo('+(e.displayName||e.name)+')',r.prototype.isReactComponent=!0,r.__f=!0,r}function ai(e){function t(t){var n=Xr({},t)
return delete n.ref,e(n,t.ref||null)}return t.$$typeof=Sr,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName='ForwardRef('+(e.displayName||e.name)+')',t}function oi(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){'function'==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=Xr({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c.__e=!0,e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return oi(e,t,n)}))),e}function si(e,t,n){return e&&n&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return si(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=n)),e}function li(){this.__u=0,this.o=null,this.__b=null}function ci(e){var t=e.__.__c
return t&&t.__a&&t.__a(e)}function ui(e){var t,n,r
function i(i){if(t||(t=e()).then((function(e){n=e.default||e}),(function(e){r=e})),r)throw r
if(!n)throw t
return gn(n,i)}return i.displayName='Lazy',i.__f=!0,i}function di(){this.i=null,this.l=null}function hi(e){return this.getChildContext=function(){return e.context},e.children}function fi(e){var t=this,n=e.h
if(t.componentWillUnmount=function(){zn(null,t.v),t.v=null,t.h=null},t.h&&t.h!==n&&t.componentWillUnmount(),!t.v){for(var r=t.__v;null!==r&&!r.__m&&null!==r.__;)r=r.__
t.h=n,t.v={nodeType:1,parentNode:n,childNodes:[],__k:{__m:r.__m},contains:function(){return!0},insertBefore:function(e,n){this.childNodes.push(e),t.h.insertBefore(e,n)},removeChild:function(e){this.childNodes.splice(this.childNodes.indexOf(e)>>>1,1),t.h.removeChild(e)}}}zn(gn(hi,{context:t.context},e.__v),t.v)}function gi(e,t){var n=gn(fi,{__v:e,h:t})
return n.containerInfo=t,n}function pi(e,t,n){return t.__k??(t.textContent=''),zn(e,t),'function'==typeof n&&n(),e?e.__c:null}function mi(e,t,n){return Nn(e,t),'function'==typeof n&&n(),e?e.__c:null}function vi(){}function yi(){return this.cancelBubble}function _i(){return this.defaultPrevented}function wi(e){return gn.bind(null,e)}function bi(e){return!!e&&e.$$typeof===kr}function Ii(e){return bi(e)&&e.type===vn}function Si(e){return!!e&&!!e.displayName&&('string'==typeof e.displayName||e.displayName instanceof String)&&e.displayName.startsWith('Memo(')}function Ei(e){return bi(e)?On.apply(null,arguments):e}function xi(e){return!!e.__k&&(zn(null,e),!0)}function Ti(e){return e&&(e.base||1===e.nodeType&&e)||null}f(Yr,{Children:()=>xr,Component:()=>yn,Fragment:()=>vn,PureComponent:()=>ri,StrictMode:()=>jr,Suspense:()=>li,SuspenseList:()=>di,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:()=>Vr,cloneElement:()=>Ei,createContext:()=>$n,createElement:()=>gn,createFactory:()=>wi,createPortal:()=>gi,createRef:()=>mn,default:()=>qr,findDOMNode:()=>Ti,flushSync:()=>Hr,forwardRef:()=>ai,hydrate:()=>mi,isElement:()=>Wr,isFragment:()=>Ii,isMemo:()=>Si,isValidElement:()=>bi,lazy:()=>ui,memo:()=>ii,render:()=>pi,startTransition:()=>ei,unmountComponentAtNode:()=>xi,unstable_batchedUpdates:()=>Br,useCallback:()=>ur,useContext:()=>dr,useDebugValue:()=>hr,useDeferredValue:()=>ti,useEffect:()=>ar,useErrorBoundary:()=>fr,useId:()=>gr,useImperativeHandle:()=>lr,useInsertionEffect:()=>br,useLayoutEffect:()=>or,useMemo:()=>cr,useReducer:()=>ir,useRef:()=>sr,useState:()=>rr,useSyncExternalStore:()=>Jr,useTransition:()=>ni,version:()=>Gr})
var Mi,Ci,ki,Ai,Pi,Ui,Di=d({'node_modules/preact/compat/dist/compat.module.js'(){er(),Zr(),Zr(),br=or,(ri.prototype=new yn).isPureReactComponent=!0,ri.prototype.shouldComponentUpdate=function(e,t){return Kr(this.props,e)||Kr(this.state,t)},Ir=qt.__b,qt.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),Ir&&Ir(e)},Sr='undefined'!=typeof Symbol&&Symbol.for&&Symbol.for('react.forward_ref')||3911,xr={map:Er=function(e,t){return null==e?null:xn(xn(e).map(t))},forEach:Er,count:function(e){return e?xn(e).length:0},only:function(e){var t=xn(e)
if(1!==t.length)throw'Children.only'
return t[0]},toArray:xn},Tr=qt.__e,qt.__e=function(e,t,n,r){if(e.then)for(var i,a=t;a=a.__;)if((i=a.__c)&&i.__c)return t.__e??(t.__e=n.__e,t.__k=n.__k),i.__c(e,t)
Tr(e,t,n,r)},Mr=qt.unmount,qt.unmount=function(e){var t=e.__c
t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),Mr&&Mr(e)},(li.prototype=new yn).__c=function(e,t){var n=t.__c,r=this
r.o??(r.o=[]),r.o.push(n)
var i=ci(r.__v),a=!1,o=function(){a||(a=!0,n.__R=null,i?i(s):s())}
n.__R=o
var s=function(){if(! --r.__u){if(r.state.__a){var e=r.state.__a
r.__v.__k[0]=si(e,e.__c.__P,e.__c.__O)}var t
for(r.setState({__a:r.__b=null});t=r.o.pop();)t.forceUpdate()}}
r.__u++||32&t.__u||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},li.prototype.componentWillUnmount=function(){this.o=[]},li.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement('div'),r=this.__v.__k[0].__c
this.__v.__k[0]=oi(this.__b,n,r.__O=r.__P)}this.__b=null}var i=t.__a&&gn(vn,null,e.fallback)
return i&&(i.__u&=-33),[gn(vn,null,t.__a?null:e.children),i]},Cr=function(e,t,n){if(++n[1]===n[0]&&e.l.delete(t),e.props.revealOrder&&('t'!==e.props.revealOrder[0]||!e.l.size))for(n=e.i;n;){for(;n.length>3;)n.pop()()
if(n[0]>n[1])break
e.i=n=n[2]}},(di.prototype=new yn).__a=function(e){var t=this,n=ci(t.__v),r=t.l.get(e)
return r[0]++,function(i){var a=function(){t.props.revealOrder?(r.push(i),Cr(t,e,r)):i()}
n?n(a):a()}},di.prototype.render=function(e){this.i=null,this.l=new Map
var t=xn(e.children)
e.revealOrder&&'b'===e.revealOrder[0]&&t.reverse()
for(var n=t.length;n--;)this.l.set(t[n],this.i=[1,0,this.i])
return e.children},di.prototype.componentDidUpdate=di.prototype.componentDidMount=function(){var e=this
this.l.forEach((function(t,n){Cr(e,n,t)}))},kr='undefined'!=typeof Symbol&&Symbol.for&&Symbol.for('react.element')||60103,Ar=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Pr=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Ur=/[A-Z0-9]/g,Dr='undefined'!=typeof document,Lr=function(e){return('undefined'!=typeof Symbol&&'symbol'==typeof Symbol()?/fil|che|rad/:/fil|che|ra/).test(e)},yn.prototype.isReactComponent={},['componentWillMount','componentWillReceiveProps','componentWillUpdate'].forEach((function(e){Object.defineProperty(yn.prototype,e,{configurable:!0,get:function(){return this['UNSAFE_'+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})})),Rr=qt.event,qt.event=function(e){return Rr&&(e=Rr(e)),e.persist=vi,e.isPropagationStopped=yi,e.isDefaultPrevented=_i,e.nativeEvent=e},Nr={enumerable:!1,configurable:!0,get:function(){return this.class}},Or=qt.vnode,qt.vnode=function(e){'string'==typeof e.type&&function(e){var t=e.props,n=e.type,r={},i=-1===n.indexOf('-')
for(var a in t){var o=t[a]
if(!('value'===a&&'defaultValue'in t&&null==o||Dr&&'children'===a&&'noscript'===n||'class'===a||'className'===a)){var s=a.toLowerCase()
'defaultValue'===a&&'value'in t&&null==t.value?a='value':'download'===a&&!0===o?o='':'translate'===s&&'no'===o?o=!1:'o'===s[0]&&'n'===s[1]?'ondoubleclick'===s?a='ondblclick':'onchange'!==s||'input'!==n&&'textarea'!==n||Lr(t.type)?'onfocus'===s?a='onfocusin':'onblur'===s?a='onfocusout':Pr.test(a)&&(a=s):s=a='oninput':i&&Ar.test(a)?a=a.replace(Ur,'-$&').toLowerCase():null===o&&(o=void 0),'oninput'===s&&r[a=s]&&(a='oninputCapture'),r[a]=o}}'select'==n&&r.multiple&&Array.isArray(r.value)&&(r.value=xn(t.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),'select'==n&&null!=r.defaultValue&&(r.value=xn(t.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),t.class&&!t.className?(r.class=t.class,Object.defineProperty(r,'className',Nr)):(t.className&&!t.class||t.class&&t.className)&&(r.class=r.className=t.className),e.props=r}(e),e.$$typeof=kr,Or&&Or(e)},$r=qt.__r,qt.__r=function(e){$r&&$r(e),zr=e.__c},Fr=qt.diffed,qt.diffed=function(e){Fr&&Fr(e)
var t=e.props,n=e.__e
null!=n&&'textarea'===e.type&&'value'in t&&t.value!==n.value&&(n.value=null==t.value?'':t.value),zr=null},Gr='18.3.1',qr={useState:rr,useId:gr,useReducer:ir,useEffect:ar,useLayoutEffect:or,useInsertionEffect:br,useTransition:ni,useDeferredValue:ti,useSyncExternalStore:Jr,startTransition:ei,useRef:sr,useImperativeHandle:lr,useMemo:cr,useCallback:ur,useContext:dr,useDebugValue:hr,version:'18.3.1',Children:xr,render:pi,hydrate:mi,unmountComponentAtNode:xi,createPortal:gi,createElement:gn,createContext:$n,createFactory:wi,cloneElement:Ei,createRef:mn,Fragment:vn,isValidElement:bi,isElement:Wr=bi,isFragment:Ii,isMemo:Si,findDOMNode:Ti,Component:yn,PureComponent:ri,memo:ii,forwardRef:ai,flushSync:Hr=function(e,t){return e(t)},unstable_batchedUpdates:Br=function(e,t){return e(t)},StrictMode:jr=vn,Suspense:li,SuspenseList:di,lazy:ui,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Vr={ReactCurrentDispatcher:{current:{readContext:function(e){return zr.__n[e.__c].props.value},useCallback:ur,useContext:dr,useDebugValue:hr,useDeferredValue:ti,useEffect:ar,useId:gr,useImperativeHandle:lr,useInsertionEffect:br,useLayoutEffect:or,useMemo:cr,useReducer:ir,useRef:sr,useState:rr,useSyncExternalStore:Jr,useTransition:ni}}}}}})
function Li(){if(Ai>1)Ai--
else{for(var e,t=!1;void 0!==ki;){var n=ki
for(ki=void 0,Pi++;void 0!==n;){var r=n.o
if(n.o=void 0,n.f&=-3,!(8&n.f)&&Fi(n))try{n.c()}catch(i){t||(e=i,t=!0)}n=r}}if(Pi=0,Ai--,t)throw e}}function Ri(e){if(Ai>0)return e()
Ai++
try{return e()}finally{Li()}}function zi(e){var t=Ci
Ci=void 0
try{return e()}finally{Ci=t}}function Ni(e){if(void 0!==Ci){var t=e.n
if(void 0===t||t.t!==Ci)return t={i:0,S:e,p:Ci.s,n:void 0,t:Ci,e:void 0,x:void 0,r:t},void 0!==Ci.s&&(Ci.s.n=t),Ci.s=t,e.n=t,32&Ci.f&&e.S(t),t
if(-1===t.i)return t.i=0,void 0!==t.n&&(t.n.p=t.p,void 0!==t.p&&(t.p.n=t.n),t.p=Ci.s,t.n=void 0,Ci.s.n=t,Ci.s=t),t}}function Oi(e,t){this.v=e,this.i=0,this.n=void 0,this.t=void 0,this.W=null==t?void 0:t.watched,this.Z=null==t?void 0:t.unwatched}function $i(e,t){return new Oi(e,t)}function Fi(e){for(var t=e.s;void 0!==t;t=t.n)if(t.S.i!==t.i||!t.S.h()||t.S.i!==t.i)return!0
return!1}function Vi(e){for(var t=e.s;void 0!==t;t=t.n){var n=t.S.n
if(void 0!==n&&(t.r=n),t.S.n=t,t.i=-1,void 0===t.n){e.s=t
break}}}function Gi(e){for(var t=e.s,n=void 0;void 0!==t;){var r=t.p;-1===t.i?(t.S.U(t),void 0!==r&&(r.n=t.n),void 0!==t.n&&(t.n.p=r)):n=t,t.S.n=t.r,void 0!==t.r&&(t.r=void 0),t=r}e.s=n}function Bi(e,t){Oi.call(this,void 0),this.x=e,this.s=void 0,this.g=Ui-1,this.f=4,this.W=null==t?void 0:t.watched,this.Z=null==t?void 0:t.unwatched}function Hi(e,t){return new Bi(e,t)}function ji(e){var t=e.u
if(e.u=void 0,'function'==typeof t){Ai++
var n=Ci
Ci=void 0
try{t()}catch(r){throw e.f&=-2,e.f|=8,Wi(e),r}finally{Ci=n,Li()}}}function Wi(e){for(var t=e.s;void 0!==t;t=t.n)t.S.U(t)
e.x=void 0,e.s=void 0,ji(e)}function qi(e){if(Ci!==this)throw Error('Out-of-order effect')
Gi(this),Ci=e,this.f&=-2,8&this.f&&Wi(this),Li()}function Zi(e){this.x=e,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}function Yi(e){var t=new Zi(e)
try{t.c()}catch(n){throw t.d(),n}return t.d.bind(t)}var Xi,Ki,Ji,Qi,ea,ta,na,ra=d({'node_modules/@preact/signals-core/dist/signals-core.module.js'(){Mi=Symbol.for('preact-signals'),Ci=void 0,ki=void 0,Ai=0,Pi=0,Ui=0,Oi.prototype.brand=Mi,Oi.prototype.h=function(){return!0},Oi.prototype.S=function(e){var t=this,n=this.t
n!==e&&void 0===e.e&&(e.x=n,this.t=e,void 0!==n?n.e=e:zi((function(){var e
null==(e=t.W)||e.call(t)})))},Oi.prototype.U=function(e){var t=this
if(void 0!==this.t){var n=e.e,r=e.x
void 0!==n&&(n.x=r,e.e=void 0),void 0!==r&&(r.e=n,e.x=void 0),e===this.t&&(this.t=r,void 0===r&&zi((function(){var e
null==(e=t.Z)||e.call(t)})))}},Oi.prototype.subscribe=function(e){var t=this
return Yi((function(){var n=t.value,r=Ci
Ci=void 0
try{e(n)}finally{Ci=r}}))},Oi.prototype.valueOf=function(){return this.value},Oi.prototype.toString=function(){return this.value+''},Oi.prototype.toJSON=function(){return this.value},Oi.prototype.peek=function(){var e=Ci
Ci=void 0
try{return this.value}finally{Ci=e}},Object.defineProperty(Oi.prototype,'value',{get:function(){var e=Ni(this)
return void 0!==e&&(e.i=this.i),this.v},set:function(e){if(e!==this.v){if(Pi>100)throw Error('Cycle detected')
this.v=e,this.i++,Ui++,Ai++
try{for(var t=this.t;void 0!==t;t=t.x)t.t.N()}finally{Li()}}}}),(Bi.prototype=new Oi).h=function(){if(this.f&=-3,1&this.f)return!1
if(32==(36&this.f))return!0
if(this.f&=-5,this.g===Ui)return!0
if(this.g=Ui,this.f|=1,this.i>0&&!Fi(this))return this.f&=-2,!0
var e=Ci
try{Vi(this),Ci=this
var t=this.x();(16&this.f||this.v!==t||0===this.i)&&(this.v=t,this.f&=-17,this.i++)}catch(n){this.v=n,this.f|=16,this.i++}return Ci=e,Gi(this),this.f&=-2,!0},Bi.prototype.S=function(e){if(void 0===this.t){this.f|=36
for(var t=this.s;void 0!==t;t=t.n)t.S.S(t)}Oi.prototype.S.call(this,e)},Bi.prototype.U=function(e){if(void 0!==this.t&&(Oi.prototype.U.call(this,e),void 0===this.t)){this.f&=-33
for(var t=this.s;void 0!==t;t=t.n)t.S.U(t)}},Bi.prototype.N=function(){if(!(2&this.f)){this.f|=6
for(var e=this.t;void 0!==e;e=e.x)e.t.N()}},Object.defineProperty(Bi.prototype,'value',{get:function(){if(1&this.f)throw Error('Cycle detected')
var e=Ni(this)
if(this.h(),void 0!==e&&(e.i=this.i),16&this.f)throw this.v
return this.v}}),Zi.prototype.c=function(){var e=this.S()
try{if(8&this.f)return
if(void 0===this.x)return
var t=this.x()
'function'==typeof t&&(this.u=t)}finally{e()}},Zi.prototype.S=function(){if(1&this.f)throw Error('Cycle detected')
this.f|=1,this.f&=-9,ji(this),Vi(this),Ai++
var e=Ci
return Ci=this,qi.bind(this,e)},Zi.prototype.N=function(){2&this.f||(this.f|=2,this.o=ki,ki=this)},Zi.prototype.d=function(){this.f|=8,1&this.f||Wi(this)}}}),ia={}
function aa(e,t){qt[e]=t.bind(null,qt[e]||function(){})}function oa(e){Ji&&Ji(),Ji=e&&e.S()}function sa(e){var t=this,n=e.data,r=ca(n)
r.value=n
var i=cr((function(){for(var e=t,n=t.__v;n=n.__;)if(n.__c){n.__c.__$f|=4
break}var i=Hi((function(){var e=r.value.value
return 0===e?0:!0===e?'':e||''})),a=Hi((function(){return!Array.isArray(i.value)&&!Yt(i.value)})),o=Yi((function(){this.N=ga,a.value&&e.__v&&e.__v.__e&&3===e.__v.__e.nodeType&&(e.__v.__e.data=i.value)})),s=t.__$u.d
return t.__$u.d=function(){o(),s.call(this)},[a,i]}),[]),a=i[1]
return i[0].value?a.peek():a.value}function la(e,t,n,r){var i=t in e&&void 0===e.ownerSVGElement,a=$i(n)
return{o:function(e,t){a.value=e,r=t},d:Yi((function(){this.N=ga
var n=a.value.value
r[t]!==n&&(r[t]=n,i?e[t]=n:n?e.setAttribute(t,n):e.removeAttribute(t))}))}}function ca(e,t){return cr((function(){return $i(e,t)}),[])}function ua(e,t){var n=sr(e)
return n.current=e,Ki.__$f|=4,cr((function(){return Hi((function(){return n.current()}),t)}),[])}function da(){Ri((function(){for(var e;e=Qi.shift();)Xi.call(e)}))}function ha(){1===Qi.push(this)&&(qt.requestAnimationFrame||ta)(da)}function fa(){Ri((function(){for(var e;e=ea.shift();)Xi.call(e)}))}function ga(){1===ea.push(this)&&(qt.requestAnimationFrame||na)(fa)}function pa(e){var t=sr(e)
t.current=e,ar((function(){return Yi((function(){return this.N=ha,t.current()}))}),[])}f(ia,{Signal:()=>Oi,batch:()=>Ri,computed:()=>Hi,effect:()=>Yi,signal:()=>$i,untracked:()=>zi,useComputed:()=>ua,useSignal:()=>ca,useSignalEffect:()=>pa})
var ma,va,ya,_a=d({'node_modules/@preact/signals/dist/signals.module.js'(){er(),Zr(),ra(),Qi=[],ea=[],Yi((function(){Xi=this.N}))(),sa.displayName='_st',Object.defineProperties(Oi.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:sa},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}}),aa('__b',(function(e,t){if('string'==typeof t.type){var n,r=t.props
for(var i in r)if('children'!==i){var a=r[i]
a instanceof Oi&&(n||(t.__np=n={}),n[i]=a,r[i]=a.peek())}}e(t)})),aa('__r',(function(e,t){if(t.type!==vn){oa()
var n,r=t.__c
r&&(r.__$f&=-2,void 0===(n=r.__$u)&&(r.__$u=(Yi((function(){i=this})),i.c=function(){r.__$f|=1,r.setState({})},n=i))),Ki=r,oa(n)}var i
e(t)})),aa('__e',(function(e,t,n,r){oa(),Ki=void 0,e(t,n,r)})),aa('diffed',(function(e,t){var n
if(oa(),Ki=void 0,'string'==typeof t.type&&(n=t.__e)){var r=t.__np,i=t.props
if(r){var a=n.U
if(a)for(var o in a){var s=a[o]
void 0===s||o in r||(s.d(),a[o]=void 0)}else n.U=a={}
for(var l in r){var c=a[l],u=r[l]
void 0===c?(c=la(n,l,u,i),a[l]=c):c.o(u,i)}}}e(t)})),aa('unmount',(function(e,t){if('string'==typeof t.type){var n=t.__e
if(n){var r=n.U
if(r)for(var i in n.U=void 0,r){var a=r[i]
a&&a.d()}}}else{var o=t.__c
if(o){var s=o.__$u
s&&(o.__$u=void 0,s.d())}}e(t)})),aa('__h',(function(e,t,n,r){(3>r||9===r)&&(t.__$f|=2),e(t,n,r)})),yn.prototype.shouldComponentUpdate=function(e,t){var n=this.__$u,r=n&&void 0!==n.s
for(var i in t)return!0
if(this.__f||'boolean'==typeof this.u&&!0===this.u){if(!(r||2&this.__$f||4&this.__$f))return!0
if(1&this.__$f)return!0}else{if(!(r||4&this.__$f))return!0
if(3&this.__$f)return!0}for(var a in e)if('__source'!==a&&e[a]!==this.props[a])return!0
for(var o in this.props)if(!(o in e))return!0
return!1},ta='undefined'==typeof requestAnimationFrame?setTimeout:function(e){var t=function(){clearTimeout(n),cancelAnimationFrame(r),e()},n=setTimeout(t,35),r=requestAnimationFrame(t)},na=function(e){queueMicrotask((function(){queueMicrotask(e)}))}}})
function wa(){return{downloadBlob(e,t){try{const n=URL.createObjectURL(e),r=document.createElement('a')
r.href=n,r.download=t,r.style.display='none',document.body.appendChild(r),r.click(),document.body.removeChild(r),setTimeout((()=>URL.revokeObjectURL(n)),y)}catch(n){throw a.error('Native download failed:',n),n}},createDownloadUrl:e=>URL.createObjectURL(e),revokeDownloadUrl(e){URL.revokeObjectURL(e)}}}function ba(){if(ma)return ma
try{const e=(er(),g(dn))
return ma={h:e.h,render:e.render,Component:e.Component,Fragment:e.Fragment,createContext:e.createContext,cloneElement:e.cloneElement,createRef:e.createRef,isValidElement:e.isValidElement,options:e.options,createElement:e.h}}catch{const e='undefined'!=typeof window?window:void 0
if(e?.preact){const t=e.preact
return ma={h:t.h,render:t.render,Component:t.Component,Fragment:t.Fragment,createContext:t.createContext,cloneElement:t.cloneElement,createRef:t.createRef,isValidElement:t.isValidElement,options:t.options,createElement:t.h}}}throw Error('Preact is not available')}function Ia(){if(va)return va
try{const e=(Zr(),g(tr)),t=(Di(),g(Yr)),n={useState:e.useState,useEffect:e.useEffect,useRef:e.useRef,useCallback:e.useCallback,useMemo:e.useMemo,useReducer:e.useReducer,useContext:e.useContext,useLayoutEffect:e.useLayoutEffect,useImperativeHandle:e.useImperativeHandle,useDebugValue:e.useDebugValue,forwardRef:t.forwardRef}
return va=n,n}catch{const e='undefined'!=typeof window?window:void 0
if(e?.preactHooks){const t=e.preactHooks
return va=t,t}}throw Error('Preact hooks are not available')}function Sa(){if(ya)return ya
try{const e=(_a(),g(ia)),t={signal:e.signal,computed:e.computed,effect:e.effect,batch:e.batch,useSignal:e.useSignal,useComputed:e.useComputed,useSignalEffect:e.useSignalEffect}
return ya=t,t}catch{const e='undefined'!=typeof window?window:void 0
if(e?.preactSignals){const t=e.preactSignals
return ya=t,t}}throw Error('Preact signals are not available')}var Ea,xa=d({'src/shared/utils/external/vendors/index.ts'(){p(),It(),St(),ma=null,va=null,ya=null}})
async function Ta(e,t){const n=e.originalUrl??e.url,r=await fetch(n,{method:'GET',headers:{'User-Agent':'Mozilla/5.0 (compatible; XEG/1.0)'},signal:AbortSignal.timeout(t.requestTimeout)})
if(!r.ok)throw Error(`HTTP ${r.status}: ${r.statusText}`)
const i=r.headers.get('content-length'),a=i?.trim()
if(null!=a&&''!==a){const e=parseInt(a,10)
if(!isNaN(e)&&e>t.maxFileSize)throw Error(`File too large: ${e} bytes`)}const o=await r.arrayBuffer()
return new Uint8Array(o)}function Ma(e,t){if(!t.has(e))return e
const n=e.lastIndexOf('.'),r=n>0?e.substring(0,n):e,i=n>0?e.substring(n):''
let a,o=1
do{a=`${r}_${o}${i}`,o++}while(t.has(a))
return a}var Ca,ka=d({'src/shared/utils/external/zip/zip-creator.ts'(){It(),Pa(),Ea={compressionLevel:0,maxFileSize:104857600,requestTimeout:3e4,maxConcurrent:4}}}),Aa=d({'src/shared/utils/external/zip/index.ts'(){ka()}}),Pa=d({'src/shared/utils/external/index.ts'(){xa(),Aa()}}),Ua={}
f(Ua,{VideoControlUtil:()=>Ca})
var Da,La=d({'src/shared/utils/media/video-control.util.ts'(){var e
It(),e=class e{constructor(){o.defineProperty(this,'pausedVideos',new Map),o.defineProperty(this,'mutationObserver',null)}static getInstance(){return this.instance??(this.instance=new e)}pauseAllVideos(){const e=document.querySelectorAll('video')
a.debug(`VideoControlUtil: ${e.length}\uac1c \ub3d9\uc601\uc0c1 \uc77c\uc2dc\uc815\uc9c0 \uc2dc\uc791`),e.forEach((e=>{e.paused||(this.pausedVideos.set(e,{element:e,wasPlaying:!0,currentTime:e.currentTime}),e.pause(),a.debug('VideoControlUtil: \ub3d9\uc601\uc0c1 \uc77c\uc2dc\uc815\uc9c0\ub428',{src:e.src,currentTime:e.currentTime}))})),a.info(`VideoControlUtil: ${this.pausedVideos.size}\uac1c \ub3d9\uc601\uc0c1 \uc77c\uc2dc\uc815\uc9c0 \uc644\ub8cc`)}resumePausedVideos(){a.debug(`VideoControlUtil: ${this.pausedVideos.size}\uac1c \ub3d9\uc601\uc0c1 \uc7ac\uc0dd \ubcf5\uc6d0 \uc2dc\uc791`),this.pausedVideos.forEach(((e,t)=>{if(e.wasPlaying&&document.contains(t))try{t.currentTime=e.currentTime,t.play().catch((e=>{a.warn('VideoControlUtil: \ub3d9\uc601\uc0c1 \uc7ac\uc0dd \ubcf5\uc6d0 \uc2e4\ud328:',e)})),a.debug('VideoControlUtil: \ub3d9\uc601\uc0c1 \uc7ac\uc0dd \ubcf5\uc6d0\ub428',{src:t.src,currentTime:t.currentTime})}catch(n){a.warn('VideoControlUtil: \ub3d9\uc601\uc0c1 \ubcf5\uc6d0 \uc911 \uc624\ub958:',n)}})),this.pausedVideos.clear(),a.info('VideoControlUtil: \ub3d9\uc601\uc0c1 \uc7ac\uc0dd \ubcf5\uc6d0 \uc644\ub8cc')}pauseVideosInContainer(e){const t=e.querySelectorAll('video'),n=[]
return t.forEach((e=>{e.paused||(this.pausedVideos.set(e,{element:e,wasPlaying:!0,currentTime:e.currentTime}),e.pause(),n.push(e))})),a.debug(`VideoControlUtil: \ucee8\ud14c\uc774\ub108 \ub0b4 ${n.length}\uac1c \ub3d9\uc601\uc0c1 \uc77c\uc2dc\uc815\uc9c0`),n}startVideoMutationObserver(e){this.mutationObserver||(this.mutationObserver=new MutationObserver((t=>{let n=!1
t.forEach((e=>{if('childList'===e.type){const t=Array.from(e.addedNodes).filter((e=>e.nodeType===Node.ELEMENT_NODE&&'VIDEO'===e.tagName)),r=Array.from(e.removedNodes).filter((e=>e.nodeType===Node.ELEMENT_NODE&&'VIDEO'===e.tagName));(t.length>0||r.length>0)&&(n=!0,a.debug('VideoControlUtil: \ub3d9\uc601\uc0c1 DOM \ubcc0\ud654 \uac10\uc9c0',{added:t.length,removed:r.length}))}'attributes'===e.type&&'VIDEO'===e.target.tagName&&(n=!0,a.debug('VideoControlUtil: \ub3d9\uc601\uc0c1 \uc18d\uc131 \ubcc0\ud654 \uac10\uc9c0'))})),n&&e&&e(t)})),this.mutationObserver.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:['src','poster','controls']}),a.info('VideoControlUtil: \ub3d9\uc601\uc0c1 \ubcc0\ud654 \uac10\uc9c0 \uc2dc\uc791'))}stopVideoMutationObserver(){this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=null,a.info('VideoControlUtil: \ub3d9\uc601\uc0c1 \ubcc0\ud654 \uac10\uc9c0 \uc911\uc9c0'))}extractMediaFromVideoElement(e){try{const t=e.src||e.currentSrc
return t?{url:t,thumbnailUrl:e.poster||void 0,type:'video'}:null}catch(t){return a.error('VideoControlUtil: \ub3d9\uc601\uc0c1 \uc694\uc18c\uc5d0\uc11c \ubbf8\ub514\uc5b4 \ucd94\ucd9c \uc2e4\ud328:',t),null}}cleanup(){this.stopVideoMutationObserver(),this.resumePausedVideos(),a.info('VideoControlUtil: \uc815\ub9ac \uc644\ub8cc')}},o.defineProperty(e,'instance',void 0),Ca=e}}),Ra={}
f(Ra,{VideoStateManager:()=>Da})
var za,Na=d({'src/shared/utils/media/video-state-manager.ts'(){var e
It(),e=class e{constructor(){o.defineProperty(this,'mediaCache',new Map),o.defineProperty(this,'galleryTriggers',new Map),o.defineProperty(this,'mutationObserver',null),o.defineProperty(this,'isObserving',!1)}static getInstance(){return e.instance??(e.instance=new e),e.instance}get isObservingDOM(){return this.isObserving}cacheMediaForTweet(e,t,n){const r=this.generateContainerSelector(t),i=Array.from(t.querySelectorAll('img')).filter((e=>e.src.includes('pbs.twimg.com'))).map((e=>({element:e,src:e.src,position:e.getBoundingClientRect()}))),o={tweetId:e,containerSelector:r,mediaItems:n,extractedAt:Date.now(),originalThumbnails:i}
this.mediaCache.set(e,o),a.debug('VideoStateManager: \ubbf8\ub514\uc5b4 \uce90\uc2dc \uc800\uc7a5\ub428',{tweetId:e,mediaCount:n.length,thumbnailCount:i.length})}getCachedMedia(e){const t=this.mediaCache.get(e)
return t&&Date.now()-t.extractedAt>6e5?(this.mediaCache.delete(e),null):t??null}createGalleryTrigger(e,t,n){const r=this.getCachedMedia(t)
if(!r)return a.warn('VideoStateManager: \uce90\uc2dc\ub41c \ubbf8\ub514\uc5b4\uac00 \uc5c6\uc5b4 \ud2b8\ub9ac\uac70 \uc0dd\uc131 \ubd88\uac00'),void 0
this.removeGalleryTrigger(t)
const i=document.createElement('div')
i.className='xeg-gallery-trigger newly-created',i.setAttribute('data-tweet-id',t),i.setAttribute('role','button'),i.setAttribute('tabindex','0'),i.setAttribute('aria-label','\uac24\ub7ec\ub9ac \uc5f4\uae30'),i.innerHTML='\n      <svg width="16" height="16" viewBox="0 0 24 24" fill="white">\n        <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>\n      </svg>\n    '
const o=e=>{e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),a.info('VideoStateManager: \uac24\ub7ec\ub9ac \ud2b8\ub9ac\uac70 \ud65c\uc131\ud654\ub428',{tweetId:t}),n(r.mediaItems,0)}
i.addEventListener('click',o),i.addEventListener('keydown',(e=>{'Enter'!==e.key&&' '!==e.key||o(e)})),setTimeout((()=>{i.classList.remove('newly-created')}),3e3),e.appendChild(i),this.galleryTriggers.set(t,{element:i,tweetId:t,mediaCache:r}),a.debug('VideoStateManager: \uac24\ub7ec\ub9ac \ud2b8\ub9ac\uac70 \uc0dd\uc131\ub428',{tweetId:t})}removeGalleryTrigger(e){const t=this.galleryTriggers.get(e)
t?.element.parentNode&&(t.element.remove(),this.galleryTriggers.delete(e),a.debug('VideoStateManager: \uac24\ub7ec\ub9ac \ud2b8\ub9ac\uac70 \uc81c\uac70\ub428',{tweetId:e}))}startDOMObserver(e){this.isObserving||(this.mutationObserver=new MutationObserver((t=>{t.forEach((t=>{'childList'===t.type&&(t.addedNodes.forEach((t=>{t.nodeType===Node.ELEMENT_NODE&&('VIDEO'===t.tagName?[t]:Array.from(t.querySelectorAll('video'))).forEach((t=>{this.handleVideoElementAdded(t,e)}))})),t.removedNodes.forEach((e=>{if(e.nodeType===Node.ELEMENT_NODE){const t=e
'IMG'===t.tagName&&t.src.includes('pbs.twimg.com')&&this.handleThumbnailRemoved(t)}})))}))})),this.mutationObserver.observe(document.body,{childList:!0,subtree:!0}),this.isObserving=!0,a.info('VideoStateManager: DOM \ubcc0\ud654 \uac10\uc9c0 \uc2dc\uc791'))}stopDOMObserver(){this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=null,this.isObserving=!1,a.info('VideoStateManager: DOM \ubcc0\ud654 \uac10\uc9c0 \uc911\uc9c0'))}handleVideoElementAdded(e,t){const n=e.closest('[data-testid="tweet"]')
if(!n)return
const r=this.extractTweetId(n)
r&&(e.addEventListener('play',(()=>{a.debug('VideoStateManager: \ub3d9\uc601\uc0c1 \uc7ac\uc0dd \uc2dc\uc791 \uac10\uc9c0',{tweetId:r}),t(r,e)})),e.addEventListener('pause',(()=>{a.debug('VideoStateManager: \ub3d9\uc601\uc0c1 \uc77c\uc2dc\uc815\uc9c0 \uac10\uc9c0',{tweetId:r})})))}handleThumbnailRemoved(e){const t=e.closest('[data-testid="tweet"]')
if(!t)return
const n=this.extractTweetId(t)
if(!n)return
a.debug('VideoStateManager: \uc378\ub124\uc77c \uc81c\uac70 \uac10\uc9c0, \ud2b8\ub9ac\uac70 \uc0dd\uc131 \uac80\ud1a0',{tweetId:n})
const r=this.getCachedMedia(n),i=this.galleryTriggers.get(n)
r&&!i&&setTimeout((()=>{this.createGalleryTrigger(t,n,((e,t)=>{const r=new CustomEvent('xeg-gallery-trigger',{detail:{mediaItems:e,clickedIndex:t,tweetId:n}})
document.dispatchEvent(r)}))}),100)}extractTweetId(e){const t=e.querySelectorAll('a[href*="/status/"]')
for(const n of t){const e=n.href.match(/\/status\/(\d+)/)
if(e?.[1])return e[1]}return null}generateContainerSelector(e){const t=e.getAttribute('data-testid')
if(t)return`[data-testid="${t}"]`
const n=e.className
return n?'.'+n.split(' ')[0]:e.tagName.toLowerCase()}clearAllCache(){this.mediaCache.clear(),a.debug('VideoStateManager: \ubaa8\ub4e0 \ubbf8\ub514\uc5b4 \uce90\uc2dc \uc815\ub9ac\ub428')}cleanup(){this.stopDOMObserver(),this.galleryTriggers.forEach((e=>{e.element.parentNode&&e.element.remove()})),this.galleryTriggers.clear(),this.mediaCache.clear(),a.info('VideoStateManager: \uc815\ub9ac \uc644\ub8cc')}},o.defineProperty(e,'instance',void 0),Da=e}}),Oa={}
function $a(e,t){return za.getInstance().generateMediaFilename(e,t)}function Fa(e,t){return za.getInstance().generateZipFilename(e,t)}function Va(e){return za.getInstance().isValidMediaFilename(e)}function Ga(e){return za.getInstance().isValidZipFilename(e)}f(Oa,{MediaFilenameService:()=>za,generateMediaFilename:()=>$a,generateZipFilename:()=>Fa,isValidMediaFilename:()=>Va,isValidZipFilename:()=>Ga})
var Ba,Ha=d({'src/shared/utils/media/FilenameService.ts'(){var e
It(),e=class e{static getInstance(){return e.instance??(e.instance=new e),e.instance}constructor(){}generateMediaFilename(e,t={}){try{if(e.filename&&this.isValidMediaFilename(e.filename))return e.filename
if(e.tweetUsername&&e.tweetId){const n=t.extension??this.extractExtensionFromUrl(e.url),r=this.extractIndexFromMediaId(e.id)??this.normalizeIndex(t.index)
return`${e.tweetUsername}_${e.tweetId}_${r}.${n}`}return this.generateFallbackFilename(e,t)}catch(n){return a.warn('Failed to generate media filename:',n),this.generateFallbackFilename(e,t)}}generateZipFilename(e,t={}){try{const n=e[0]
return n?.tweetUsername&&n?.tweetId?`${n.tweetUsername}_${n.tweetId}.zip`:`${t.fallbackPrefix??'xcom_gallery'}_${Date.now()}.zip`}catch(n){return a.warn('Failed to generate ZIP filename:',n),`download_${Date.now()}.zip`}}isValidMediaFilename(e){return/^[^_\s]+_\d+_\d+\.\w+$/.test(e)}isValidZipFilename(e){return/^[^_]+_\d+\.zip$/.test(e)}extractIndexFromMediaId(e){if(!e)return null
try{const t=e.match(/_media_(\d+)$/)
if(t)return''+(parseInt(t[1],10)+1)
const n=e.match(/_(\d+)$/)
if(n)return n[1]}catch(t){a.debug('Failed to extract index from media ID:',e,t)}return null}extractExtensionFromUrl(e){try{const t=new URL(e).pathname,n=t.lastIndexOf('.')
if(n>0){const e=t.substring(n+1)
if(/^(jpg|jpeg|png|gif|webp|mp4|mov|avi)$/i.test(e))return e.toLowerCase()}}catch{a.debug('Failed to extract extension from URL:',e)}return'jpg'}extractIndexFromUrl(e){try{const t=new URL(e).pathname.match(/(\d+)(?=\.\w+$)/)
return t?.[1]??'1'}catch{return a.debug('Failed to extract index from URL:',e),'1'}}normalizeIndex(e){if(null==e)return'1'
const t='string'==typeof e?parseInt(e,10):e
return isNaN(t)?'1':1>t?''+Math.max(t+1,1):''+t}generateFallbackFilename(e,t={}){const n=t.fallbackPrefix??'media',r=t.extension??this.extractExtensionFromUrl(e.url)
return`${n}_${Date.now()}_${this.normalizeIndex(t.index)}.${r}`}},o.defineProperty(e,'instance',void 0),za=e}}),ja=d({'src/shared/utils/media/index.ts'(){La(),Na(),Ha()}}),Wa={}
f(Wa,{BulkDownloadService:()=>Ba})
var qa,Za,Ya,Xa,Ka,Ja,Qa=d({'src/core/services/BulkDownloadService.ts'(){var e
It(),Pa(),Aa(),ja(),e=class e{static getInstance(){return e.instance??(e.instance=new e),e.instance}constructor(){o.defineProperty(this,'_isInitialized',!1),o.defineProperty(this,'currentAbortController',void 0),o.defineProperty(this,'downloadInfo',{isDownloading:!1,progress:0,failedFiles:[]})}async initialize(){this._isInitialized||(a.info('BulkDownloadService initializing...'),this._isInitialized=!0,a.info('BulkDownloadService initialized'))}destroy(){this._isInitialized&&(a.info('BulkDownloadService destroying...'),this._isInitialized=!1,a.info('BulkDownloadService destroyed'))}isInitialized(){return this._isInitialized}getStatus(){return this._isInitialized?'active':'inactive'}async downloadSingle(e){try{return await this.downloadSingleWithIndex(e)?{success:!0,filename:$a(e)}:{success:!1,error:'Download failed'}}catch(t){return{success:!1,error:t instanceof Error?t.message:'Unknown error'}}}async downloadBulk(e,t={}){return this.downloadMultiple(e,t)}cancelDownload(){this.currentAbortController&&(this.currentAbortController.abort(),this.currentAbortController=void 0),this.downloadInfo.isDownloading=!1,a.info('Download cancelled')}getCurrentDownloadInfo(){return{...this.downloadInfo}}async downloadSingleWithIndex(e,t){try{const n=wa(),r=this.extractSafeUrl(e),i=$a(e,t?{index:t}:void 0)
a.info('Starting single media download:',{url:r,filename:i})
const o=await fetch(r)
if(a.info('Fetch response:',{ok:o.ok,status:o.status,statusText:o.statusText}),!o.ok)throw Error(`HTTP ${o.status}: ${o.statusText}`)
const s=await o.blob()
return a.info('Blob created:',{size:s.size,type:s.type}),n.downloadBlob(s,i),a.info('downloadBlob called successfully'),a.info('Single media download completed:',i),!0}catch(n){return a.info('Download failed with error:',n),a.error('Single media download failed:',n),!1}}async downloadMultiple(e,t={}){try{if(0===e.length)return{success:!1,filesProcessed:0,filesSuccessful:0,error:'No media items provided'}
switch(t.strategy??this.determineOptimalStrategy(e)){case'zip':return await this.downloadAsZip(e,t)
case'individual':return await this.downloadIndividually(e,t)
default:return e.length>1?await this.downloadAsZip(e,t):await this.downloadIndividually(e,t)}}catch(n){return a.error('Multiple media download failed:',n),{success:!1,filesProcessed:e.length,filesSuccessful:0,error:n instanceof Error?n.message:'Unknown error occurred'}}}async downloadAsZip(n,r={}){const{onProgress:i,zipFilename:o}=r
try{a.info(`Starting ZIP download for ${n.length} items`)
const r=e=>{i?.({phase:.7>e?'downloading':'zipping',current:Math.floor(e*n.length),total:n.length,percentage:Math.round(100*e)})},s=n.map(((e,t)=>({url:this.extractSafeUrl(e),originalUrl:this.extractSafeUrl(e),filename:$a(e,{index:t+1})}))),l=o??Fa(n)
i?.({phase:'preparing',current:0,total:n.length,percentage:0})
const c=await async function(e,n,r,i={}){const o={...Ea,...i}
try{a.time('[ZipCreator] createZipFromItems'),a.info(`[ZipCreator] Creating ZIP with ${e.length} items`)
const n=await async function(e,t,n=Ea){const r=new Map,i=e.length
let o=0
const s=function(e,t){const n=[]
for(let r=0;e.length>r;r+=t)n.push(e.slice(r,r+t))
return n}(e,n.maxConcurrent)
for(const l of s){const e=l.map((async e=>{try{const s=await Ta(e,n),l=Ma(e.filename??'media.jpg',r)
r.set(l,s),o++,t&&t(o/i),a.debug('[ZipCreator] Downloaded for ZIP: '+l)}catch(s){a.warn(`[ZipCreator] Failed to download ${e.filename}:`,s instanceof Error?s.message:s+'')}}))
await Promise.all(e)}return r}(e,r,o),i=await async function(e,n,r){const i=await async function(){try{const e=await t((()=>Promise.resolve().then((()=>(un(),Et)))),void 0)
return{zipSync:e.zipSync,zip:e.zip}}catch(e){return a.warn('Failed to load fflate library:',e),null}}()
if(!i)throw Error('fflate library not available')
return new Promise(((t,n)=>{try{const o={}
for(const[t,n]of e)o[t]=[n,{level:r.compressionLevel}]
const s={}
for(const[e,[t]]of Object.entries(o))s[e]=t
i.zip(s,{level:6},((e,r)=>{if(e)return a.error('[ZipCreator] fflate.zip failed:',e.message),n(Error('ZIP creation failed: '+e.message)),void 0
if(!r||0===r.byteLength)return n(Error('No valid data returned from fflate.zip')),void 0
try{const e=new Blob([r],{type:'application/zip'})
a.info(`[ZipCreator] fflate ZIP created: ${e.size} bytes`),t(e)}catch(i){a.error('[ZipCreator] Failed to create blob:',i instanceof Error?i.message:i+''),n(Error('Failed to create ZIP blob: '+(i instanceof Error?i.message:i+'')))}}))}catch(o){a.error('[ZipCreator] ZIP creation error:',o instanceof Error?o.message:o+''),n(Error('ZIP creation failed: '+(o instanceof Error?o.message:o+'')))}}))}(n,0,o)
return a.info(`[ZipCreator] ZIP created successfully: ${i.size} bytes`),i}catch(s){throw a.error('[ZipCreator] ZIP creation failed:',s instanceof Error?s.message:s+''),Error('Failed to create ZIP: '+(s instanceof Error?s.message:s+''))}finally{a.timeEnd('[ZipCreator] createZipFromItems')}}(s,0,r,{compressionLevel:e.CONFIG.ZIP_COMPRESSION_LEVEL,maxFileSize:1048576*e.CONFIG.MAX_FILE_SIZE_MB,requestTimeout:e.CONFIG.REQUEST_TIMEOUT_MS,maxConcurrent:e.CONFIG.DEFAULT_CONCURRENT_DOWNLOADS})
return wa().downloadBlob(c,l),i?.({phase:'complete',current:n.length,total:n.length,percentage:100}),a.info('ZIP download completed successfully:',l),{success:!0,filesProcessed:n.length,filesSuccessful:n.length,filename:l}}catch(s){return a.error('ZIP download failed:',s),{success:!1,filesProcessed:n.length,filesSuccessful:0,error:s instanceof Error?s.message:'ZIP download failed'}}}async downloadIndividually(t,n={}){const{onProgress:r,signal:i}=n
let o=0
try{a.info(`Starting individual downloads for ${t.length} items`)
for(let n=0;t.length>n;n++){const l=t[n]
if(l){if(i?.aborted){a.info('Download cancelled by user')
break}r?.({phase:'downloading',current:n+1,total:t.length,percentage:Math.round((n+1)/t.length*100),filename:$a(l,{index:n+1})})
try{await this.downloadSingleWithIndex(l,n+1)&&o++}catch(s){a.error(`Failed to download item ${n+1}:`,s)}t.length-1>n&&await this.delay(e.CONFIG.RATE_LIMIT_DELAY_MS)}}return r?.({phase:'complete',current:t.length,total:t.length,percentage:100}),a.info(`Individual downloads completed: ${o}/${t.length} successful`),{success:o>0,filesProcessed:t.length,filesSuccessful:o}}catch(s){return a.error('Individual downloads failed:',s),{success:!1,filesProcessed:t.length,filesSuccessful:o,error:s instanceof Error?s.message:'Individual downloads failed'}}}determineOptimalStrategy(e){return 1===e.length?'individual':'zip'}extractSafeUrl(e){return'originalUrl'in e&&e.originalUrl?e.originalUrl:e.url||''}delay(e){return new Promise((t=>setTimeout(t,e)))}},o.defineProperty(e,'instance',void 0),o.defineProperty(e,'CONFIG',{ZIP_COMPRESSION_LEVEL:6,MAX_FILE_SIZE_MB:100,REQUEST_TIMEOUT_MS:3e4,DEFAULT_CONCURRENT_DOWNLOADS:3,RATE_LIMIT_DELAY_MS:500}),Ba=e}}),eo={}
f(eo,{ServiceManager:()=>Ka,serviceManager:()=>Ja})
var to,no,ro=d({'src/core/services/ServiceManager.ts'(){var e
It(),qa=new WeakMap,Za=new WeakMap,Ya=new WeakMap,Xa=new WeakMap,e=class e{constructor(){o.defineProperty(this,'isReady',!1),this.initializeCaches(),this.isReady=!0}initializeCaches(){qa.set(this,new Map),Za.set(this,new Map),Ya.set(this,new Set),Xa.set(this,new Map)}ensureCaches(){let e=qa.get(this),t=Za.get(this),n=Ya.get(this),r=Xa.get(this)
if(!(e&&t&&n&&r||(a.warn('[ServiceManager] Cache lost, reinitializing...'),this.initializeCaches(),e=qa.get(this),t=Za.get(this),n=Ya.get(this),r=Xa.get(this),e&&t&&n&&r)))throw Error('[ServiceManager] Critical error: Failed to initialize caches')
return{services:e,configs:t,initialized:n,loading:r}}static getInstance(){return this.instance??(this.instance=new e),this.instance}register(e,t){if(!this.isReady)throw Error('[ServiceManager] Manager not ready for registration')
const{configs:n}=this.ensureCaches()
n.has(e)&&a.warn('[ServiceManager] Service already registered, overwriting: '+e),n.set(e,{singleton:!0,lazy:!0,...t}),a.debug('[ServiceManager] Registered service: '+e)}async get(e){if(!this.isReady)throw Error('[ServiceManager] Manager not ready')
const{services:t,configs:n,loading:r,initialized:i}=this.ensureCaches(),o=n.get(e)
if(!o)throw Error('[ServiceManager] Service not registered: '+e)
if(o.singleton&&t.has(e))return t.get(e)
if(r.has(e)){const t=r.get(e)
if(t)return t}o.dependencies&&o.dependencies.length>0&&this.checkCircularDependency(e,o.dependencies,n,new Set),o.dependencies&&o.dependencies.length>0&&await this.loadDependenciesOptimized(o.dependencies)
const s=this.createServiceOptimized(e,o)
r.set(e,s)
try{const n=await s
return o.singleton&&t.set(e,n),i.add(e),r.delete(e),a.debug('[ServiceManager] Service loaded: '+e),n}catch(l){throw r.delete(e),a.error(`[ServiceManager] Failed to load service ${e}:`,l),l}}getService(e){if(!this.isReady)throw Error('[ServiceManager] Manager not ready')
const{services:t,configs:n,initialized:r}=this.ensureCaches(),i=n.get(e)
if(!i)throw Error('[ServiceManager] Service not registered: '+e)
if(!r.has(e))throw Error(`[ServiceManager] Service not initialized yet: ${e}. Use get() for async loading.`)
if(i.singleton&&t.has(e))return t.get(e)
throw Error('[ServiceManager] Service instance not found in cache: '+e)}async initializeAll(){const{configs:e}=this.ensureCaches(),t=Array.from(e.keys())
if(0===t.length)return a.warn('[ServiceManager] No services registered for initialization'),void 0
try{await this.initializeBatch(t),a.info(`[ServiceManager] All ${t.length} services initialized successfully`)}catch(n){throw a.error('[ServiceManager] Failed to initialize all services:',n),n}}cleanup(e){const{services:t,initialized:n,loading:r}=this.ensureCaches()
e?this.cleanupSingleService(e,t,n,r):this.cleanupAllServices(t,n,r)}cleanupSingleService(e,t,n,r){try{const i=t.get(e)
this.destroyService(i,e),t.delete(e),n.delete(e),r.delete(e),a.debug('[ServiceManager] Service cleaned up: '+e)}catch(i){a.warn(`[ServiceManager] Error cleaning up service ${e}:`,i)}}cleanupAllServices(e,t,n){let r=0,i=0
for(const[s,l]of e.entries())try{this.destroyService(l,s),r++}catch(o){a.warn(`[ServiceManager] Error destroying service ${s}:`,o),i++}e.clear(),t.clear(),n.clear(),a.info(`[ServiceManager] Cleanup complete: ${r} services cleaned, ${i} errors`),'function'==typeof globalThis.gc&&globalThis.gc()}destroyService(e,t){if(e&&'object'==typeof e&&'destroy'in e&&'function'==typeof e.destroy)try{e.destroy()}catch(n){throw Error(`Service ${t} destroy failed: ${n}`)}}isInitialized(e){const t=Ya.get(this)
return t?.has(e)??!1}getLoadedServices(){const e=Ya.get(this)
return e?Array.from(e):[]}async loadDependenciesOptimized(e){await Promise.all(e.map((e=>this.get(e))))}checkCircularDependency(e,t,n,r){if(r.has(e)){const t=`${Array.from(r).join(' -> ')} -> ${e}`
throw Error('[ServiceManager] Circular dependency detected: '+t)}r.add(e)
for(const i of t){const e=n.get(i)
e?.dependencies&&this.checkCircularDependency(i,e.dependencies,n,r)}r.delete(e)}async createServiceOptimized(e,t){try{const n=performance.now(),r=await t.factory()
r&&'function'==typeof r.initialize&&await r.initialize()
const i=performance.now()
return a.debug(`[ServiceManager] Created service ${e} in ${(i-n).toFixed(2)}ms`),r}catch(n){throw a.error(`[ServiceManager] Failed to create service ${e}:`,n),n}}getMemoryUsage(){return null}getDiagnostics(){const{configs:e,initialized:t,loading:n}=this.ensureCaches()
return{isReady:this.isReady,registeredServices:Array.from(e.keys()),initializedServices:Array.from(t),loadingServices:Array.from(n.keys()),memoryUsage:this.getMemoryUsage()}}static resetInstance(){this.instance&&(this.instance.cleanup(),this.instance=null)}isRegistered(e){const{configs:t}=this.ensureCaches()
return t.has(e)}getRegisteredServices(){const{configs:e}=this.ensureCaches()
return Array.from(e.keys())}getServiceConfig(e){const{configs:t}=this.ensureCaches()
return t.get(e)??null}async tryGet(e){try{return await this.get(e)}catch(t){return a.warn('[ServiceManager] Failed to get service safely: '+e,t),null}}async initializeBatch(e){const{configs:t}=this.ensureCaches(),n=this.topologicalSort(e,t)
a.debug('[ServiceManager] Initializing services in order: '+n.join(', '))
for(const i of n)try{await this.get(i)}catch(r){throw a.error('[ServiceManager] Failed to initialize service in batch: '+i,r),r}}topologicalSort(e,t){const n=new Set,r=new Set,i=[],a=o=>{if(n.has(o))return
if(r.has(o))throw Error('[ServiceManager] Circular dependency detected involving: '+o)
r.add(o)
const s=t.get(o)
if(s?.dependencies)for(const t of s.dependencies)e.includes(t)&&a(t)
r.delete(o),n.add(o),i.push(o)}
for(const o of e)a(o)
return i}},o.defineProperty(e,'instance',null),Ja=(Ka=e).getInstance()}}),io=d({'src/shared/utils/core/dom/safe-dom.ts'(){It(),to={querySelector:(e,t=document)=>{try{return e&&t?.querySelector?t.querySelector(e):null}catch(n){return a.error('Failed to query selector:',e,n),null}},querySelectorAll:(e,t=document)=>{try{return e&&t?.querySelectorAll?t.querySelectorAll(e):[]}catch(n){return a.error('Failed to query selector all:',e,n),[]}},getElementById:e=>{try{return e&&document?.getElementById?document.getElementById(e):null}catch(t){return a.error('Failed to get element by id:',e,t),null}},createElement:(e,t)=>{try{if(!e||!document?.createElement)return null
const n=document.createElement(e)
return t&&Object.entries(t).forEach((([e,t])=>{try{'className'===e?n.className=t:n.setAttribute(e,t)}catch(r){a.error('Failed to set attribute:',e,t,r)}})),n}catch(n){return a.error('Failed to create element:',e,n),null}},setAttribute:(e,t,n)=>{try{return!!(e&&t&&e.setAttribute)&&(e.setAttribute(t,n),!0)}catch(r){return a.error('Failed to set attribute:',t,n,r),!1}},getAttribute:(e,t)=>{try{return e&&t&&e.getAttribute?e.getAttribute(t):null}catch(n){return a.error('Failed to get attribute:',t,n),null}},addEventListener:(e,t,n,r)=>{try{return!!(e&&t&&n&&e.addEventListener)&&(e.addEventListener(t,n,r),!0)}catch(i){return a.error('Failed to add event listener:',t,i),!1}},removeEventListener:(e,t,n,r)=>{try{return!!(e&&t&&n&&e.removeEventListener)&&(e.removeEventListener(t,n,r),!0)}catch(i){return a.error('Failed to remove event listener:',t,i),!1}},appendChild:(e,t)=>{try{return!!(e&&t&&e.appendChild)&&(e.appendChild(t),!0)}catch(n){return a.error('Failed to append child:',n),!1}},removeChild:(e,t)=>{try{return!!(e&&t&&e.removeChild&&t.parentNode===e)&&(e.removeChild(t),!0)}catch(n){return a.error('Failed to remove child:',n),!1}},isElement:e=>{try{return null!=e&&('undefined'!=typeof Element&&e instanceof Element||'object'==typeof e&&null!==e&&'string'==typeof e.tagName&&'number'==typeof e.nodeType&&1===e.nodeType)}catch(t){return a.error('Failed to check if element:',t),!1}}}}}),ao={}
function oo(){const e=to.createElement('div')
if(!e)return a.error('Failed to create scrollbar measurement container'),0
e.style.visibility='hidden',e.style.overflow='scroll',e.style.position='absolute',e.style.width='100px',e.style.height='100px'
const t=to.createElement('div')
if(!t)return a.error('Failed to create inner measurement container'),0
if(t.style.width='100%',t.style.height='100%',!to.appendChild(e,t))return a.error('Failed to append inner container'),0
if(!to.appendChild(document.body,e))return a.error('Failed to append outer container to body'),0
const n=e.offsetWidth-t.offsetWidth
return to.removeChild(document.body,e),n}function so(){return no.getInstance()}function lo(){no.getInstance().lock()}function co(){no.getInstance().unlock()}function uo(){return no.getInstance().isScrollLocked()}function ho(e,t={behavior:'smooth',block:'center'}){try{e.scrollIntoView(t)}catch(n){a.warn('Failed to scroll to element:',n),e.scrollIntoView()}}function fo(){return{x:window.pageXOffset||document.documentElement.scrollLeft||0,y:window.pageYOffset||document.documentElement.scrollTop||0}}function go(e,t){try{window.scrollTo(e,t)}catch(n){a.warn('Failed to set scroll position:',n)}}function po(){const e=no.getInstance()
e.isScrollLocked()&&e.forceUnlock()}f(ao,{PageScrollLockManager:()=>no,calculateScrollbarWidth:()=>oo,cleanup:()=>po,getPageScrollLockManager:()=>so,getScrollPosition:()=>fo,isPageScrollLocked:()=>uo,lockPageScroll:()=>lo,scrollToElement:()=>ho,setScrollPosition:()=>go,unlockPageScroll:()=>co})
var mo,vo,yo=d({'src/shared/utils/core/dom/scroll-manager.ts'(){var e
It(),io(),e=class e{constructor(){o.defineProperty(this,'isLocked',!1),o.defineProperty(this,'originalOverflow',''),o.defineProperty(this,'originalPosition',''),o.defineProperty(this,'originalTop',''),o.defineProperty(this,'originalLeft',''),o.defineProperty(this,'originalWidth',''),o.defineProperty(this,'savedScrollTop',0),o.defineProperty(this,'savedScrollLeft',0)}static getInstance(){return e.instance??(e.instance=new e),e.instance}lock(){if(this.isLocked)return a.debug('Scroll already locked'),void 0
try{const e=document.body
this.savedScrollTop=window.pageYOffset||document.documentElement.scrollTop||0,this.savedScrollLeft=window.pageXOffset||document.documentElement.scrollLeft||0,this.originalOverflow=e.style.overflow,this.originalPosition=e.style.position,this.originalTop=e.style.top,this.originalLeft=e.style.left,this.originalWidth=e.style.width,e.style.position='fixed',e.style.top=`-${this.savedScrollTop}px`,e.style.left=`-${this.savedScrollLeft}px`,e.style.width='100%',e.style.overflow='hidden',this.isLocked=!0,a.debug('Scroll locked with position preservation',{scrollTop:this.savedScrollTop,scrollLeft:this.savedScrollLeft})}catch(e){a.error('Failed to lock scroll:',e)}}unlock(){if(!this.isLocked)return a.debug('Scroll not locked'),void 0
try{const e=document.body
e.style.position=this.originalPosition,e.style.top=this.originalTop,e.style.left=this.originalLeft,e.style.width=this.originalWidth,e.style.overflow=this.originalOverflow,window.scrollTo(this.savedScrollLeft,this.savedScrollTop),this.isLocked=!1,this._resetState(),a.debug('Scroll unlocked and position restored',{scrollTop:this.savedScrollTop,scrollLeft:this.savedScrollLeft})}catch(e){a.error('Failed to unlock scroll:',e)}}isScrollLocked(){return this.isLocked}getSavedScrollPosition(){return{top:this.savedScrollTop,left:this.savedScrollLeft}}forceUnlock(){if(this.isLocked){a.warn('Force unlocking scroll'),this.isLocked=!1
const e=document.body
e.style.position='',e.style.top='',e.style.left='',e.style.width='',e.style.overflow='',this._resetState()}}_resetState(){this.originalOverflow='',this.originalPosition='',this.originalTop='',this.originalLeft='',this.originalWidth='',this.savedScrollTop=0,this.savedScrollLeft=0}},o.defineProperty(e,'instance',null),no=e}}),_o={}
f(_o,{GalleryScrollManager:()=>mo,galleryScrollManager:()=>vo})
var wo,bo,Io=d({'src/shared/utils/core/dom/gallery-scroll-manager.ts'(){var e
It(),e=class e{static getInstance(){return e.instance??(e.instance=new e),e.instance}constructor(){o.defineProperty(this,'focusedImageIndex',0),o.defineProperty(this,'savedScrollPosition',0),o.defineProperty(this,'visibilityCache',new Map),a.debug('GalleryScrollManager: \uc778\uc2a4\ud134\uc2a4 \uc0dd\uc131')}setFocusedImageIndex(e){this.focusedImageIndex=e,a.debug('GalleryScrollManager: \ud3ec\ucee4\uc2a4 \uc774\ubbf8\uc9c0 \uc778\ub371\uc2a4 \uc800\uc7a5 - '+e)}getFocusedImageIndex(){return this.focusedImageIndex}saveScrollPosition(e){this.savedScrollPosition=e,a.debug('GalleryScrollManager: \uc2a4\ud06c\ub864 \uc704\uce58 \uc800\uc7a5 - '+e)}getSavedScrollPosition(){return this.savedScrollPosition}scrollToImageTop(e,t,n={}){const{behavior:r='smooth',offset:i=0}=n,o=e.children[t]
if(!o)return a.warn(`GalleryScrollManager: \uc778\ub371\uc2a4 ${t}\uc5d0 \ud574\ub2f9\ud558\ub294 \uc774\ubbf8\uc9c0\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc74c`),void 0
e.scrollTo({top:Math.max(0,o.offsetTop+i),behavior:r}),o.scrollIntoView({behavior:r,block:'start',inline:'nearest'}),a.debug(`GalleryScrollManager: \uc774\ubbf8\uc9c0 ${t}\ub85c \uc0c1\ub2e8 \uc815\ub82c \uc2a4\ud06c\ub864 \uc644\ub8cc (offset: ${i})`)}isImageVisible(e,t){const n=e.children[t]
if(!n)return!1
const r=`${e.scrollTop}-${t}-${e.clientHeight}`
if(this.visibilityCache.has(r))return this.visibilityCache.get(r)??!1
const i=e.getBoundingClientRect(),o=n.getBoundingClientRect(),s=o.top>=i.top&&i.bottom>=o.bottom
if(this.visibilityCache.size>100){const e=this.visibilityCache.keys().next().value
e&&this.visibilityCache.delete(e)}return this.visibilityCache.set(r,s),a.debug(`GalleryScrollManager: \uc774\ubbf8\uc9c0 ${t} \uac00\uc2dc\uc131 \ud655\uc778 - ${s?'\ubcf4\uc784':'\uc548\ubcf4\uc784'} (cached: ${r})`),s}restoreScrollPosition(e,t){const n=t??this.savedScrollPosition
e.scrollTo({top:n,behavior:'auto'}),a.debug('GalleryScrollManager: \uc2a4\ud06c\ub864 \uc704\uce58 \ubcf5\uc6d0 - '+n)}reset(){this.focusedImageIndex=0,this.savedScrollPosition=0,this.visibilityCache.clear(),a.debug('GalleryScrollManager: \uc0c1\ud0dc \ucd08\uae30\ud654 \uc644\ub8cc (\uce90\uc2dc \ud3ec\ud568)')}},o.defineProperty(e,'instance',void 0),vo=(mo=e).getInstance()}}),So=d({'src/shared/utils/core/dom/index.ts'(){io(),yo(),Io()}}),Eo=d({'src/shared/utils/core/accessibility.ts'(){}}),xo={}
f(xo,{AutoThemeController:()=>wo,autoThemeHelpers:()=>bo})
var To,Mo,Co,ko,Ao,Po,Uo,Do=d({'src/shared/utils/core/auto-theme.ts'(){var e
e=class e{static getInstance(){return e.instance??(e.instance=new e),e.instance}constructor(){o.defineProperty(this,'config',void 0),o.defineProperty(this,'currentTheme','auto'),o.defineProperty(this,'timeCheckInterval',null),o.defineProperty(this,'transitionTimeout',null),this.config={enabled:!0,timeBasedTheme:!0,contentBasedTheme:!0,transitionDuration:600,debug:!1},this.initialize()}initialize(){this.log('Initializing auto theme system...'),this.watchSystemTheme(),this.config.timeBasedTheme&&this.startTimeBasedThemeCheck(),this.applyAutoTheme(),this.log('Auto theme system initialized')}updateConfig(e){this.config={...this.config,...e},this.config.timeBasedTheme?this.startTimeBasedThemeCheck():this.stopTimeBasedThemeCheck(),this.log('Theme config updated:',this.config)}watchSystemTheme(){if(!window.matchMedia)return this.log('window.matchMedia not available, skipping system theme watch'),void 0
const e=window.matchMedia('(prefers-color-scheme: dark)'),t=e=>{this.log('System theme changed:',e.matches?'dark':'light'),this.config.enabled&&this.applyAutoTheme()}
e.addEventListener?e.addEventListener('change',t):e.addListener(t)}startTimeBasedThemeCheck(){this.stopTimeBasedThemeCheck(),this.timeCheckInterval=window.setInterval((()=>{this.config.enabled&&this.config.timeBasedTheme&&this.applyTimeBasedTheme()}),18e5),this.applyTimeBasedTheme()}stopTimeBasedThemeCheck(){this.timeCheckInterval&&(clearInterval(this.timeCheckInterval),this.timeCheckInterval=null)}applyTimeBasedTheme(){const e=(new Date).getHours()
let t
t=e>=6&&10>e?'morning':e>=10&&17>e?'day':e>=17&&20>e?'evening':'night',this.applyThemeClass('xeg-theme-auto-'+t),this.log(`Applied time-based theme: ${t} (hour: ${e})`)}applyAutoTheme(){if(!this.config.enabled)return
if('undefined'==typeof window||!window.matchMedia)return this.log('window.matchMedia is not available, skipping auto theme'),void 0
const e=window.matchMedia('(prefers-color-scheme: dark)').matches,t=e?'dark':'light'
document.documentElement.classList.toggle('xeg-theme-dark',e),document.documentElement.classList.toggle('xeg-theme-light',!e),this.enableTransition(),this.log('Applied auto theme: '+t)}async analyzeImageAndAdaptTheme(e){if(this.config.enabled&&this.config.contentBasedTheme)try{const t=await this.analyzeImageColors(e),n=this.determineContentTheme(t)
this.applyThemeClass('xeg-content-'+n),this.log('Applied content-based theme:',n,t)}catch(t){this.log('Error analyzing image colors:',t)}}async analyzeImageColors(e){return new Promise(((t,n)=>{try{const r=document.createElement('canvas'),i=r.getContext('2d')
if(!i)return n(Error('Canvas context not available')),void 0
const a=()=>{try{const n=100
r.width=n,r.height=n,i.drawImage(e,0,0,n,n)
const a=i.getImageData(0,0,n,n),o=this.performColorAnalysis(a.data)
t(o)}catch(a){n(a)}}
e.complete?a():(e.addEventListener('load',a,{once:!0}),e.addEventListener('error',(()=>{n(Error('Image load failed'))}),{once:!0}))}catch(r){n(r)}}))}performColorAnalysis(e){const t=new Map
let n=0,r=0,i=0,a=0
const o=e.length/4
for(let u=0;e.length>u;u+=4){const o=e[u],s=e[u+1],l=e[u+2]
if(128>e[u+3])continue
n+=(.299*o+.587*s+.114*l)/255,r+=this.rgbToHsl(o,s,l).s,o>s&&o>l?i++:l>o&&l>s&&a++
const c='#'+((1<<24)+(o<<16)+(s<<8)+l).toString(16).slice(1),d=this.quantizeColor(c)
t.set(d,(t.get(d)??0)+1)}const s=n/o,l=r/o
let c
return c=i>1.5*a?'warm':a>1.5*i?'cool':'neutral',{dominantColors:Array.from(t.entries()).sort(((e,t)=>t[1]-e[1])).slice(0,5).map((([e])=>e)),brightness:s,saturation:l,temperatureCategory:c,vibrancy:Math.min(l*(t.size/20),1)}}rgbToHsl(e,t,n){const r=Math.max(e/=255,t/=255,n/=255),i=Math.min(e,t,n),a=r-i,o=(r+i)/2
if(0===a)return{h:0,s:0,l:o}
const s=o>.5?a/(2-r-i):a/(r+i)
let l
switch(r){case e:l=(t-n)/a+(n>t?6:0)
break
case t:l=(n-e)/a+2
break
case n:l=(e-t)/a+4
break
default:l=0}return l/=6,{h:l,s:s,l:o}}quantizeColor(e){const t=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),r=parseInt(e.slice(5,7),16),i=32*Math.round(t/32),a=32*Math.round(n/32),o=32*Math.round(r/32)
return`#${i.toString(16).padStart(2,'0')}${a.toString(16).padStart(2,'0')}${o.toString(16).padStart(2,'0')}`}determineContentTheme(e){const{temperatureCategory:t,vibrancy:n,saturation:r}=e
return n>.7&&r>.5?'vibrant':'warm'===t?'warm':'cool'===t?'cool':'neutral'}applyThemeClass(e){this.currentTheme!==e&&(this.enableTransition(),document.documentElement.classList.forEach((e=>{(e.startsWith('xeg-theme-auto-')||e.startsWith('xeg-content-'))&&document.documentElement.classList.remove(e)})),document.documentElement.classList.add(e),this.currentTheme=e,this.log('Applied theme class: '+e))}enableTransition(){document.documentElement.classList.add('xeg-auto-theme-transition'),this.transitionTimeout&&clearTimeout(this.transitionTimeout),this.transitionTimeout=window.setTimeout((()=>{document.documentElement.classList.remove('xeg-auto-theme-transition')}),this.config.transitionDuration)}setManualTheme(e){this.currentTheme=e,document.documentElement.classList.forEach((e=>{e.startsWith('xeg-theme-')&&document.documentElement.classList.remove(e)})),'auto'===e?this.applyAutoTheme():document.documentElement.classList.add('xeg-theme-'+e),this.log('Manual theme set: '+e)}getCurrentTheme(){return this.currentTheme}log(...e){this.config.debug,0}destroy(){this.stopTimeBasedThemeCheck(),this.transitionTimeout&&clearTimeout(this.transitionTimeout),document.documentElement.classList.remove('xeg-auto-theme-transition'),this.log('Auto theme system destroyed')}},o.defineProperty(e,'instance',void 0),wo=e,bo={onGalleryOpen(e){const t=wo.getInstance()
e&&t.analyzeImageAndAdaptTheme(e)},onImageChange(e){wo.getInstance().analyzeImageAndAdaptTheme(e)},onGalleryClose(){document.documentElement.classList.forEach((e=>{e.startsWith('xeg-content-')&&document.documentElement.classList.remove(e)}))},updateSettings(e){wo.getInstance().updateConfig(e)},getCurrentTheme:()=>wo.getInstance().getCurrentTheme()},'undefined'!=typeof window&&(window.xegAutoTheme={controller:wo.getInstance(),helpers:bo})}}),Lo=d({'src/shared/utils/core/index.ts'(){So(),Eo(),Do()}}),Ro=d({'src/core/state/signals/gallery-state.signals.ts'(){var e
It(),Lo(),Pa(),La(),Na(),({batch:To,computed:Mo,effect:Co,signal:ko}=Sa()),e=class e{constructor(e){o.defineProperty(this,'videoControlUtil',void 0),o.defineProperty(this,'isOpen',ko(!1)),o.defineProperty(this,'mediaItems',ko(Object.freeze([]))),o.defineProperty(this,'currentIndex',ko(0)),o.defineProperty(this,'isLoading',ko(!1)),o.defineProperty(this,'error',ko(null)),o.defineProperty(this,'viewMode',ko('verticalList')),o.defineProperty(this,'currentTweetMediaItems',ko(Object.freeze([]))),o.defineProperty(this,'currentMedia',Mo((()=>{const e=this.mediaItems.value,t=this.currentIndex.value
return e.length>0&&t>=0&&e.length>t?e[t]:null}))),o.defineProperty(this,'navigation',Mo((()=>{const e=this.mediaItems.value.length,t=this.currentIndex.value
return Object.freeze({current:t+1,total:e,canPrev:t>0,canNext:e-1>t,hasMultiple:e>1})}))),o.defineProperty(this,'galleryInfo',Mo((()=>{const e=this.mediaItems.value
return Object.freeze({totalImages:e.filter((e=>'image'===e.type)).length,totalVideos:e.filter((e=>'video'===e.type)).length,totalSize:e.length})}))),this.instanceId=e,this.videoControlUtil=Ca.getInstance(),this.setupEffects()}static getInstance(t='default'){e.instances.has(t)||e.instances.set(t,new e(t))
const n=e.instances.get(t)
if(!n)throw Error(`Gallery state manager instance '${t}' not found`)
return n}setupEffects(){Co((()=>{const e=so()
if(this.isOpen.value)try{e.lock(),a.debug('Gallery scroll preserved and locked for instance: '+this.instanceId)}catch(t){a.warn('Failed to preserve scroll during gallery open:',t)}else try{e.unlock(),a.debug('Gallery scroll restored and unlocked for instance: '+this.instanceId)}catch(t){a.warn('Failed to restore scroll during gallery close:',t)}})),Co((()=>{if(this.error.value){const e=this.error.value
setTimeout((()=>{this.error.value===e&&(this.error.value=null)}),5e3)}})),Co((()=>{const e=this.mediaItems.value,t=this.currentIndex.value
0===e.length?this.currentIndex.value=0:e.length>t?0>t&&(this.currentIndex.value=0):this.currentIndex.value=Math.max(0,e.length-1)}))}openGallery(e,t=0){if(!e||!Array.isArray(e))return a.warn('Cannot open gallery with invalid items array'),void 0
const n=e.filter((e=>null!=e&&'object'==typeof e&&'id'in e&&'type'in e&&'url'in e))
if(0===n.length)return a.warn('Cannot open gallery with empty items array'),void 0
const r=Math.max(0,Math.min(t,n.length-1))
this.videoControlUtil.pauseAllVideos(),To((()=>{this.mediaItems.value=Object.freeze([...n]),this.currentIndex.value=r,this.isOpen.value=!0,this.error.value=null}))
try{if(this.isOpen.value){const t=new CustomEvent('xeg:galleryStateChanged',{detail:{isOpen:!0,mediaCount:e.length,startIndex:r,instanceId:this.instanceId}})
document.dispatchEvent(t),a.debug('Gallery state change event dispatched for instance: '+this.instanceId)}}catch(i){a.warn('Failed to dispatch gallery open event:',i)}a.info(`Gallery opened with ${e.length} items, starting at index ${r} for instance: ${this.instanceId}`)}closeGallery(){if(!this.isOpen.value)return a.debug('Gallery is already closed, skipping close process'),void 0
a.debug('Closing gallery for instance: '+this.instanceId),To((()=>{this.isOpen.value=!1,this.isLoading.value=!1,this.error.value=null,this.currentTweetMediaItems.value=Object.freeze([])}))
try{Da.getInstance().clearAllCache(),a.debug('Gallery close: media cache cleared')}catch(e){a.warn('Failed to clear media cache during gallery close:',e)}requestAnimationFrame((()=>{try{document.activeElement&&document.activeElement!==document.body&&(document.body.focus(),a.debug('Focus restored to body after gallery close'))
const e=new CustomEvent('xeg:galleryStateChanged',{detail:{isOpen:!1,mediaCount:this.mediaItems.value.length,instanceId:this.instanceId}})
document.dispatchEvent(e),a.debug('Gallery close event dispatched for instance: '+this.instanceId)}catch(e){a.warn('DOM cleanup during close failed:',e)}})),a.debug('Gallery closed successfully for instance: '+this.instanceId)}goToNext(){const e=this.currentIndex.value
this.mediaItems.value.length-1>e&&(this.currentIndex.value=e+1)}goToPrevious(){const e=this.currentIndex.value
e>0&&(this.currentIndex.value=e-1)}goToIndex(e){e>=0&&this.mediaItems.value.length>e&&(this.currentIndex.value=e)}goToFirst(){this.currentIndex.value=0}goToLast(){const e=this.mediaItems.value
e.length>0&&(this.currentIndex.value=e.length-1)}setLoading(e){this.isLoading.value=e}setError(e){this.error.value=e}setViewMode(e){this.viewMode.value='verticalList',a.debug(`Gallery view mode set to: verticalList (requested: ${e})`)}setCurrentTweetMediaItems(e){this.currentTweetMediaItems.value=Object.freeze([...e]),a.debug(`Current tweet media items updated: ${e.length} items`)}clearCurrentTweetMediaItems(){this.currentTweetMediaItems.value=Object.freeze([])}addMediaItems(e){if(0===e.length)return
const t=this.mediaItems.value,n=e.filter((e=>!t.some((t=>t.id===e.id))))
n.length>0&&(this.mediaItems.value=Object.freeze([...t,...n]))}removeMediaItem(e){const t=this.mediaItems.value,n=t.filter((t=>t.id!==e))
n.length!==t.length&&(this.mediaItems.value=n)}reactivateGallery(e){const t=this.mediaItems.value
if(0===t.length)return a.warn('Cannot reactivate gallery: no media items available'),!1
const n=Math.max(0,Math.min(e??this.currentIndex.value,t.length-1))
return To((()=>{this.currentIndex.value=n,this.isOpen.value=!0,this.isLoading.value=!1,this.error.value=null})),a.info(`Gallery reactivated at index ${n} for instance: ${this.instanceId}`),!0}canReactivate(){return!this.isOpen.value&&this.mediaItems.value.length>0}reset(){To((()=>{this.isOpen.value=!1,this.mediaItems.value=Object.freeze([]),this.currentIndex.value=0,this.isLoading.value=!1,this.error.value=null,this.currentTweetMediaItems.value=Object.freeze([])})),a.debug('Gallery state reset for instance: '+this.instanceId)}forceResetAll(){a.warn('\ud83d\udd04 Force reset initiated for instance: '+this.instanceId),To((()=>{this.isOpen.value=!1,this.mediaItems.value=Object.freeze([]),this.currentIndex.value=0,this.isLoading.value=!1,this.error.value=null,this.currentTweetMediaItems.value=Object.freeze([]),this.viewMode.value='verticalList'}))
try{const e=so()
e.isScrollLocked()&&(e.forceUnlock(),a.debug('ScrollManager force unlocked during gallery force reset')),document.body.classList.remove('xeg-gallery-open'),document.body.style.removeProperty('overflow'),document.body.style.removeProperty('position'),document.body.style.removeProperty('top'),document.body.style.removeProperty('left'),document.body.style.removeProperty('width'),document.body.style.removeProperty('padding-right'),document.documentElement.style.removeProperty('overflow'),document.querySelectorAll('[data-gallery-element="overlay"]').forEach((e=>{try{e.remove()}catch(t){a.warn('Failed to remove overlay:',t)}}))
const t=document.querySelector('#react-root')
t instanceof HTMLElement&&(t.style.removeProperty('pointer-events'),t.style.removeProperty('user-select')),document.querySelectorAll('[data-xeg-gallery]').forEach((e=>{try{e.remove()}catch(t){a.warn('Failed to remove gallery element:',t)}})),a.debug('\u2705 DOM force cleanup completed')}catch(e){a.warn('DOM force cleanup failed:',e)}try{const e=new CustomEvent('xeg:galleryForceReset',{detail:{instanceId:this.instanceId,timestamp:Date.now()}})
document.dispatchEvent(e)}catch(t){a.warn('Failed to dispatch force reset event:',t)}setTimeout((()=>{if('undefined'!=typeof window&&'gc'in window)try{window.gc?.()}catch{}}),100),a.info('\ud83d\udd04 Gallery state force reset completed for instance: '+this.instanceId)}getSnapshot(){return{isOpen:this.isOpen.value,mediaCount:this.mediaItems.value.length,currentIndex:this.currentIndex.value,isLoading:this.isLoading.value,error:this.error.value}}destroy(){this.reset(),e.instances.delete(this.instanceId)}},o.defineProperty(e,'instances',new Map),(Ao=e).getInstance()}}),zo=d({'src/shared/components/ui/Button/Button.module.css'(){Po={button:'kO70E',primary:'r-V67',secondary:'LmHa-',ghost:'GxXeW',danger:'NH-Q1',small:'_15ywo',medium:'J7bOc',large:'wUyoI',iconOnly:'XYc0m',loading:'CfJMD',spin:'-LxVZ',fullWidth:'caLxn'}}})
function No(e,t,n,r,i,a){t||(t={})
var o,s,l=t
if('ref'in l)for(s in l={},t)'ref'==s?o=t[s]:l[s]=t[s]
var c={type:e,props:l,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Uo,__i:-1,__u:0,__source:i,__self:a}
if('function'==typeof e&&(o=e.defaultProps))for(s in o)void 0===l[s]&&(l[s]=o[s])
return qt.vnode&&qt.vnode(c),c}var Oo,$o,Fo,Vo,Go,Bo,Ho=d({'node_modules/preact/jsx-runtime/dist/jsxRuntime.module.js'(){er(),Uo=0}}),jo=d({'src/shared/components/ui/Button/Button.tsx'(){Pa(),zo(),Ho(),({h:Oo}=ba()),({forwardRef:$o}=Ia()),(Fo=$o((({children:e,variant:t='primary',size:n='medium',disabled:r=!1,loading:i=!1,type:a='button',className:o='','aria-label':s,icon:l,iconOnly:c=!1,onClick:u,...d},f)=>No('button',{ref:f,type:a,className:[Po.button,Po[t],Po[n],i&&Po.loading,r&&Po.disabled,c&&Po.iconOnly,o].filter(Boolean).join(' '),disabled:r||i,onClick:e=>{if(r||i)return e.preventDefault(),void 0
u?.(e)},'aria-label':s,...d,children:i?No('span',{className:Po.spinner,'aria-hidden':'true'}):No(vn,{children:[l&&No('span',{className:Po.icon,children:l}),!c&&No('span',{className:Po.text,children:e})]})})))).displayName='Button'}}),Wo=d({'src/shared/components/ui/Toast/Toast.module.css'(){Vo={toast:'ZFHVp',slideIn:'EGn7K',info:'_77OPw',success:'-xmqE',warning:'_8TZRU',error:'fIfdy',content:'fLa9j',header:'gPkSr',title:'N1Mhw',message:'Xsl3l',closeButton:'f3X-0',actions:'UYZjw',actionButton:'fCIaz'}}})
function qo({toast:e,onRemove:t}){return Bo((()=>{if(e.duration&&e.duration>0){const n=setTimeout((()=>{t(e.id)}),e.duration)
return()=>clearTimeout(n)}return()=>{}}),[e.id,e.duration,t]),No('div',{className:`${Vo.toast} ${Vo[e.type]}`,role:'alert',children:No('div',{className:Vo.content,children:[No('div',{className:Vo.header,children:[No('h4',{className:Vo.title,children:e.title}),No('button',{className:Vo.closeButton,onClick:()=>{t(e.id)},'aria-label':'\uc54c\ub9bc \ub2eb\uae30',children:'\xd7'})]}),No('p',{className:Vo.message,children:e.message}),e.actionText&&e.onAction&&No('div',{className:Vo.actions,children:No('button',{className:Vo.actionButton,onClick:()=>{e.onAction&&e.onAction(),t(e.id)},children:e.actionText})})]})})}var Zo,h,useMemo,useState,useCallback,useEffect,useRef,Yo=d({'src/shared/components/ui/Toast/Toast.tsx'(){Pa(),Wo(),Ho(),({signal:Go}=Sa()),({useEffect:Bo}=Ia()),Go([])}}),Xo=d({'src/shared/components/ui/Toolbar/Toolbar.module.css'(){Zo={galleryToolbar:'fLg7u',toolbarContent:'f8g4u',toolbarSection:'dBJnf',toolbarLeft:'CyUjf',toolbarRight:'hZtD9',toolbarCenter:'DoE8Y',separator:'FKnOO',toolbarButton:'_4eoja',active:'sebGk',toolbarNavigation:'nUxyF',navButton:'PAXbY',mediaCounterWrapper:'GG869',mediaCounter:'_2cjmv',currentIndex:'JEXmP',totalCount:'d1et2',progressBar:'vB6NL',progressFill:'LWQwI',fitModeGroup:'EdOEV',fitButton:'Q7dUY',selected:'bt8jv',downloadButton:'atmJJ',downloadCurrent:'njlfQ',downloadAll:'AU-dP',downloadAllBadge:'_7e9VX',downloadSpinner:'a0GDK',spin:'m4eyx',settingsButton:'V6D-I',closeButton:'Vn14N',highContrast:'OzLl1'}}})
function Ko({currentIndex:e,totalCount:t,isDownloading:n=!1,disabled:r=!1,className:i='',onPrevious:a,onNext:o,onDownloadCurrent:s,onDownloadAll:l,onClose:c,onOpenSettings:u,onFitOriginal:d,onFitHeight:f,onFitWidth:g,onFitContainer:p}){const[m,v]=useState(null),[y,_]=useState('fitWidth'),[w,b]=useState(!1),I=useRef(null)
useEffect((()=>{const e=()=>{if(!I.current)return
const e=I.current.getBoundingClientRect()
let t=0;[{x:e.left+.25*e.width,y:e.top+e.height/2},{x:e.left+.5*e.width,y:e.top+e.height/2},{x:e.left+.75*e.width,y:e.top+e.height/2}].forEach((e=>{document.elementsFromPoint(e.x,e.y).some((e=>{const t=window.getComputedStyle(e).backgroundColor
return t.includes('rgb(255')||t.includes('white')||t.includes('rgba(255')}))&&t++})),b(t>=2)}
let t
e()
const n=()=>{clearTimeout(t),t=window.setTimeout((()=>{requestAnimationFrame(e)}),100)}
return window.addEventListener('scroll',n,{passive:!0}),()=>{window.removeEventListener('scroll',n),clearTimeout(t)}}),[])
const S=useMemo((()=>t-1>e),[e,t]),E=useMemo((()=>e>0),[e,t]),x=useCallback(((e,t)=>{v(e),t(),setTimeout((()=>v(null)),150)}),[]),T=useCallback(((e,t)=>{_(e),t&&x('fit-'+e,t)}),[x]),M=useMemo((()=>{const e=[Zo.galleryToolbar]
return i&&e.push(i),w&&e.push(Zo.highContrast),e.join(' ')}),[i,w])
return h('div',{ref:I,className:M,role:'toolbar','aria-label':'\uac24\ub7ec\ub9ac \ub3c4\uad6c\ubaa8\uc74c','aria-disabled':r,'data-gallery-element':'toolbar','data-high-contrast':w},h('div',{className:Zo.toolbarContent,'data-gallery-element':'toolbar-content'},[h('div',{className:`${Zo.toolbarSection} ${Zo.toolbarLeft}`,'data-gallery-element':'navigation-left',key:'toolbar-left'},[h('button',{type:'button',className:`${Zo.toolbarButton} ${Zo.navButton} ${'previous'===m?Zo.active:''}`,onClick:()=>x('previous',a),disabled:r||!E,'aria-label':'\uc774\uc804 \ubbf8\ub514\uc5b4',title:'\uc774\uc804 \ubbf8\ub514\uc5b4 (\u2190)','data-gallery-element':'nav-previous',key:'previous-button'},h('svg',{width:'18',height:'18',viewBox:'0 0 16 16',fill:'currentColor'},h('path',{d:'M10 2L4 8l6 6V2z'}))),h('button',{type:'button',className:`${Zo.toolbarButton} ${Zo.navButton} ${'next'===m?Zo.active:''}`,onClick:()=>x('next',o),disabled:r||!S,'aria-label':'\ub2e4\uc74c \ubbf8\ub514\uc5b4',title:'\ub2e4\uc74c \ubbf8\ub514\uc5b4 (\u2192)','data-gallery-element':'nav-next',key:'next-button'},h('svg',{width:'18',height:'18',viewBox:'0 0 16 16',fill:'currentColor'},h('path',{d:'M6 2l6 6-6 6V2z'})))]),h('div',{className:`${Zo.toolbarSection} ${Zo.toolbarCenter}`,'data-gallery-element':'counter-section',key:'toolbar-center'},h('div',{className:Zo.mediaCounterWrapper,key:'media-counter-wrapper'},[h('span',{className:Zo.mediaCounter,'aria-live':'polite','data-gallery-element':'counter',key:'counter-text'},[h('span',{className:Zo.currentIndex,key:'current'},e+1),h('span',{className:Zo.separator,key:'separator'},'/'),h('span',{className:Zo.totalCount,key:'total'},t)]),h('div',{className:Zo.progressBar,key:'progress-bar'},h('div',{className:Zo.progressFill,style:{width:(t>0?(e+1)/t*100:0)+'%'},key:'progress-fill'}))])),h('div',{className:`${Zo.toolbarSection} ${Zo.toolbarRight}`,'data-gallery-element':'actions-right',key:'toolbar-right'},[h('div',{className:Zo.fitModeGroup,key:'fit-mode-group'},[h('button',{type:'button',className:`${Zo.toolbarButton} ${Zo.fitButton} ${'original'===y?Zo.selected:''} ${'fit-original'===m?Zo.active:''}`,onClick:()=>T('original',d),disabled:r||!d,'aria-label':'\uc6d0\ubcf8 \ud06c\uae30',title:'\uc6d0\ubcf8 \ud06c\uae30 (1:1)','data-gallery-element':'fit-original',key:'fit-original'},h('svg',{width:'16',height:'16',viewBox:'0 0 16 16',fill:'currentColor'},[h('rect',{x:'2',y:'2',width:'12',height:'12',fill:'none',stroke:'currentColor','stroke-width':'1.5'}),h('text',{x:'8',y:'9','text-anchor':'middle','font-size':'5',fill:'currentColor'},'1:1')])),h('button',{type:'button',className:`${Zo.toolbarButton} ${Zo.fitButton} ${'fitWidth'===y?Zo.selected:''} ${'fit-fitWidth'===m?Zo.active:''}`,onClick:()=>T('fitWidth',g),disabled:r||!g,'aria-label':'\uac00\ub85c\uc5d0 \ub9de\ucda4',title:'\uac00\ub85c\uc5d0 \ub9de\ucd94\uae30','data-gallery-element':'fit-width',key:'fit-width'},h('svg',{width:'16',height:'16',viewBox:'0 0 16 16',fill:'currentColor'},[h('rect',{x:'2',y:'5',width:'12',height:'6',fill:'none',stroke:'currentColor','stroke-width':'1.5'}),h('path',{d:'M1 2v2M15 2v2M1 12v2M15 12v2',stroke:'currentColor','stroke-width':'1.5'})])),h('button',{type:'button',className:`${Zo.toolbarButton} ${Zo.fitButton} ${'fitHeight'===y?Zo.selected:''} ${'fit-fitHeight'===m?Zo.active:''}`,onClick:()=>T('fitHeight',f),disabled:r||!f,'aria-label':'\uc138\ub85c\uc5d0 \ub9de\ucda4',title:'\uc138\ub85c\uc5d0 \ub9de\ucd94\uae30','data-gallery-element':'fit-height',key:'fit-height'},h('svg',{width:'16',height:'16',viewBox:'0 0 16 16',fill:'currentColor'},[h('rect',{x:'5',y:'2',width:'6',height:'12',fill:'none',stroke:'currentColor','stroke-width':'1.5'}),h('path',{d:'M2 1h2M12 1h2M2 15h2M12 15h2',stroke:'currentColor','stroke-width':'1.5'})])),h('button',{type:'button',className:`${Zo.toolbarButton} ${Zo.fitButton} ${'fitContainer'===y?Zo.selected:''} ${'fit-fitContainer'===m?Zo.active:''}`,onClick:()=>T('fitContainer',p),disabled:r||!p,'aria-label':'\ucc3d\uc5d0 \ub9de\ucda4',title:'\ucc3d\uc5d0 \ub9de\ucd94\uae30','data-gallery-element':'fit-container',key:'fit-container'},h('svg',{width:'16',height:'16',viewBox:'0 0 16 16',fill:'currentColor'},[h('rect',{x:'1',y:'1',width:'14',height:'14',fill:'none',stroke:'currentColor','stroke-width':'1.5'}),h('rect',{x:'4',y:'4',width:'8',height:'8',fill:'none',stroke:'currentColor','stroke-width':'1'}),h('path',{d:'M2 2l2 2M12 2l2 2M2 14l2-2M14 14l-2-2',stroke:'currentColor','stroke-width':'1'})]))]),h('button',{type:'button',className:`${Zo.toolbarButton} ${Zo.downloadButton} ${Zo.downloadCurrent} ${'download-current'===m?Zo.active:''}`,onClick:()=>x('download-current',s),disabled:r||n,'aria-label':'\ud604\uc7ac \ud30c\uc77c \ub2e4\uc6b4\ub85c\ub4dc',title:'\ud604\uc7ac \ud30c\uc77c \ub2e4\uc6b4\ub85c\ub4dc (Ctrl+D)','data-gallery-element':'download-current',key:'download-current'},[h('svg',{width:'16',height:'16',viewBox:'0 0 16 16',fill:'currentColor',key:'download-icon'},[h('path',{d:'M8 1v10.5L5.5 9 4 10.5 8 14.5l4-4L10.5 9 8 11.5V1z'}),h('path',{d:'M2 13h12v2H2z'})]),n&&h('span',{className:Zo.downloadSpinner,'aria-hidden':'true','data-gallery-element':'spinner',key:'spinner'},'\u27f3')]),t>1&&h('button',{type:'button',className:`${Zo.toolbarButton} ${Zo.downloadButton} ${Zo.downloadAll} ${'download-all'===m?Zo.active:''}`,onClick:()=>x('download-all',l),disabled:r||n,'aria-label':`\uc804\uccb4 ${t}\uac1c \ud30c\uc77c ZIP \ub2e4\uc6b4\ub85c\ub4dc`,title:`\uc804\uccb4 ${t}\uac1c \ud30c\uc77c ZIP \ub2e4\uc6b4\ub85c\ub4dc`,'data-gallery-element':'download-all',key:'download-all'},[h('svg',{width:'16',height:'16',viewBox:'0 0 16 16',fill:'currentColor',key:'download-all-icon'},h('path',{d:'M2 3h12v1H2V3zm0 3h12v1H2V6zm0 3h12v1H2V9zm6 2v2.5L5.5 11 4 12.5 8 16.5l4-4L10.5 11 8 13.5V11z'})),h('span',{className:Zo.downloadAllBadge,key:'download-all-badge'},t)]),u&&h('button',{type:'button',className:`${Zo.toolbarButton} ${Zo.settingsButton} ${'settings'===m?Zo.active:''}`,onClick:()=>x('settings',u),disabled:r,'aria-label':'\uc124\uc815 \uc5f4\uae30',title:'\uc124\uc815','data-gallery-element':'settings',key:'settings'},h('svg',{width:'16',height:'16',viewBox:'0 0 16 16',fill:'currentColor'},[h('path',{d:'M8 4.5a3.5 3.5 0 100 7 3.5 3.5 0 000-7zM6.5 8a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z'}),h('path',{d:'M8.5 1a.5.5 0 00-1 0v1.5a6.5 6.5 0 000 11V15a.5.5 0 001 0v-1.5a6.5 6.5 0 000-11V1z'})])),h('button',{type:'button',className:`${Zo.toolbarButton} ${Zo.closeButton} ${'close'===m?Zo.active:''}`,onClick:()=>x('close',c),disabled:r,'aria-label':'\uac24\ub7ec\ub9ac \ub2eb\uae30',title:'\uac24\ub7ec\ub9ac \ub2eb\uae30 (Esc)','data-gallery-element':'close',key:'close'},h('svg',{width:'16',height:'16',viewBox:'0 0 16 16',fill:'currentColor'},h('path',{d:'M2.5 2.5L13.5 13.5M13.5 2.5L2.5 13.5',stroke:'currentColor','stroke-width':'2','stroke-linecap':'round'})))])]))}var Jo,Qo,es,ts,ns=d({'src/shared/components/ui/Toolbar/Toolbar.tsx'(){Pa(),Xo(),({h:h}=ba()),({useMemo:useMemo,useState:useState,useCallback:useCallback,useEffect:useEffect,useRef:useRef}=Ia())}}),rs=d({'src/features/gallery/components/vertical-gallery-view/VerticalGalleryView.module.css'(){Jo={container:'X9gZR',visible:'_5oV6P',empty:'yhK-D',toolbarWrapper:'meO3U',itemActive:'LxHLC',toolbarVisible:'Bf-LG',toolbarHidden:'a31o9',content:'GpJm7',itemsList:'lbBLC',focusGlow:'YBPBl',focusScale:'LCzSt',fadeInOut:'xI8D5',emptyMessage:'fwsrV',emptyButton:'fdlfq',toastContainer:'XJJci'}}}),is=d({'src/shared/components/hoc/GalleryMarker.tsx'(){It(),Pa(),({createElement:Qo}=ba()),es={className:'',preventClick:!0,preventKeyboard:!1,preventTouch:!1,customData:{}}}}),as=d({'src/shared/components/media/VideoViewer.module.css'(){ts={videoContainer:'PFezc',video:'Hmn5P',loadingContainer:'kMw-b',loadingSpinner:'fLAGl',spin:'EE9Oh',loadingText:'E01ZT',errorContainer:'y6EGs',errorMessage:'dXUVn',errorIcon:'_49LwT',container:'_3KADf',spinner:'_1-6PE'}}})
function os({media:e,autoPlay:t=!1,controls:n=!0,muted:r=!0,className:i='',isActive:o=!1,isVisible:s=!1}){const l=sr(null),c=sr(null),[u,d]=rr(null),[f,g]=rr(!1),[p,m]=rr(null),[v,y]=rr(!1),[_,w]=rr(!1),[b,I]=rr(!1),S=ur((async e=>{try{g(!0),m(null),a.debug('Starting temp video download:',e)
const t=await fetch(e)
if(!t.ok)throw Error(`HTTP ${t.status}: ${t.statusText}`)
const n=await t.blob(),r=URL.createObjectURL(n)
return a.debug('Temp video download completed'),{url:r,blob:n}}catch(t){const e=t instanceof Error?t.message:'Unknown error'
return a.error('Failed to download temp video:',e),m('\ub3d9\uc601\uc0c1 \ub85c\ub4dc \uc2e4\ud328: '+e),null}finally{g(!1)}}),[])
ar((()=>{const e=c.current
if(!e)return
const t=new IntersectionObserver((e=>{const t=e[0]
t&&w(t.isIntersecting)}),{threshold:.5,rootMargin:'0px'})
return t.observe(e),()=>{t.disconnect()}}),[]),ar((()=>{const e=!!(o&&s&&_&&u)
I(e),a.debug('Video play conditions:',{isActive:o,isVisible:s,isInViewport:_,tempVideoData:!!u,shouldPlay:e})}),[o,s,_,u]),ar((()=>{const e=l.current
e&&u&&(async()=>{try{b?e.paused&&(await e.play(),a.debug('Video started playing')):e.paused||(e.pause(),a.debug('Video paused'))}catch(t){a.debug('Video playback control error:',t)}})()}),[b,u]),ar((()=>()=>{const e=l.current
e&&!e.paused&&(e.pause(),e.currentTime=0,a.debug('Video stopped on unmount'))}),[]),ar((()=>{e.url&&!v&&o&&s&&(async()=>{const t=await S(e.url)
t&&(d(t),y(!0))})()}),[e.url,S,v,o,s]),ar((()=>()=>{u?.url&&(URL.revokeObjectURL(u.url),a.debug('Temp video URL revoked'))}),[u])
const E=ur((()=>{a.debug('Video loaded successfully')}),[]),x=ur((()=>{m('\ub3d9\uc601\uc0c1 \uc7ac\uc0dd \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4'),a.error('Video playback error')}),[])
return No('div',p?{className:`${ts.errorContainer} ${i}`,children:No('div',{className:ts.errorMessage,children:[No('div',{className:ts.errorIcon,children:'\u26a0\ufe0f'}),No('div',{children:p})]})}:f||!u?{className:`${ts.loadingContainer} ${i}`,children:[No('div',{className:ts.loadingSpinner}),No('div',{className:ts.loadingText,children:'\ub3d9\uc601\uc0c1 \ub85c\ub529 \uc911...'})]}:{ref:c,className:`${ts.videoContainer} ${i}`,children:No('video',{ref:l,src:u.url,autoPlay:!1,controls:n,muted:r,onLoad:E,onError:x,className:ts.video,preload:'metadata',playsInline:!0,loop:!1,children:[No('source',{src:u.url,type:'video/mp4'}),'\ube0c\ub77c\uc6b0\uc800\uac00 \ub3d9\uc601\uc0c1 \uc7ac\uc0dd\uc744 \uc9c0\uc6d0\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.']})})}var ss,ls,cs=d({'src/shared/components/media/VideoViewer.tsx'(){It(),Zr(),as(),Ho()}}),us=d({'src/features/gallery/components/vertical-gallery-view/VerticalImageItem.module.css'(){ss={container:'huYoS',active:'xm-1c',imageWrapper:'_8-c8d',placeholder:'lhkEW',loadingSpinner:'_6YYDY',spin:'EYyXZ',image:'FWlk5',fitOriginal:'yYtGJ',fitWidth:'Uc0oU',fitHeight:'M9Z6M',fitContainer:'-Mlrh',errorState:'qb9K3',errorIcon:'Wno7U',errorText:'_8-wis',overlay:'PjdGb',indexBadge:'_7a-5M',metadata:'_3r-xC',filename:'TyK4e',fileSize:'-W7qa',downloadButton:'feyj6',downloadIcon:'nVAwF',error:'GsweP',loaded:'y9iPu',eventBlocked:'hV2D2',r1P0Dtai:'EA8ao',video:'GUevP'}}})
function ds(e){if(!e)return'Untitled'
let t=e.replace(/^twitter_media_\d{8}T\d{6}_\d+\./,'').replace(/^\/media\//,'').replace(/^\.\//g,'').replace(/[/\\]/g,'_')
if(t.length>40||!t){const n=e.match(/([a-zA-Z0-9_-]+)$/)
t=n?.[1]??'Image'}return t}function hs(e){if(!e)return''
switch(e){case'original':return ss.fitOriginal??''
case'fitHeight':return ss.fitHeight??''
case'fitWidth':return ss.fitWidth??''
case'fitContainer':return ss.fitContainer??''
default:return''}}function fs({media:e,index:t,isActive:n,isVisible:r=!0,onClick:i,onDownload:a,className:o='',fitMode:s}){const[l,c]=rr(!1),[u,d]=rr(!1),[f,g]=rr(!1),p=sr(null),m=sr(null),v=function(e){const t=['.mp4','.webm','.mov','.avi'],n=e.url.toLowerCase()
if(t.some((e=>n.includes(e))))return!0
if(e.filename){const n=e.filename.toLowerCase()
if(t.some((e=>n.endsWith(e))))return!0}return!(!n.includes('video.twimg.com')&&!n.includes('/video/'))}(e),y=ur((()=>{c(!0),d(!1)}),[]),_=ur((()=>{d(!0),c(!1)}),[]),w=ur((e=>{e.stopPropagation(),a?.()}),[a]),b=ur((e=>{'Enter'!==e.key&&' '!==e.key||(e.preventDefault(),i())}),[i])
ar((()=>{const e=m.current
if(!e)return
const t=new IntersectionObserver((e=>{const t=e[0]
t?.isIntersecting&&!f&&g(!0)}),{threshold:.1,rootMargin:'50px'})
return t.observe(e),()=>{t.disconnect()}}),[f])
const I=[ss.container,n&&ss.active,o].filter(Boolean).join(' '),S=[ss.image,hs(s)].filter(Boolean).join(' ')
return No('div',{ref:m,className:I,onClick:i,onKeyDown:b,role:'button',tabIndex:0,'aria-label':`View ${v?'video':'image'} ${t+1}: ${ds(e.filename)}`,children:[No('div',{className:ss.imageWrapper,children:f&&No(vn,{children:[!l&&!u&&!v&&No('div',{className:ss.placeholder,children:No('div',{className:ss.loadingSpinner})}),v?No(os,{media:e,autoPlay:!1,controls:!0,muted:!0,isActive:n,isVisible:r&&f,className:`${ss.video} ${hs(s)}`}):No('img',{ref:p,src:e.url,alt:ds(e.filename)||'Image '+(t+1),className:S,onLoad:y,onError:_,style:{opacity:l?1:0,transition:'opacity 0.3s ease'}}),u&&!v&&No('div',{className:ss.error,children:[No('span',{className:ss.errorIcon,children:'\u26a0\ufe0f'}),No('span',{className:ss.errorText,children:'Failed to load image'})]})]})}),a&&No(Fo,{variant:'ghost',size:'small',className:ss.downloadButton,onClick:w,'aria-label':'Download '+ds(e.filename),children:No('span',{className:ss.downloadIcon,children:'\u2b07\ufe0f'})})]})}var gs=d({'src/features/gallery/components/vertical-gallery-view/VerticalImageItem.tsx'(){is(),cs(),jo(),Zr(),us(),Ho(),ls=function(Component,e={}){return function(Component,e){const t={...es,...e},n=e=>{const n=function(e){const t={'data-xeg-gallery':e.type,'data-xeg-gallery-type':e.type}
for(const[n,r]of Object.entries(e.customData))t['data-xeg-'+n]=r
return e.preventClick&&(t['data-xeg-prevent-click']='true'),e.preventKeyboard&&(t['data-xeg-prevent-keyboard']='true'),e.preventTouch&&(t['data-xeg-prevent-touch']='true'),t}(t),r=(i=e.className,['xeg-gallery','xeg-gallery-'+((o=t.className)?o.split(' ')[0]:'component'),i,o].filter(Boolean).join(' '))
var i,o
const s=function(e,t){const n={}
return t.preventClick&&(n.onClick=n=>{a.debug('Gallery component click intercepted:',t.type),e.onClick&&e.onClick(n),n.stopPropagation(),n.preventDefault()}),t.preventKeyboard&&(n.onKeyDown=n=>{a.debug('Gallery component keyboard event intercepted:',t.type),e.onKeyDown&&e.onKeyDown(n),' '!==n.key&&'Enter'!==n.key||(n.stopPropagation(),n.preventDefault())}),t.preventTouch&&(n.onTouchStart=n=>{a.debug('Gallery component touch event intercepted:',t.type),e.onTouchStart&&e.onTouchStart(n),1===n.touches.length&&n.stopPropagation()}),n}(e,t),l={...e,...n,...s,className:r}
return a.debug('Rendering marked gallery component: '+t.type,n),Qo(Component,l)}
return n.displayName=`withGalleryMarker(${Component.displayName??Component.name??'Component'})`,n}(Component,{type:'item',className:'item',preventClick:!0,...e})}(fs,{className:'vertical-item',preventClick:!1,customData:{component:'vertical-image-item',role:'gallery-item'}})}})
function ps({mediaItems:e=[],onClose:t,className:n='',currentIndex:r=0,isDownloading:i=!1,onPrevious:o,onNext:s,onDownloadCurrent:l,onDownloadAll:c,showToast:u=!1,toastMessage:d='',toastType:f='info'}){const g=sr(null),p=sr(null),m=sr(null),[v,y]=rr(!1)
ar((()=>{y(e.length>0)}),[e.length]),ar((()=>{const e=()=>{document.querySelectorAll('.xeg-gallery-container video').forEach((e=>{e instanceof HTMLVideoElement&&!e.paused&&(e.pause(),e.currentTime=0,a.debug('Video stopped on gallery close'))}))}
return v||e(),()=>{e()}}),[v])
const[_,w]=rr((()=>(()=>{try{const e=localStorage.getItem('xeg-image-fit-mode')
if(e&&['original','fitWidth','fitHeight','fitContainer'].includes(e))return e}catch(e){a.debug('Failed to load saved image fit mode:',e)}return'fitWidth'})())),[b,I]=rr(!0),[S,E]=rr(!1),[x,T]=rr([]),M=ur((e=>{T((t=>t.filter((t=>t.id!==e))))}),[]),C=ur((e=>{try{localStorage.setItem('xeg-image-fit-mode',e),a.debug('Image fit mode saved: '+e)}catch(t){a.debug('Failed to save image fit mode:',t)}}),[]),k=ur((()=>{w('original'),C('original'),a.debug('VerticalGalleryView: \uc774\ubbf8\uc9c0 \ud06c\uae30\ub97c \uc6d0\ubcf8\uc73c\ub85c \uc124\uc815')}),[C]),A=ur((()=>{w('fitWidth'),C('fitWidth'),a.debug('VerticalGalleryView: \uc774\ubbf8\uc9c0 \ud06c\uae30\ub97c \uac00\ub85c \ub9de\ucda4\uc73c\ub85c \uc124\uc815')}),[C]),P=ur((()=>{w('fitHeight'),C('fitHeight'),a.debug('VerticalGalleryView: \uc774\ubbf8\uc9c0 \ud06c\uae30\ub97c \uc138\ub85c \ub9de\ucda4\uc73c\ub85c \uc124\uc815')}),[C]),U=ur((()=>{w('fitContainer'),C('fitContainer'),a.debug('VerticalGalleryView: \uc774\ubbf8\uc9c0 \ud06c\uae30\ub97c \ucc3d \ub9de\ucda4\uc73c\ub85c \uc124\uc815')}),[C]),D=ur((()=>{E(!0),I(!0),m.current&&(clearTimeout(m.current),m.current=null)}),[]),L=ur((()=>{E(!1),m.current&&clearTimeout(m.current),m.current=window.setTimeout((()=>{I(!1)}),500)}),[]),R=ur((e=>{e.clientY>100?S||(m.current&&(clearTimeout(m.current),m.current=null),I(!1)):(I(!0),m.current&&(clearTimeout(m.current),m.current=null),S||(m.current=window.setTimeout((()=>{I(!1)}),500)))}),[S])
ar((()=>{if(a.info('\ud83d\ude80 VerticalGalleryView \ucef4\ud3ec\ub10c\ud2b8 \ub9c8\uc6b4\ud2b8\ub428'),y(!0),a.info(`\ud83c\udfa8 VerticalGalleryView \ucd08\uae30\ud654: ${e.length}\uac1c \ubbf8\ub514\uc5b4 \uc544\uc774\ud15c`),e.length>0){const t=e[r]||e[0]
if(t?.url){const e=new Image
e.crossOrigin='anonymous',e.onload=()=>{bo.onGalleryOpen(e)},e.src=t.url}else bo.onGalleryOpen()
setTimeout((()=>{const e=p.current?.querySelector('.'+Jo.itemsList)
e&&r>0&&(vo.setFocusedImageIndex(r),vo.scrollToImageTop(e,r,{behavior:'smooth'}),a.debug(`Initial scroll to clicked image at index ${r} - aligned to top using GalleryScrollManager`))}),100)}const t=e=>{const t=e.detail
t?.mediaItems&&t.mediaItems.length>0&&a.info(`\ud83d\udce5 \uac24\ub7ec\ub9ac \uc5f4\uae30 \uc774\ubca4\ud2b8 \uc218\uc2e0: ${t.mediaItems.length}\uac1c \ubbf8\ub514\uc5b4`)}
return document.addEventListener('xeg:openGallery',t),()=>{a.info('\ud83e\uddf9 VerticalGalleryView \ucef4\ud3ec\ub10c\ud2b8 \uc5b8\ub9c8\uc6b4\ud2b8\ub428'),m.current&&clearTimeout(m.current),bo.onGalleryClose(),document.removeEventListener('xeg:openGallery',t)}}),[e.length,r]),ar((()=>{if(e.length>0&&r>=0&&e.length>r){const t=e[r]
if(t?.url){const e=new Image
e.crossOrigin='anonymous',e.onload=()=>{bo.onImageChange(e)},e.onerror=()=>{a.debug('Failed to load image for theme analysis:',t.url)},e.src=t.url}requestAnimationFrame((()=>{const e=p.current?.querySelector('.'+Jo.itemsList)
e&&(vo.isImageVisible(e,r)||(vo.scrollToImageTop(e,r,{behavior:'smooth'}),a.debug(`Scrolled to focused image at index ${r} - aligned to top using GalleryScrollManager`)))}))}}),[r,e])
const z=ur((()=>{y(!1),vo.reset(),a.debug('VerticalGalleryView: Closing gallery with GalleryScrollManager state reset'),t?.()}),[t])
ar((()=>{const e=e=>{switch(e.key){case'Escape':e.preventDefault(),e.stopPropagation(),z()
break
case'ArrowLeft':e.preventDefault(),e.stopPropagation(),m.current&&clearTimeout(m.current),I(!0),S||(m.current=window.setTimeout((()=>{I(!1)}),1e3)),o?.()
break
case'ArrowRight':e.preventDefault(),e.stopPropagation(),m.current&&clearTimeout(m.current),I(!0),S||(m.current=window.setTimeout((()=>{I(!1)}),1e3)),s?.()
break
case'ArrowUp':if(e.preventDefault(),e.stopPropagation(),p.current){const e=p.current.querySelector('.'+Jo.itemsList)
e&&e.scrollBy({top:-200,behavior:'smooth'})}break
case'ArrowDown':if(e.preventDefault(),e.stopPropagation(),p.current){const e=p.current.querySelector('.'+Jo.itemsList)
e&&e.scrollBy({top:200,behavior:'smooth'})}break
case'Home':if(e.preventDefault(),e.stopPropagation(),p.current){const e=p.current.querySelector('.'+Jo.itemsList)
e&&e.scrollTo({top:0,behavior:'smooth'})}break
case'End':if(e.preventDefault(),e.stopPropagation(),p.current){const e=p.current.querySelector('.'+Jo.itemsList)
e&&e.scrollTo({top:e.scrollHeight,behavior:'smooth'})}}}
return document.addEventListener('keydown',e,!0),()=>document.removeEventListener('keydown',e,!0)}),[z,o,s,S])
const N=ur((e=>{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),e.target===g.current&&(a.debug('VerticalGalleryView: \ubc30\uacbd \ud074\ub9ad\uc73c\ub85c \uac24\ub7ec\ub9ac \ub2eb\uae30'),z())}),[z]),O=ur((e=>{const t=e.target
return t.closest('[data-testid="tweetPhoto"]')?(a.debug('VerticalGalleryView: tweetPhoto \ud074\ub9ad \uac10\uc9c0 - \uac24\ub7ec\ub9ac \uc571\uc5d0\uc11c \ucc98\ub9ac'),void 0):'IMG'===t.tagName||t.classList.contains('css-9pa8cd')||t.closest('.xeg-vertical-image-item')?(a.debug('VerticalGalleryView: \ubbf8\ub514\uc5b4 \uad00\ub828 \ud074\ub9ad - \uc774\ubca4\ud2b8 \uc804\ud30c \ud5c8\uc6a9'),void 0):(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),a.debug('VerticalGalleryView: Content area click - event propagation stopped'),void 0)}),[]),$=ur((e=>{e.preventDefault(),e.stopPropagation(),['Escape','Enter',' '].includes(e.key)&&z()}),[z])
return No('div',e&&0!==e.length?{ref:g,className:`${Jo.container} ${v?Jo.visible:''} ${n}`,onClick:N,onKeyDown:$,onMouseMove:R,role:'button',tabIndex:0,'aria-label':'\uac24\ub7ec\ub9ac \ub2eb\uae30 (\ubc30\uacbd \ud074\ub9ad)','data-testid':'vertical-gallery-view',children:[' ',No('div',{className:`${Jo.toolbarWrapper} ${b?Jo.toolbarVisible:Jo.toolbarHidden}`,onMouseEnter:D,onMouseLeave:L,children:No(Ko,{currentIndex:r,totalCount:e.length,isDownloading:i,onPrevious:o??(()=>{}),onNext:s??(()=>{}),onDownloadCurrent:l??(()=>{a.warn('\ub2e4\uc6b4\ub85c\ub4dc \uae30\ub2a5\uc774 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.')}),onDownloadAll:c??(()=>{a.warn('\uc804\uccb4 \ub2e4\uc6b4\ub85c\ub4dc \uae30\ub2a5\uc774 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.')}),onClose:z,onFitOriginal:k,onFitHeight:P,onFitWidth:A,onFitContainer:U})}),No('div',{ref:p,className:Jo.content,onClick:O,onKeyDown:e=>{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()},children:No('div',{className:Jo.itemsList,role:'list',children:e.map(((e,t)=>e?No(ls,{media:e,index:t,isActive:t===r,isVisible:v,className:t===r?Jo.itemActive:'',fitMode:_,onClick:()=>{if(a.debug(`Image clicked: index ${t}, current index: ${r}`),t!==r)if(m.current&&clearTimeout(m.current),I(!0),S||(m.current=window.setTimeout((()=>{I(!1)}),1e3)),r>t&&o)for(let e=r;e>t;e--)o()
else if(t>r&&s)for(let e=r;t>e;e++)s()}},e.id??'media-'+t):null))})}),No('div',{className:Jo.toastContainer,children:x.map((e=>No(qo,{toast:e,onRemove:M},e.id)))})]}:{className:`${Jo.container} ${Jo.empty} ${n}`,onClick:N,onKeyDown:$,role:'button',tabIndex:0,'aria-label':'\uac24\ub7ec\ub9ac \ub2eb\uae30',children:No('div',{className:Jo.emptyMessage,children:[No('div',{style:{fontSize:'3rem',marginBottom:'1rem'},children:'\ud83d\udcf8'}),No('h3',{children:'\ubbf8\ub514\uc5b4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4'}),No('p',{children:'\ud45c\uc2dc\ud560 \uc774\ubbf8\uc9c0\ub098 \ub3d9\uc601\uc0c1\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.'}),No(Fo,{variant:'secondary',size:'medium',onClick:z,className:Jo.emptyButton,children:'\uac24\ub7ec\ub9ac \ub2eb\uae30'})]})})}var ms,vs=d({'src/features/gallery/components/vertical-gallery-view/VerticalGalleryView.tsx'(){It(),jo(),Yo(),ns(),Lo(),Zr(),rs(),gs(),Ho()}}),ys=d({'src/features/gallery/components/vertical-gallery-view/index.ts'(){vs()}}),_s=d({'src/features/gallery/styles/gallery-global.css'(){}}),ws={}
f(ws,{GalleryDownloadService:()=>ms})
var bs,createElement,Is,render,Ss,Es=d({'src/features/gallery/services/GalleryDownloadService.ts'(){var e
Qa(),It(),e=class e{static getInstance(){return e.instance??(e.instance=new e),e.instance}constructor(){o.defineProperty(this,'coreDownloadService',Ba.getInstance()),o.defineProperty(this,'_isInitialized',!1)}async initialize(){this._isInitialized||(a.info('GalleryDownloadService: initializing...'),await this.coreDownloadService.initialize(),this._isInitialized=!0,a.info('GalleryDownloadService: initialized'))}async destroy(){this._isInitialized&&(a.info('GalleryDownloadService: destroying...'),this.coreDownloadService.destroy(),this._isInitialized=!1,a.info('GalleryDownloadService: destroyed'))}isInitialized(){return this._isInitialized}async downloadBulk(e,t={}){const n=await this.downloadMultiple(e,t)
return{...n,downloadedCount:n.filesSuccessful}}async downloadCurrent(e){return a.info('Gallery: downloading current media'),(await this.coreDownloadService.downloadSingle(e)).success}async downloadMultiple(e,t={}){return a.info(`Gallery: downloading ${e.length} media items`),this.coreDownloadService.downloadMultiple(e,t)}async downloadAll(e,t={}){return a.info(`Gallery: downloading all ${e.length} items as ZIP`),this.coreDownloadService.downloadMultiple(e,{...t,strategy:'zip'})}async downloadSelected(e,t={}){return a.info(`Gallery: downloading ${e.length} selected items individually`),this.coreDownloadService.downloadMultiple(e,{...t,strategy:'individual'})}async downloadSingle(e){a.info('Gallery: downloading single media item')
const t=await this.coreDownloadService.downloadSingle(e)
return{success:t.success,filesProcessed:1,filesSuccessful:t.success?1:0,error:t.error}}},o.defineProperty(e,'instance',void 0),ms=e}}),xs={}
f(xs,{GalleryRenderer:()=>Ss})
var Ts,Ms,Cs,ks,As=d({'src/features/gallery/GalleryRenderer.ts'(){p(),Ro(),ys(),_s(),It(),Pa(),({effect:bs}=Sa()),({createElement:createElement,options:Is,render:render}=ba()),Is.debounceRendering=e=>{setTimeout(e,0)},Ss=class{constructor(e){o.defineProperty(this,'container',null),o.defineProperty(this,'cleanupFunctions',[]),o.defineProperty(this,'isRenderingFlag',!1),o.defineProperty(this,'galleryState',void 0),this.galleryState=e??Ao.getInstance(),this.setupStateEffects()}setupStateEffects(){const e=bs((()=>{this.galleryState.isOpen.value?this.show():this.hide()}))
this.cleanupFunctions.push(e)}show(){this.container||this.createGalleryContainer(),this.container&&(this.container.style.display='block',this.renderGalleryComponent())}hide(){if(this.container){try{render(null,this.container)}catch(e){a.debug('Preact \uc5b8\ub9c8\uc6b4\ud2b8 \uc2e4\ud328, DOM \uc9c1\uc811 \uc81c\uac70:',e)}this.container.remove(),this.container=null,this.isRenderingFlag=!1,a.debug('\uac24\ub7ec\ub9ac \ucee8\ud14c\uc774\ub108 \uc644\uc804 \uc81c\uac70\ub428')}}createGalleryContainer(){this.container=document.createElement('div'),this.container.className='xeg-gallery-container',this.container.setAttribute('data-gallery-element','root'),this.container.style.cssText='\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100vw;\n      height: 100vh;\n      z-index: 10000;\n      pointer-events: auto;\n    ',document.body.appendChild(this.container),a.debug('\uac24\ub7ec\ub9ac \ucee8\ud14c\uc774\ub108 \uc0dd\uc131 \uc644\ub8cc')}renderGalleryComponent(){if(this.container&&!this.isRenderingFlag){this.isRenderingFlag=!0
try{const e=this.galleryState.mediaItems.value,t=this.galleryState.currentIndex.value,n=this.galleryState.isLoading.value,r=this.galleryState.error.value
if(a.info(`\ud83c\udfac VerticalGalleryView \ub80c\ub354\ub9c1 \uc2dc\uc791 - ${e.length}\uac1c \ubbf8\ub514\uc5b4, \ud604\uc7ac \uc778\ub371\uc2a4: ${t}`),0===e.length)return a.warn('\ubbf8\ub514\uc5b4 \uc544\uc774\ud15c\uc774 \uc5c6\uc5b4 \uac24\ub7ec\ub9ac\ub97c \ub80c\ub354\ub9c1\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.'),this.isRenderingFlag=!1,void 0
const i=createElement(ps,{mediaItems:e,currentIndex:t,isDownloading:n,onClose:()=>this.galleryState.closeGallery(),onPrevious:()=>this.galleryState.goToPrevious(),onNext:()=>this.galleryState.goToNext(),onDownloadCurrent:()=>this.downloadCurrentMedia(),onDownloadAll:()=>this.downloadAllMedia(),className:'xeg-vertical-gallery',showToast:!!r,toastMessage:r??'',toastType:r?'error':'info'})
render(i,this.container),a.info('\u2705 VerticalGalleryView \ub80c\ub354\ub9c1 \uc644\ub8cc')}catch(e){a.error('\u274c \uac24\ub7ec\ub9ac \ub80c\ub354\ub9c1 \uc2e4\ud328:',e),a.error('\uc5d0\ub7ec \uc2a4\ud0dd:',e.stack),this.renderFallbackGallery()}finally{this.isRenderingFlag=!1}}}renderFallbackGallery(){if(!this.container)return
const e=this.galleryState.mediaItems.value,t=this.galleryState.currentIndex.value
this.container.innerHTML=`\n      <div style="\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100vw;\n        height: 100vh;\n        background: var(--xeg-gallery-background, rgba(0, 0, 0, 0.95));\n        display: flex;\n        flex-direction: column;\n        z-index: var(--xeg-z-gallery, 10000);\n      ">\n        <div style="\n          position: absolute;\n          top: var(--xeg-spacing-lg, 20px);\n          right: var(--xeg-spacing-lg, 20px);\n          z-index: var(--xeg-z-modal, 10001);\n          display: flex;\n          gap: var(--xeg-spacing-sm, 10px);\n          background: rgba(0, 0, 0, 0.7);\n          padding: var(--xeg-spacing-sm, 10px);\n          border-radius: var(--xeg-gallery-border-radius, 5px);\n        ">\n          <button id="xeg-prev-btn" style="\n            background: var(--xeg-color-primary, #1d9bf0);\n            color: white;\n            border: none;\n            padding: var(--xeg-spacing-xs, 8px) var(--xeg-spacing-md, 12px);\n            border-radius: var(--xeg-gallery-border-radius, 4px);\n            cursor: pointer;\n            transition: var(--xeg-transition-fast, 0.15s ease);\n          ">\uc774\uc804</button>\n          <span style="color: white; padding: var(--xeg-spacing-xs, 8px);">${t+1} / ${e.length}</span>\n          <button id="xeg-next-btn" style="\n            background: var(--xeg-color-primary, #1d9bf0);\n            color: white;\n            border: none;\n            padding: var(--xeg-spacing-xs, 8px) var(--xeg-spacing-md, 12px);\n            border-radius: var(--xeg-gallery-border-radius, 4px);\n            cursor: pointer;\n            transition: var(--xeg-transition-fast, 0.15s ease);\n          ">\ub2e4\uc74c</button>\n          <button id="xeg-close-btn" style="\n            background: var(--xeg-button-danger, #f91880);\n            color: white;\n            border: none;\n            padding: var(--xeg-spacing-xs, 8px) var(--xeg-spacing-md, 12px);\n            border-radius: var(--xeg-gallery-border-radius, 4px);\n            cursor: pointer;\n            transition: var(--xeg-transition-fast, 0.15s ease);\n          ">\ub2eb\uae30</button>\n        </div>\n\n        <div style="\n          flex: 1;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          overflow: auto;\n          padding: var(--xeg-spacing-lg, 20px);\n        ">\n          ${this.renderCurrentMedia(e[t])}\n        </div>\n      </div>\n    `,this.setupFallbackEvents(),a.warn('\ud3f4\ubc31 \uac24\ub7ec\ub9ac\ub85c \ub80c\ub354\ub9c1\ub428')}setupFallbackEvents(){if(!this.container)return
const e=this.container.querySelector('#xeg-prev-btn'),t=this.container.querySelector('#xeg-next-btn'),n=this.container.querySelector('#xeg-close-btn')
e?.addEventListener('click',(()=>this.galleryState.goToPrevious())),t?.addEventListener('click',(()=>this.galleryState.goToNext())),n?.addEventListener('click',(()=>this.galleryState.closeGallery()))
const r=e=>{switch(e.key){case'Escape':e.preventDefault(),this.galleryState.closeGallery()
break
case'ArrowLeft':e.preventDefault(),this.galleryState.goToPrevious()
break
case'ArrowRight':e.preventDefault(),this.galleryState.goToNext()}}
document.addEventListener('keydown',r),this.cleanupFunctions.push((()=>document.removeEventListener('keydown',r))),this.container.addEventListener('click',(e=>{e.target===this.container&&this.galleryState.closeGallery()})),this.container.tabIndex=0,this.container.focus()}renderCurrentMedia(e){return e?'image'===e.type?`\n        <img\n          src="${e.url}"\n          alt="${e.alt??''}"\n          style="\n            max-width: 90vw;\n            max-height: 80vh;\n            object-fit: contain;\n            border-radius: 8px;\n            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);\n          "\n        />\n      `:'video'===e.type?`\n        <video\n          src="${e.url}"\n          controls\n          autoplay\n          style="\n            max-width: 90vw;\n            max-height: 80vh;\n            border-radius: 8px;\n            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);\n          "\n        ></video>\n      `:'<div style="color: white;">\uc9c0\uc6d0\ub418\uc9c0 \uc54a\ub294 \ubbf8\ub514\uc5b4 \ud615\uc2dd\uc785\ub2c8\ub2e4.</div>':'<div style="color: white;">\ubbf8\ub514\uc5b4\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.</div>'}async downloadCurrentMedia(){const e=this.galleryState.currentMedia.value
if(e)try{this.galleryState.setLoading(!0)
const{GalleryDownloadService:n}=await t((async()=>{const{GalleryDownloadService:e}=await Promise.resolve().then((()=>(Es(),ws)))
return{GalleryDownloadService:e}}),void 0),r=n.getInstance()
await r.downloadCurrent(e)?a.info('\ubbf8\ub514\uc5b4 \ub2e4\uc6b4\ub85c\ub4dc \uc644\ub8cc:',e.filename):this.galleryState.setError('\ub2e4\uc6b4\ub85c\ub4dc\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.')}catch(n){a.error('\ubbf8\ub514\uc5b4 \ub2e4\uc6b4\ub85c\ub4dc \uc2e4\ud328:',n),this.galleryState.setError('\ub2e4\uc6b4\ub85c\ub4dc\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.')}finally{this.galleryState.setLoading(!1)}}async downloadAllMedia(){const e=this.galleryState.mediaItems.value
if(0!==e.length)try{this.galleryState.setLoading(!0),a.info(e.length+'\uac1c \ubbf8\ub514\uc5b4 ZIP \ub2e4\uc6b4\ub85c\ub4dc \uc2dc\uc791')
const{GalleryDownloadService:n}=await t((async()=>{const{GalleryDownloadService:e}=await Promise.resolve().then((()=>(Es(),ws)))
return{GalleryDownloadService:e}}),void 0),r=n.getInstance(),i=await r.downloadAll(e)
i.success?a.info('\uc804\uccb4 \ubbf8\ub514\uc5b4 ZIP \ub2e4\uc6b4\ub85c\ub4dc \uc644\ub8cc'):(this.galleryState.setError('ZIP \ub2e4\uc6b4\ub85c\ub4dc\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.'),a.error('ZIP \ub2e4\uc6b4\ub85c\ub4dc \uc2e4\ud328:',i.error))}catch(n){a.error('\uc804\uccb4 ZIP \ub2e4\uc6b4\ub85c\ub4dc \uc2e4\ud328:',n),this.galleryState.setError('ZIP \ub2e4\uc6b4\ub85c\ub4dc\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.')}finally{this.galleryState.setLoading(!1)}}async render(e,t){try{this.galleryState.openGallery(e,t?.startIndex??0),t?.viewMode&&(this.galleryState.viewMode.value=t.viewMode),a.info(`[GalleryRenderer] Rendered ${e.length} media items`)}catch(n){throw a.error('[GalleryRenderer] Failed to render gallery:',n),n}}close(){this.galleryState.closeGallery()}isRendering(){return this.isRenderingFlag}destroy(){if(this.isRenderingFlag=!1,this.cleanupFunctions.forEach((e=>e())),this.cleanupFunctions=[],this.container){try{render(null,this.container)}catch(e){a.debug('Preact \uc5b8\ub9c8\uc6b4\ud2b8 \uc2e4\ud328, DOM \uc9c1\uc811 \uc81c\uac70:',e)}this.container.remove(),this.container=null}a.info('Enhanced Gallery Renderer \uc815\ub9ac \uc644\ub8cc')}}}}),Ps=d({'src/core/constants/ENDPOINTS_CONSTANTS.ts'(){Ts={DISCOVERY_PATTERN:/^https:\/\/pbs\.twimg\.com\/(?:media\/[\w-]+\?format=(?:jpg|jpeg|png|webp)&name=(?:[a-z]+|\d{2,4}x\d{2,4})|[\w-]+_video_thumb\/\d+\/img\/[\w-]+(?:\?.*)?)/,GALLERY_PATTERN:/^https:\/\/pbs\.twimg\.com\/(?:media\/[\w-]+\?format=(?:jpg|jpeg|png|webp)&name=orig|[\w-]+_video_thumb\/\d+\/img\/[\w-]+(?:\?.*)?)/,MEDIA_ID_PATTERN:/\/media\/([\w-]+)\?/,VIDEO_THUMB_ID_PATTERN:/\/([\w-]+_video_thumb)\/(\d+)\/img\/([\w-]+)/,DOMAIN_PATTERN:/^https:\/\/(pbs|video)\.twimg\.com\//,SUPPORTED_DOMAINS:['pbs.twimg.com','video.twimg.com'],SUPPORTED_FORMATS:['jpg','jpeg','png','webp','gif'],VIDEO_THUMBNAIL_PATTERN:/^https:\/\/pbs\.twimg\.com\/[\w-]+_video_thumb\//,EXCLUDE_PATTERNS:{PROFILE_IMAGES:/\/profile_images\//,PROFILE_BANNERS:/\/profile_banners\//,EMOJI:/\/emoji\//,ICONS:/\/icon\//,ADS:/\/ads\//,PROFILE_SIZES:/_(?:normal|mini|bigger|reasonably_small)\./,HASHFLAGS:/\/hashflags\//,BRANDED_CONTENT:/\/branded_content\//,BUTTONS:/\/button\//,WIDGETS:/\/widget\//}},Ms={isValidDiscoveryUrl:e=>Ts.DISCOVERY_PATTERN.test(e),isValidGalleryUrl:e=>Ts.GALLERY_PATTERN.test(e),extractMediaId:e=>{const t=e.match(Ts.MEDIA_ID_PATTERN)
if(t)return t[1]
const n=e.match(Ts.VIDEO_THUMB_ID_PATTERN)
return n?`${n[1]}_${n[2]}_${n[3]}`:null},generateOriginalUrl:e=>{if(Ts.VIDEO_THUMBNAIL_PATTERN.test(e))return e
const t=Ms.extractMediaId(e)
if(!t||t.includes('_video_thumb_'))return null
const n=e.match(/[?&]format=([^&]+)/)
return`https://pbs.twimg.com/media/${t}?format=${n?.[1]??'jpg'}&name=orig`},isVideoThumbnailUrl:e=>Ts.VIDEO_THUMBNAIL_PATTERN.test(e),isExcludedUrl:e=>Object.values(Ts.EXCLUDE_PATTERNS).some((t=>t.test(e))),extractTweetId:e=>{const t=e.match(/https?:\/\/(?:twitter\.com|x\.com)\/([^/]+)\/status\/(\d+)/)
return t?.[2]??null}}}}),Us=d({'src/core/constants/twitter-endpoints.ts'(){Ps()}})
function Ds(e){if(!e||'string'!=typeof e)return null
const t=e.match(ks)
if(!t)return null
const[,n,r]=t
return n&&r&&'i'!==n?{username:n,tweetId:r,tweetUrl:e}:null}function Ls(e){for(const t of e){const e=Ds(t)
if(e)return e}return null}function Rs(e){const t=[]
try{e.querySelectorAll('a[href*="/status/"]').forEach((e=>{const n=e.href
n&&t.push(n)}))
const n=['href','data-href','data-url']
e.querySelectorAll('*').forEach((e=>{n.forEach((n=>{const r=e.getAttribute(n)
r?.includes('/status/')&&t.push(r)}))})),window.location.href.includes('/status/')&&t.push(window.location.href)}catch(n){a.debug('Failed to extract URL candidates:',n)}return[...new Set(t)]}function zs(e){if(!e||'string'!=typeof e)return null
try{let t=e
return t=t.replace(/&amp;/g,'&'),t=t.replace(/&quot;/g,'"'),t=t.replace(/&#39;/g,'\''),t=t.replace(/&lt;/g,'<'),t=t.replace(/&gt;/g,'>'),t=t.replace(/^["']|["']$/g,''),t.trim()}catch(t){return a.debug('Failed to clean URL:',t),null}}var Ns=d({'src/shared/utils/patterns/url-patterns.ts'(){It(),ks=(Cs={TWEET_URL_PATTERN:/https?:\/\/(?:(?:mobile\.|www\.)?twitter\.com|x\.com)\/([^/]+)\/status\/(\d+)/,XCOM_URL_PATTERN:/^https?:\/\/x\.com/,TWITTER_URL_PATTERN:/^https?:\/\/(?:mobile\.|www\.)?twitter\.com/,IMAGE_URL_PATTERN:/\.(jpg|jpeg|png|gif|webp|bmp|svg)(\?.*)?$/i,VIDEO_URL_PATTERN:/\.(mp4|webm|mov|avi|mkv|m4v)(\?.*)?$/i,TWITTER_IMAGE_PATTERN:/pbs\.twimg\.com\/media\/.*\.(jpg|jpeg|png|gif|webp)/i,TWITTER_VIDEO_PATTERN:/video\.twimg\.com.*\.(mp4|m3u8)/i,isXcomUrl(e){try{return!(!e||'string'!=typeof e||'null'===e||'undefined'===e)&&this.XCOM_URL_PATTERN.test(e)}catch(t){return a.error('Failed to check X.com URL:',t),!1}},isTwitterUrl(e){try{return!(!e||'string'!=typeof e||'null'===e||'undefined'===e)&&this.TWITTER_URL_PATTERN.test(e)}catch(t){return a.error('Failed to check Twitter URL:',t),!1}},extractTweetId(e){try{if(!e||'string'!=typeof e)return null
const t=e.match(this.TWEET_URL_PATTERN)
if(!t)return null
const[,,n]=t
return n||null}catch(t){return a.error('Failed to extract tweet ID:',t),null}},extractUsername(e){try{if(!e||'string'!=typeof e)return null
const t=e.match(this.TWEET_URL_PATTERN)
if(!t)return null
const[,n]=t
return n&&'i'!==n?n:null}catch(t){return a.error('Failed to extract username:',t),null}},isImageUrl(e){try{return!(!e||'string'!=typeof e)&&(e.includes('twimg.com')?this.TWITTER_IMAGE_PATTERN.test(e):this.IMAGE_URL_PATTERN.test(e))}catch(t){return a.error('Failed to check image URL:',t),!1}},isVideoUrl(e){try{return!(!e||'string'!=typeof e)&&(this.VIDEO_URL_PATTERN.test(e)||this.TWITTER_VIDEO_PATTERN.test(e))}catch(t){return a.error('Failed to check video URL:',t),!1}},isMediaUrl(e){try{return this.isImageUrl(e)||this.isVideoUrl(e)}catch(t){return a.error('Failed to check media URL:',t),!1}},getOriginalImageUrl(e){try{if(!e||'string'!=typeof e)return e
if(e.includes('pbs.twimg.com')){let t=e.replace(/:(?:small|medium|large|thumb)$/,':orig')
return t.match(/\.(jpg|jpeg|png|gif|webp)$/i)&&!t.includes(':orig')&&(t+=':orig'),t}return e}catch(t){return a.error('Failed to get original image URL:',t),e}},normalizeUrl(e){try{if(!e||'string'!=typeof e)return e
let t=e.trim()
return t=t.replace(/&amp;/g,'&'),t=t.replace(/&quot;/g,'"'),t=t.replace(/&#39;/g,'\''),t=t.replace(/&lt;/g,'<'),t=t.replace(/&gt;/g,'>'),t=t.replace(/^["']|["']$/g,''),t=t.replace(/[?&](s|t|utm_[^&]*|ref_[^&]*)=[^&]*/g,''),t=t.replace(/[?&]$/,''),t=t.replace(/#.*$/,''),t=t.replace(/\/$/,''),t}catch(t){return a.error('Failed to normalize URL:',t),e}},isValidUrl(e){try{if(!e||'string'!=typeof e)return!1
if(!e.startsWith('http://')&&!e.startsWith('https://'))return!1
const t=new URL(e)
return!(!t.hostname||0===t.hostname.length||t.port&&!/^\d+$/.test(t.port))}catch{return!1}},resolveUrl(e,t){try{if(!e||!t)return e
if(this.isValidUrl(e))return e
const n=new URL(e,t),r=n.pathname.split('/'),i=[]
for(const e of r)'..'===e?i.pop():'.'!==e&&''!==e&&i.push(e)
const a='/'+i.join('/')
return new URL(n.origin+a+n.search+n.hash).href}catch(n){return a.error('Failed to resolve URL:',{relativeUrl:e,baseUrl:t,error:n+''}),e}},findMatchingUrls(e,t){try{if(!Array.isArray(e)||!t)return[]
const n='string'==typeof t?RegExp(t,'i'):t
return e.filter((e=>{try{return n.test(e)}catch{return!1}}))}catch{return[]}}}).TWEET_URL_PATTERN}})
function Os(e){const t=[()=>function(e){const t=e.querySelectorAll('a[href*="/status/"]')
for(const n of t){const e=Ls([n.href])
if(e)return e}return null}(e),()=>function(e){const t=e.querySelector('time')
if(!t)return null
const n=t.closest('a[href*="/status/"]')
return n?Ls([n.href]):null}(e),()=>function(e){const t=['tweet','cellInnerDiv']
for(const n of t){const t=e.querySelector(`[data-testid="${n}"]`)
if(t){const e=Ls(Rs(t))
if(e)return e}}return null}(e),()=>function(e){return Ls(Rs(e))}(e),()=>function(e){const t=e.querySelectorAll('[aria-label*="@"]')
for(const n of t){const t=n.getAttribute('aria-label')
if(!t)continue
const r=t.match(/@([a-zA-Z0-9_]+)/)
if(!r)continue
const i=r[1]
if(!i)continue
const a=Ls(Rs(e))
if(a&&a.username===i)return a}return null}(e),()=>Ls([window.location.href]),()=>function(e){try{const t=(e.textContent??'').match(/@([a-zA-Z0-9_]+)/)
if(!t)return null
const n=t[1]
if(!n)return null
const r=e.closest('[data-testid*="tweet"], article')
if(!r)return null
const i=Ls(Rs(r))
if(i)return i
const a=e.querySelector('time')
if(a){const e=a.getAttribute('datetime')
if(e){const t=new Date(e).getTime(),r=''+Math.floor(t/1e3)
return{username:n,tweetId:r,tweetUrl:`https://x.com/${n}/status/${r}`}}}}catch(t){a.debug('Content analysis failed:',t)}return null}(e),()=>function(){try{const e=document.querySelectorAll('[data-reactroot] *, [data-react-checksum] *')
for(const n of e){const e=$s(n)
if(e&&'object'==typeof e&&'children'in e){const t=e,n=t.children?.props?.tweet
if(n?.user?.screen_name&&n.id_str&&'string'==typeof n.user.screen_name&&'string'==typeof n.id_str)return{username:n.user.screen_name,tweetId:n.id_str,tweetUrl:`https://x.com/${n.user.screen_name}/status/${n.id_str}`}}}const t=['__INITIAL_STATE__','__NEXT_DATA__','YTInitialData']
for(const n of t)try{const e=window[n]
if(e&&'object'==typeof e){const t=Fs(e)
if(t)return t}}catch{}}catch(e){a.debug('Global context extraction failed:',e)}return null}()]
for(const i of t)try{const e=i()
if(e&&(n=e,n?.username&&n?.tweetId&&n?.tweetUrl&&'i'!==n.username&&n.tweetId.match(/^\d+$/)))return a.debug('Tweet info extracted successfully:',e),e}catch(r){a.debug('Extraction strategy failed:',r)}var n
return a.warn('All tweet extraction strategies failed, generating synthetic info'),function(){const e=''+Math.floor(Date.now()/1e3),t='unknown_user'
return{username:t,tweetId:e,tweetUrl:`https://x.com/${t}/status/${e}`}}()}function $s(e){try{for(const t in e)if(t.startsWith('__reactInternalInstance'))return e[t]}catch{}return null}function Fs(e){try{if('object'!=typeof e||null===e)return null
const t=e,n=['tweet','status','legacy','core','user_results']
for(const e of n)if(t[e]){const n=Fs(t[e])
if(n)return n}if('screen_name'in t&&'id_str'in t&&'string'==typeof t.screen_name&&'string'==typeof t.id_str)return{username:t.screen_name,tweetId:t.id_str,tweetUrl:`https://x.com/${t.screen_name}/status/${t.id_str}`}
if('user'in t&&'id_str'in t&&'object'==typeof t.user&&null!==t.user&&'screen_name'in t.user&&'string'==typeof t.user.screen_name&&'string'==typeof t.id_str){const e=t.user
return{username:e.screen_name,tweetId:t.id_str,tweetUrl:`https://x.com/${e.screen_name}/status/${t.id_str}`}}if(Array.isArray(e))for(const r of e){const e=Fs(r)
if(e)return e}}catch{}return null}var Vs,Gs=d({'src/shared/utils/patterns/tweet-extraction.ts'(){It(),Ns()}})
function Bs(e){const t=e.src,n=e.alt
return t.includes('ext_tw_video_thumb')||t.includes('amplify_video_thumb')||t.includes('tweet_video_thumb')||'Animated Text GIF'===n||'Embedded video'===n||null!==e.closest('[data-testid="videoComponent"]')||null!==e.closest('a[aria-label*="video"]')||null!==e.closest('a[aria-label*="Video"]')||null!==e.closest('a[aria-label="Embedded video"]')}function Hs(e){return'VIDEO'===e.tagName||null!==e.closest('[data-testid="videoPlayer"]')||null!==e.closest('[data-testid="videoComponent"]')||null!==e.closest('div[role="img"][aria-label*="video"]')||null!==e.closest('div[role="img"][aria-label*="Video"]')}function js(e){return'IMG'===e.tagName?Bs(e):Hs(e)}function Ws(e){const t=RegExp(`(?<=${e}=)[^;]+`)
return document.cookie.match(t)?.[0]}function qs(e){const t=e.match(/(?<=\/status\/)\d+/)
return t?.[0]??null}function Zs(e){const t=e.querySelectorAll('a[href*="/status/"]')
for(const n of t){const e=qs(n.href)
if(e)return e}return window.location.pathname.includes('/status/')?qs(window.location.href):null}async function Ys(e,t){try{const n=(await Vs.getTweetMedias(e)).filter((e=>'video'===e.type))
if(0===n.length)return null
if(t){const e=t.replace(/\?.*$/,''),r=n.find((t=>t.preview_url.startsWith(e)))
if(r)return r}return n[0]??null}catch(n){return a.error('Failed to get video media entry:',n),null}}async function Xs(e,t){if(!Bs(e))return null
const n=Zs(t)
if(!n)return a.warn('Cannot extract tweet ID from container'),null
const r=await Ys(n,e.src)
return r?.download_url??null}var Ks=d({'src/shared/utils/patterns/video-extractor.ts'(){var e
It(),St(),o.defineProperty(e=class{static vacuumCache(){if(this.requestCache.size>16){const e=this.requestCache.keys().next().value
e&&this.requestCache.delete(e)}}static async apiRequest(e){const t=''+e
if(this.requestCache.has(t)){a.debug('Using cached API request:',t)
const e=this.requestCache.get(t)
if(e)return e}const n=new Headers({authorization:_.GUEST_AUTHORIZATION,'x-csrf-token':this.csrfToken??'','x-twitter-client-language':'en','x-twitter-active-user':'yes','content-type':'application/json'})
this.guestToken?n.append('x-guest-token',this.guestToken):n.append('x-twitter-auth-type','OAuth2Session')
try{const e=await fetch(t,{headers:n}),r=await e.json()
return e.ok&&(this.vacuumCache(),this.requestCache.set(t,r)),r}catch(r){throw a.error('Twitter API request failed:',r),r}}static createTweetJsonEndpointUrlByRestId(e){const t=window.location.hostname.replace('.com',''),n={tweetId:e,withCommunity:!1,includePromotedContent:!1,withVoice:!1},r=new URL(`https://${t}.com/i/api/graphql/${_.TWEET_RESULT_BY_REST_ID_QUERY_ID}/TweetResultByRestId`)
return r.searchParams.set('variables',JSON.stringify(n)),r.searchParams.set('features',JSON.stringify({creator_subscriptions_tweet_preview_api_enabled:!0,premium_content_api_read_enabled:!1,communities_web_enable_tweet_community_results_fetch:!0,c9s_tweet_anatomy_moderator_badge_enabled:!0,responsive_web_grok_analyze_button_fetch_trends_enabled:!1,responsive_web_grok_analyze_post_followups_enabled:!1,responsive_web_jetfuel_frame:!1,responsive_web_grok_share_attachment_enabled:!0,articles_preview_enabled:!0,responsive_web_edit_tweet_api_enabled:!0,graphql_is_translatable_rweb_tweet_is_translatable_enabled:!0,view_counts_everywhere_api_enabled:!0,longform_notetweets_consumption_enabled:!0,responsive_web_twitter_article_tweet_consumption_enabled:!0,tweet_awards_web_tipping_enabled:!1,responsive_web_grok_show_grok_translated_post:!1,responsive_web_grok_analysis_button_from_backend:!1,creator_subscriptions_quote_tweet_preview_enabled:!1,freedom_of_speech_not_reach_fetch_enabled:!0,standardized_nudges_misinfo:!0,tweet_with_visibility_results_prefer_gql_limited_actions_policy_enabled:!0,longform_notetweets_rich_text_read_enabled:!0,longform_notetweets_inline_media_enabled:!0,profile_label_improvements_pcf_label_in_post_enabled:!0,rweb_tipjar_consumption_enabled:!0,verified_phone_label_enabled:!1,responsive_web_grok_image_annotation_enabled:!0,responsive_web_graphql_skip_user_profile_image_extensions_enabled:!1,responsive_web_graphql_timeline_navigation_enabled:!0,responsive_web_enhance_cards_enabled:!1})),r.searchParams.set('fieldToggles',JSON.stringify({withArticleRichContentState:!0,withArticlePlainText:!1,withGrokAnalyze:!1,withDisallowedReplyControls:!1})),''+r}static parseTweetLegacyMedias(e,t,n){if(!t.extended_entities?.media)return[]
const r=[],i={}
let a=-1
for(const o of t.extended_entities.media){if(!o.type||!o.id_str||!o.media_url_https)continue
a++
let s=o.type
const l=o.type
let c
if(i[s]=(i[s]??-1)+1,'animated_gif'===s&&(s='video',i[s]=(i[s]??-1)+1),o.video_info?.variants)c=o.video_info.variants.filter((e=>void 0!==e.bitrate)).reduce(((e,t)=>(t.bitrate??0)>(e.bitrate??0)?t:e)).url??o.media_url_https
else if(o.media_url_https.includes('?format='))c=o.media_url_https
else{const e=o.media_url_https.split('.'),t=e[e.length-1]
c=`${e.slice(0,-1).join('.')}?format=${t}&name=orig`}const u=n.legacy?.screen_name??'',d=e.rest_id??t.id_str??'',f=i[s]??0,g=i[l]??0,p=o.media_url_https,m=o.id_str,v=o.media_key??'',y=o.expanded_url??'',_=o.display_url??'',w=o.url??'',b=(t.full_text??'').replace(' '+o.url,'')
r.push({screen_name:u,tweet_id:d,download_url:c,type:s,type_original:l,index:a,type_index:f,type_index_original:g,preview_url:p,media_id:m,media_key:v,expanded_url:y,short_expanded_url:_,short_tweet_url:w,tweet_text:b})}return r}static async getTweetMedias(e){const t=this.createTweetJsonEndpointUrlByRestId(e),n=await this.apiRequest(t)
if(!n.data?.tweetResult?.result)return[]
let r=n.data.tweetResult.result
r.tweet&&(r=r.tweet)
const i=r.core?.user_results?.result,a=r.legacy
if(!i||!a)return[]
let o=this.parseTweetLegacyMedias(r,a,i)
if(r.quoted_status_result?.result){const e=r.quoted_status_result.result,t=e.legacy,n=e.core?.user_results?.result
t&&n&&(o=[...o,...this.parseTweetLegacyMedias(e,t,n)])}return o}},'guestToken',Ws('gt')),o.defineProperty(e,'csrfToken',Ws('ct0')),o.defineProperty(e,'requestCache',new Map),Vs=e}}),Js={}
f(Js,{TWEET_URL_PATTERN:()=>ks,TwitterAPI:()=>Vs,URLPatterns:()=>Cs,cleanUrl:()=>zs,extractTweetId:()=>qs,extractTweetInfoFromUrl:()=>Ds,extractTweetInfoFromUrls:()=>Ls,extractTweetInfoUnified:()=>Os,extractTweetUrlCandidates:()=>Rs,getTweetIdFromContainer:()=>Zs,getVideoMediaEntry:()=>Ys,getVideoUrlFromThumbnail:()=>Xs,isVideoElement:()=>js,isVideoPlayer:()=>Hs,isVideoThumbnail:()=>Bs})
var Qs,el=d({'src/shared/utils/patterns/index.ts'(){Gs(),Ns(),Ks()}}),tl={}
f(tl,{EnhancedMediaExtractionService:()=>Qs})
var nl,rl=d({'src/features/media/services/EnhancedMediaExtractionService.ts'(){var e
p(),Us(),It(),ja(),el(),Gs(),e=class e{constructor(){o.defineProperty(this,'videoControlUtil',void 0),o.defineProperty(this,'videoStateManager',void 0),o.defineProperty(this,'_isInitialized',!1),this.videoControlUtil=Ca.getInstance(),this.videoStateManager=Da.getInstance(),a.debug('EnhancedMediaExtractionService: \ucd08\uae30\ud654\ub428')}static getInstance(){return e.instance??(e.instance=new e),e.instance}async initialize(){this._isInitialized||(a.info('EnhancedMediaExtractionService: initializing...'),this._isInitialized=!0,a.info('EnhancedMediaExtractionService: initialized'))}async destroy(){this._isInitialized&&(a.info('EnhancedMediaExtractionService: destroying...'),this._isInitialized=!1,a.info('EnhancedMediaExtractionService: destroyed'))}isInitialized(){return this._isInitialized}async extractMediaFromCurrentPage(){a.info('EnhancedMediaExtractionService: extracting media from current page')
const e=document.querySelectorAll('[data-testid="tweet"]'),t=[]
for(const r of e)try{const e=await this.extractAllFromContainer(r)
e.success&&e.mediaItems.length>0&&t.push(...e.mediaItems)}catch(n){a.warn('\ud2b8\uc717 \ucee8\ud14c\uc774\ub108\uc5d0\uc11c \ubbf8\ub514\uc5b4 \ucd94\ucd9c \uc2e4\ud328:',n)}return t}async extractFromClickedElement(e,t={}){const n=Date.now(),r={includeVideoElements:!0,preserveVideoState:!0,enableMutationObserver:!1,fallbackToVideoAPI:!0,...t}
try{a.debug('EnhancedMediaExtractionService: \uac1c\uc120\ub41c \ubbf8\ub514\uc5b4 \ucd94\ucd9c \uc2dc\uc791')
const t=this.findTweetContainer(e),o=t??e
if(r.preserveVideoState&&t)try{this.videoControlUtil.pauseVideosInContainer(t)}catch(i){a.debug('\ube44\ub514\uc624 \uc77c\uc2dc\uc815\uc9c0 \uc2e4\ud328 (\ud14c\uc2a4\ud2b8 \ud658\uacbd\uc77c \uc218 \uc788\uc74c):',i)}const s=await this.multiStrategyExtraction(o,e,r)
if(s.success&&s.mediaItems.length>0){a.info(`EnhancedMediaExtractionService: ${s.mediaItems.length}\uac1c \ubbf8\ub514\uc5b4 \ucd94\ucd9c \uc131\uacf5`)
const e=Date.now()-n
return s.metadata={extractedAt:Date.now(),sourceType:'unknown',...s.metadata,totalProcessingTime:e,strategyResults:s.metadata?.strategyResults??[]},s}if(r.fallbackToVideoAPI&&t){const r=await this.fallbackVideoExtraction(t,e)
if(r.success){const e=Date.now()-n
return r.metadata={...r.metadata,totalProcessingTime:e},r}}const l=await this.simpleElementExtraction(e)
if(l.success){const e=Date.now()-n
return l.metadata&&(l.metadata.totalProcessingTime=e),l}return this.createErrorResult('No valid media found with all strategies')}catch(i){return a.error('EnhancedMediaExtractionService: \ucd94\ucd9c \uc2e4\ud328:',i),this.createErrorResult(i instanceof Error?i.message:'Unknown error')}}async extractAllFromContainer(e,t={}){return this.extractFromClickedElement(e,t)}async multiStrategyExtraction(e,t,n){const r=Zs(e)
if(r){const t=this.videoStateManager.getCachedMedia(r)
if(t)return a.debug('EnhancedMediaExtractionService: \uce90\uc2dc\ub41c \ubbf8\ub514\uc5b4 \uc0ac\uc6a9',{tweetId:r,mediaCount:t.mediaItems.length}),{success:!0,mediaItems:t.mediaItems,clickedIndex:0,metadata:{extractedAt:Date.now(),sourceType:'cached',strategy:'cache-extraction',usedStrategy:'cache-extraction',strategyResults:[{strategy:'cache-extraction',success:!0,itemCount:t.mediaItems.length}]},tweetInfo:this.extractTweetInfoFromContainer(e)}}if(r&&n.fallbackToVideoAPI)try{const n=await this.extractFromTwitterAPI(e,t,r)
if(n.success&&n.mediaItems.length>0)return a.info(`API \uc6b0\uc120 \ucd94\ucd9c \uc131\uacf5: ${n.mediaItems.length}\uac1c \ubbf8\ub514\uc5b4, Twitter \uc6d0\ubcf8 \uc21c\uc11c \uc720\uc9c0`),this.videoStateManager.cacheMediaForTweet(r,e,[...n.mediaItems]),n}catch(p){a.warn('API \uc6b0\uc120 \ucd94\ucd9c \uc2e4\ud328, DOM \uae30\ubc18 \ucd94\ucd9c\ub85c \ud3f4\ubc31:',p)}const i=[],o=[],s=[]
try{const n=Date.now(),r=await this.extractFromImageElements(e,t),i=Date.now()-n
s.push({strategy:'image-extraction-enhanced',success:r.success,itemCount:r.mediaItems.length,processingTime:i}),r.success&&r.mediaItems.length>0&&(o.push({strategy:'imageElements',items:[...r.mediaItems],clickedIndex:r.clickedIndex}),a.debug(`\uc774\ubbf8\uc9c0 \ucd94\ucd9c: ${r.mediaItems.length}\uac1c \ubc1c\uacac`))}catch(p){s.push({strategy:'image-extraction-enhanced',success:!1,itemCount:0}),a.debug('\uc774\ubbf8\uc9c0 \ucd94\ucd9c \uc804\ub7b5 \uc2e4\ud328:',p)}if(n.includeVideoElements)try{const r=Date.now()
if(o.some((e=>'image-extraction-enhanced'===e.strategy&&e.items.some((e=>'video'===e.type)))))s.push({strategy:'video-extraction',success:!0,itemCount:0}),a.debug('\uc774\ubbf8\uc9c0 \ucd94\ucd9c\uc5d0\uc11c \ub3d9\uc601\uc0c1\uc774 \uc774\ubbf8 \ucc98\ub9ac\ub428, \ube44\ub514\uc624 \ucd94\ucd9c \uac74\ub108\ub700')
else{const i=await this.extractFromVideoElements(e,t,n),l=Date.now()-r
s.push({strategy:'video-extraction',success:i.success,itemCount:i.mediaItems.length,processingTime:l}),i.success&&i.mediaItems.length>0&&(o.push({strategy:'video-extraction',items:[...i.mediaItems],clickedIndex:i.clickedIndex}),a.debug(`\ube44\ub514\uc624 \ucd94\ucd9c: ${i.mediaItems.length}\uac1c \ubc1c\uacac`))}}catch(p){s.push({strategy:'video-extraction',success:!1,itemCount:0}),a.debug('\ube44\ub514\uc624 \ucd94\ucd9c \uc804\ub7b5 \uc2e4\ud328:',p)}try{const n=Date.now(),r=await this.extractFromDataAttributes(e,t),i=Date.now()-n
s.push({strategy:'data-extraction',success:r.success,itemCount:r.mediaItems.length,processingTime:i}),r.success&&r.mediaItems.length>0&&(o.push({strategy:'data-extraction',items:[...r.mediaItems]}),a.debug(`\ub370\uc774\ud130 \uc18d\uc131 \ucd94\ucd9c: ${r.mediaItems.length}\uac1c \ubc1c\uacac`))}catch(p){s.push({strategy:'data-extraction',success:!1,itemCount:0}),a.debug('\ub370\uc774\ud130 \uc18d\uc131 \ucd94\ucd9c \uc804\ub7b5 \uc2e4\ud328:',p)}try{const n=Date.now(),r=await this.extractFromBackgroundImages(e,t),i=Date.now()-n
s.push({strategy:'background-extraction',success:r.success,itemCount:r.mediaItems.length,processingTime:i}),r.success&&r.mediaItems.length>0&&(o.push({strategy:'background-extraction',items:[...r.mediaItems]}),a.debug(`\ubc30\uacbd \uc774\ubbf8\uc9c0 \ucd94\ucd9c: ${r.mediaItems.length}\uac1c \ubc1c\uacac`))}catch(p){s.push({strategy:'background-extraction',success:!1,itemCount:0}),a.debug('\ubc30\uacbd \uc774\ubbf8\uc9c0 \ucd94\ucd9c \uc804\ub7b5 \uc2e4\ud328:',p)}const l=new Set,c=new Set,u=new Set
let d=0,f='',g=0
if(o.forEach((e=>{e.items.forEach(((t,n)=>{const r=this.normalizeMediaUrl(t.url),o=t.thumbnailUrl?this.normalizeMediaUrl(t.thumbnailUrl):'',s=t.metadata,p=s?.mediaId??s?.mediaKey,m=p&&c.has(p+''),v=l.has(r),y=o&&u.has(o),_='image'===t.type&&o&&u.has(r)
m||v||y||_?a.debug('\uc911\ubcf5 \ubbf8\ub514\uc5b4 \uc81c\uac70\ub428',{url:r,mediaId:p,duplicateType:m?'mediaId':v?'url':y?'thumbnail':'video-thumbnail-as-image',itemType:t.type}):(l.add(r),o&&u.add(o),p&&c.add(p+''),i.push(t),void 0===e.clickedIndex||n!==e.clickedIndex||f||(d=g,f=e.strategy),f||(f=e.strategy),g++)}))})),i.length>0)return a.info(`DOM \uae30\ubc18 \ubbf8\ub514\uc5b4 \ucd94\ucd9c \uc131\uacf5: ${i.length}\uac1c (\uc774\ubbf8\uc9c0+\ube44\ub514\uc624), \uc8fc\uc694 \uc804\ub7b5: ${f}`),r&&this.videoStateManager.cacheMediaForTweet(r,e,i),{success:!0,mediaItems:i,clickedIndex:Math.max(0,Math.min(d,i.length-1)),metadata:{extractedAt:Date.now(),sourceType:'media',strategy:'dom-fallback-combined: '+o.map((e=>e.strategy)).join(', '),usedStrategy:f??'imageElements',strategyResults:s},tweetInfo:this.extractTweetInfoFromContainer(e)}
if(0===i.length){a.debug('DOM \uae30\ubc18 \uc804\ub7b5\ub4e4\uc774 \ubaa8\ub450 \uc2e4\ud328\ud568, \uac04\ub2e8\ud55c \ucd94\ucd9c \uc2dc\ub3c4')
const e=await this.simpleElementExtraction(t)
if(e.success){const t=[...s,...e.metadata?.strategyResults??[]]
return{...e,metadata:{...e.metadata,strategyResults:t}}}}return{success:!1,mediaItems:[],clickedIndex:0,error:'All extraction strategies failed',metadata:{extractedAt:Date.now(),sourceType:'unknown',strategy:'dom-fallback-failed',usedStrategy:'failed',strategyResults:s,totalProcessingTime:0},tweetInfo:this.extractTweetInfoFromContainer(e)}}async extractFromTwitterAPI(e,t,n){try{const r=await Vs.getTweetMedias(n)
if(0===r.length)return this.createErrorResult('No media found in Twitter API response')
const i=[],o=Os(e)
for(let e=0;r.length>e;e++){const t=this.createMediaInfoFromAPIMedia(r[e],o,e)
t&&i.push(t)}const s=await this.findClickedMediaIndexFromAPI(t,r,e)
return a.info(`API \uc6b0\uc120 \ucd94\ucd9c \uc131\uacf5: ${i.length}\uac1c \ubbf8\ub514\uc5b4, \ud074\ub9ad \uc778\ub371\uc2a4: ${s}, Twitter \uc6d0\ubcf8 \uc21c\uc11c \ubcf4\uc7a5`),{success:!0,mediaItems:i,clickedIndex:s,metadata:{extractedAt:Date.now(),sourceType:'twitter-api',strategy:'api-first-extraction'},tweetInfo:this.extractTweetInfoFromContainer(e)}}catch(r){return a.warn('API \uc6b0\uc120 \ucd94\ucd9c \uc2e4\ud328:',r),this.createErrorResult('Twitter API extraction failed')}}createMediaInfoFromAPIMedia(e,t,n){try{const r=t??{username:e.screen_name,tweetId:e.tweet_id,tweetUrl:`https://x.com/${e.screen_name}/status/${e.tweet_id}`}
return{id:`${r.tweetId}_media_${n}`,url:e.download_url,type:'video'===e.type?'video':'image',filename:'',tweetUsername:r.username,tweetId:r.tweetId,tweetUrl:r.tweetUrl,originalUrl:e.download_url,thumbnailUrl:e.preview_url,alt:`${'video'===e.type?'Video':'Image'} ${n+1}`,metadata:{mediaId:e.media_id,mediaKey:e.media_key,expandedUrl:e.expanded_url,typeOriginal:e.type_original,typeIndex:e.type_index,apiIndex:n}}}catch(r){return a.error('API \ubbf8\ub514\uc5b4 MediaInfo \uc0dd\uc131 \uc2e4\ud328:',r),null}}async findClickedMediaIndexFromAPI(e,t,n){try{if('IMG'===e.tagName){const n=this.normalizeMediaUrl(e.src)
for(let e=0;t.length>e;e++){const r=this.normalizeMediaUrl(t[e].preview_url)
if(n===r||n.includes(r))return a.debug('\ud074\ub9ad\ub41c \uc774\ubbf8\uc9c0\uc640 API \ubbf8\ub514\uc5b4 \ub9e4\ud551 \uc131\uacf5',{apiIndex:e,clickedSrc:n,apiPreview:r}),e}}const r=e.querySelector('img')
if(r){const e=this.normalizeMediaUrl(r.src)
for(let n=0;t.length>n;n++){const r=this.normalizeMediaUrl(t[n].preview_url)
if(e===r||e.includes(r))return a.debug('\ud074\ub9ad\ub41c \uc694\uc18c \ub0b4\ubd80 \uc774\ubbf8\uc9c0\uc640 API \ubbf8\ub514\uc5b4 \ub9e4\ud551 \uc131\uacf5',{apiIndex:n,insideSrc:e,apiPreview:r}),n}}const i=Array.from(n.querySelectorAll('img')).filter((e=>Ms.isValidDiscoveryUrl(e.src)))
let o=-1
if('IMG'===e.tagName){const t=this.normalizeMediaUrl(e.src)
o=i.findIndex((e=>this.normalizeMediaUrl(e.src)===t))}else{const t=e.querySelector('img')
if(t){const e=this.normalizeMediaUrl(t.src)
o=i.findIndex((t=>this.normalizeMediaUrl(t.src)===e))}}return o>=0&&t.length>o?(a.debug('DOM \uc21c\uc11c \uae30\ubc18 \ud3f4\ubc31 \ub9e4\ud551 \uc0ac\uc6a9',{domIndex:o,apiMediasCount:t.length}),o):(a.debug('\ud074\ub9ad\ub41c \uc694\uc18c \ub9e4\ud551 \uc2e4\ud328, \uccab \ubc88\uc9f8 \ubbf8\ub514\uc5b4 \uc0ac\uc6a9'),0)}catch(r){return a.warn('\ud074\ub9ad\ub41c \ubbf8\ub514\uc5b4 \uc778\ub371\uc2a4 \ucc3e\uae30 \uc2e4\ud328:',r),0}}async extractFromImageElements(e,t){const n=Array.from(e.querySelectorAll('img')).filter((e=>Ms.isValidDiscoveryUrl(e.src)))
if(0===n.length)return this.createErrorResult('No valid images found')
const r=[],i=Os(e),o=Zs(e),s=new Set
for(let u=0;n.length>u;u++){const e=n[u],t=this.normalizeMediaUrl(e.src)
if(s.has(t)){a.debug('\ub3d9\uc601\uc0c1\uc73c\ub85c \uc774\ubbf8 \ucc98\ub9ac\ub41c \uc378\ub124\uc77c \uac74\ub108\ub6f0\uae30:',t)
continue}if(Bs(e)&&o)try{const n=await Ys(o,e.src)
if(n){const e=this.createVideoMediaInfo(n,i,r.length+1)
if(e){r.push(e),s.add(t),a.debug('\ub3d9\uc601\uc0c1 \uc378\ub124\uc77c\uc744 \ub3d9\uc601\uc0c1\uc73c\ub85c \ubcc0\ud658:',t)
continue}}}catch(c){a.warn('\ub3d9\uc601\uc0c1 \uc378\ub124\uc77c \ucc98\ub9ac \uc2e4\ud328, \uc774\ubbf8\uc9c0\ub85c \ucc98\ub9ac:',c)}const l=Ms.generateOriginalUrl(e.src)
if(l&&Ms.isValidGalleryUrl(l)){const e=this.createImageMediaInfo(l,i,r.length+1)
e&&(r.push(e),a.debug('\uc77c\ubc18 \uc774\ubbf8\uc9c0\ub85c \ucc98\ub9ac:',t))}}const l=this.findClickedIndex(t,n)
return{success:r.length>0,mediaItems:r,clickedIndex:l,metadata:{extractedAt:Date.now(),sourceType:'image-elements',strategy:'image-extraction-enhanced',usedStrategy:'imageElements'},tweetInfo:this.extractTweetInfoFromContainer(e)}}async extractFromVideoElements(e,t,n){if(!n.includeVideoElements)return this.createErrorResult('Video element extraction disabled')
const r=e.querySelectorAll('video')
if(0===r.length)return this.createErrorResult('No video elements found')
const i=[],o=Os(e),s=Zs(e)
let l=0
if(s)try{const e=await Ys(s)
if(e){const t=this.createVideoMediaInfo(e,o,1)
t&&(i.push(t),a.debug('\ub3d9\uc601\uc0c1 \uc694\uc18c \uac10\uc9c0 \u2192 \uc2e4\uc81c \ub2e4\uc6b4\ub85c\ub4dc \ud30c\uc77c \uc0ac\uc6a9',{tweetId:s,downloadUrl:e.download_url}))}else a.warn('\ub3d9\uc601\uc0c1 API \ucd94\ucd9c \uc2e4\ud328, \ub3d9\uc601\uc0c1 \uc694\uc18c \uc9c1\uc811 \uc0ac\uc6a9\uc73c\ub85c \ud3f4\ubc31'),this.fallbackToVideoElements(r,o,i,t)}catch(c){a.warn('\ub3d9\uc601\uc0c1 API \ucd94\ucd9c \uc911 \uc624\ub958, \ub3d9\uc601\uc0c1 \uc694\uc18c \uc9c1\uc811 \uc0ac\uc6a9\uc73c\ub85c \ud3f4\ubc31:',c),this.fallbackToVideoElements(r,o,i,t)}else a.debug('\ud2b8\uc717 ID \uc5c6\uc74c, \ub3d9\uc601\uc0c1 \uc694\uc18c \uc9c1\uc811 \uc0ac\uc6a9'),this.fallbackToVideoElements(r,o,i,t)
return r.forEach(((e,n)=>{(e.contains(t)||t.contains(e)||e===t||t.closest('video')===e)&&(l=Math.min(n,i.length-1))})),s&&i.length>0&&(this.videoStateManager.cacheMediaForTweet(s,e,i),a.debug('\ube44\ub514\uc624 \uc694\uc18c \ucd94\ucd9c \uacb0\uacfc \uce90\uc2dc\ub428',{tweetId:s,mediaCount:i.length})),{success:i.length>0,mediaItems:i,clickedIndex:l,metadata:{extractedAt:Date.now(),sourceType:'video-elements',strategy:s?'video-api-preferred':'video-element-fallback'},tweetInfo:this.extractTweetInfoFromContainer(e)}}fallbackToVideoElements(e,t,n,r){e.forEach(((e,r)=>{const i=this.videoControlUtil.extractMediaFromVideoElement(e)
if(i){const e=this.createVideoMediaInfoFromElement(i,t,r+1)
e&&n.push(e)}}))}async extractFromDataAttributes(e,t){const n=[],r=Os(e)
return['data-expanded-url','data-media-url','data-src','data-video-url'].forEach((t=>{e.querySelectorAll(`[${t}]`).forEach(((e,i)=>{const a=e.getAttribute(t)
if(a&&Ms.isValidGalleryUrl(a)){const e=this.createImageMediaInfo(a,r,i+1)
e&&n.push(e)}}))})),{success:n.length>0,mediaItems:n,clickedIndex:0,metadata:{extractedAt:Date.now(),sourceType:'data-attributes',strategy:'data-extraction'},tweetInfo:this.extractTweetInfoFromContainer(e)}}async extractFromBackgroundImages(e,t){const n=[],r=Os(e),i=e.querySelectorAll('*')
return a.debug(`\ubc30\uacbd \uc774\ubbf8\uc9c0 \ucd94\ucd9c: ${i.length}\uac1c \uc694\uc18c \uac80\uc0ac \uc911`),a.debug('tweetContainer element:',e),a.debug('allElements:',Array.from(i)),i.forEach(((e,t)=>{a.debug(`\uc694\uc18c ${t} \uac80\uc0ac \uc911:`,e),a.debug(`\uc694\uc18c ${t} tagName:`,e.tagName),a.debug('window.getComputedStyle \ud638\ucd9c \uc2dc\ub3c4:',e)
const i=window.getComputedStyle(e).backgroundImage
if(a.debug(`\uc694\uc18c ${t}: backgroundImage = ${i}`),i&&'none'!==i){const e=i.match(/url\(["']?([^"')]+)["']?\)/)
if(e?.[1]){const i=e[1]
a.debug('\ubc30\uacbd \uc774\ubbf8\uc9c0 URL \ucd94\ucd9c: '+i)
const o=Ms.isValidDiscoveryUrl(i)
if(a.debug(`isValidDiscoveryUrl(${i}): ${o}`),o){const e=Ms.generateOriginalUrl(i)
if(a.debug(`generateOriginalUrl(${i}): ${e}`),e){const i=Ms.isValidGalleryUrl(e)
if(a.debug(`isValidGalleryUrl(${e}): ${i}`),i){const i=this.createImageMediaInfo(e,r,t+1)
i?(n.push(i),a.debug('\ubc30\uacbd \uc774\ubbf8\uc9c0 \ubbf8\ub514\uc5b4 \ucd94\uac00: '+e)):a.debug('createImageMediaInfo \uc2e4\ud328: '+e)}}}}else a.debug('URL \ucd94\ucd9c \uc2e4\ud328: '+i)}})),a.debug(`\ubc30\uacbd \uc774\ubbf8\uc9c0 \ucd94\ucd9c \uacb0\uacfc: ${n.length}\uac1c \ubbf8\ub514\uc5b4`),{success:n.length>0,mediaItems:n,clickedIndex:0,metadata:{extractedAt:Date.now(),sourceType:'background-images',strategy:'background-extraction',usedStrategy:'backgroundImage'},tweetInfo:this.extractTweetInfoFromContainer(e)}}async fallbackVideoExtraction(e,n){const r=Zs(e)
if(!r)return this.createErrorResult('Cannot extract tweet ID for video fallback')
try{const{getVideoMediaEntry:n}=await t((async()=>{const{getVideoMediaEntry:e}=await Promise.resolve().then((()=>(el(),Js)))
return{getVideoMediaEntry:e}}),void 0),i=await n(r)
if(i){const t=Os(e),n=this.createVideoMediaInfo(i,t,1)
if(n)return{success:!0,mediaItems:[n],clickedIndex:0,metadata:{extractedAt:Date.now(),sourceType:'twitter-api',strategy:'api-fallback'},tweetInfo:this.extractTweetInfoFromContainer(e)}}return this.createErrorResult('API fallback failed to extract video')}catch(i){return a.error('API \ud3f4\ubc31 \ub3d9\uc601\uc0c1 \ucd94\ucd9c \uc2e4\ud328:',i),this.createErrorResult('API fallback extraction failed')}}findTweetContainer(e){let t=e,n=0
for(;t&&10>n;){if('tweetPhoto'===t.getAttribute('data-testid')){let e=t.parentElement,n=0
for(;e&&5>n;){if('tweet'===e.getAttribute('data-testid'))return e
e=e.parentElement,n++}return t.closest('[data-testid="tweet"]')??t.closest('article')??t}t=t.parentElement,n++}const r=e.closest('[data-testid="tweet"]')
return r||(e.closest('article')||null)}findClickedIndex(e,t){if(void 0,'IMG'===e.tagName){const n=this.normalizeMediaUrl(e.src)
void 0
const r=t.findIndex(((e,t)=>(void 0,this.normalizeMediaUrl(e.src)===n)))
if(void 0,-1!==r)return void 0,r}const n=e.querySelector('img')
if(void 0,n){const e=this.normalizeMediaUrl(n.src),r=t.findIndex((t=>this.normalizeMediaUrl(t.src)===e))
if(-1!==r)return void 0,r}return void 0,0}normalizeMediaUrl(e){try{if(e.startsWith('blob:'))return e
const t=new URL(e)
let n=t.origin+t.pathname
return n=n.replace(/:small$/,'').replace(/:medium$/,'').replace(/:large$/,'').replace(/:orig$/,''),n=n.replace(/\.(jpg|jpeg|png|gif|mp4|webm|mov):.*$/,'.$1'),n}catch{return e}}createImageMediaInfo(e,t,n){try{const r=t??{username:'',tweetId:'',tweetUrl:''}
return{id:`${r.tweetId||'unknown'}_media_${n-1}`,url:e,type:'image',filename:'',tweetUsername:r.username,tweetId:r.tweetId,tweetUrl:r.tweetUrl,originalUrl:e,thumbnailUrl:e,alt:'Image '+n}}catch(r){return a.error('\uc774\ubbf8\uc9c0 MediaInfo \uc0dd\uc131 \uc2e4\ud328:',r),null}}createVideoMediaInfo(e,t,n){try{const r=t??{username:e.screen_name,tweetId:e.tweet_id,tweetUrl:`https://x.com/${e.screen_name}/status/${e.tweet_id}`}
return{id:`${r.tweetId||'unknown'}_media_${n-1}`,url:e.download_url,type:'video',filename:'',tweetUsername:r.username,tweetId:r.tweetId,tweetUrl:r.tweetUrl,originalUrl:e.download_url,thumbnailUrl:e.preview_url,alt:'Video '+n,metadata:{mediaId:e.media_id,mediaKey:e.media_key,expandedUrl:e.expanded_url,typeOriginal:e.type_original,typeIndex:e.type_index}}}catch(r){return a.error('\ube44\ub514\uc624 MediaInfo \uc0dd\uc131 \uc2e4\ud328:',r),null}}createVideoMediaInfoFromElement(e,t,n){try{const r=t??{username:'',tweetId:'',tweetUrl:''}
return{id:`${r.tweetId||'unknown'}_media_${n-1}`,url:e.url,type:'video',filename:'',tweetUsername:r.username,tweetId:r.tweetId,tweetUrl:r.tweetUrl,originalUrl:e.url,thumbnailUrl:e.thumbnailUrl??e.url,alt:'Video '+n}}catch(r){return a.error('\ube44\ub514\uc624 \uc694\uc18c MediaInfo \uc0dd\uc131 \uc2e4\ud328:',r),null}}createErrorResult(e){return{success:!1,mediaItems:[],clickedIndex:0,error:e,metadata:{extractedAt:Date.now(),sourceType:'unknown'},tweetInfo:null}}extractTweetInfoFromContainer(e){try{return Os(e)}catch(t){return a.debug('\ud2b8\uc717 \uc815\ubcf4 \ucd94\ucd9c \uc2e4\ud328:',t),null}}async simpleElementExtraction(e){a.info('simpleElementExtraction \uba54\uc11c\ub4dc \ud638\ucd9c\ub428')
try{const t=[],n=0
if('IMG'===e.tagName){const n=e
if(n.src&&this.isValidImageUrl(n.src)){const e=this.createSimpleMediaInfo(n.src,'image',0)
e&&t.push(e)}}else if('VIDEO'===e.tagName){const n=e
if(n.src&&this.isValidVideoUrl(n.src)){const e=this.createSimpleMediaInfo(n.src,'video',0)
e&&t.push(e)}}else{const n=e.querySelectorAll('img'),r=e.querySelectorAll('video')
let i=0
for(const e of n)if(e.src&&this.isValidImageUrl(e.src)){const n=this.createSimpleMediaInfo(e.src,'image',i)
n&&(t.push(n),i++)}for(const e of r)if(e.src&&this.isValidVideoUrl(e.src)){const n=this.createSimpleMediaInfo(e.src,'video',i)
n&&(t.push(n),i++)}}return t.length>0?{success:!0,mediaItems:t,clickedIndex:n,metadata:{extractedAt:Date.now(),sourceType:'simple-extraction',strategy:'simple-extraction',usedStrategy:'imageElements',totalProcessingTime:0,strategyResults:[{strategy:'simple-extraction',success:!0,itemCount:t.length,processingTime:0}]},tweetInfo:this.extractTweetInfoFromContainer(e)}:this.createErrorResult('No media found in simple extraction')}catch(t){return a.error('\uac04\ub2e8\ud55c \uc694\uc18c \ucd94\ucd9c \uc2e4\ud328:',t),this.createErrorResult('Simple extraction failed')}}createSimpleMediaInfo(e,t,n){try{return{id:'simple_media_'+n,url:e,type:t,filename:'',tweetUsername:'',tweetId:'',tweetUrl:'',originalUrl:e,thumbnailUrl:'video'===t?void 0:e,alt:`${'video'===t?'Video':'Image'} ${n+1}`,metadata:{extractionMethod:'simple',simpleIndex:n}}}catch(r){return a.error('\uac04\ub2e8\ud55c MediaInfo \uc0dd\uc131 \uc2e4\ud328:',r),null}}isValidImageUrl(e){return!!e&&(!(!e.startsWith('data:')&&!e.startsWith('blob:'))||e.includes('twimg.com')||e.includes('pbs.twimg.com'))}isValidVideoUrl(e){return!!e&&(!(!e.startsWith('data:')&&!e.startsWith('blob:'))||e.includes('video.twimg.com')||e.includes('ext_tw_video'))}},o.defineProperty(e,'instance',void 0),Qs=e}})
async function il(e){return Ja.get(e)}var al=d({'src/core/services/ServiceRegistry.ts'(){p(),ro(),nl={BULK_DOWNLOAD:'core.bulkDownload',GALLERY_RENDERER:'gallery.renderer',GALLERY_DOWNLOAD:'gallery.download',MEDIA_EXTRACTION:'media.extraction',MEDIA_FILENAME:'media.filename',PAGE_SCROLL_LOCK:'scroll.pageLock',GALLERY_SCROLL:'scroll.gallery',AUTO_THEME:'theme.auto',VIDEO_STATE:'video.state',VIDEO_CONTROL:'video.control'}}})
It(),ro(),al()
var ol,sl,ll=(e=class e{constructor(){o.defineProperty(this,'serviceManager',void 0),o.defineProperty(this,'isInitialized',!1),o.defineProperty(this,'isDestroyed',!1),this.serviceManager=Ka.getInstance()}static getInstance(){return this.instance??(this.instance=new e),this.instance}async initialize(){if(this.isInitialized)return a.debug('[IntegratedServiceManager] Already initialized'),void 0
if(this.isDestroyed)throw Error('[IntegratedServiceManager] Cannot initialize destroyed instance')
try{a.info('[IntegratedServiceManager] Initializing service manager...'),Ja.register(nl.BULK_DOWNLOAD,{factory:async()=>{const{BulkDownloadService:e}=await t((async()=>{const{BulkDownloadService:e}=await Promise.resolve().then((()=>(Qa(),Wa)))
return{BulkDownloadService:e}}),void 0)
return e.getInstance()},singleton:!0,lazy:!0}),Ja.register(nl.GALLERY_RENDERER,{factory:async()=>{const{GalleryRenderer:e}=await t((async()=>{const{GalleryRenderer:e}=await Promise.resolve().then((()=>(As(),xs)))
return{GalleryRenderer:e}}),void 0)
return new e},singleton:!0,lazy:!0}),Ja.register(nl.GALLERY_DOWNLOAD,{factory:async()=>{const{GalleryDownloadService:e}=await t((async()=>{const{GalleryDownloadService:e}=await Promise.resolve().then((()=>(Es(),ws)))
return{GalleryDownloadService:e}}),void 0)
return e.getInstance()},singleton:!0,lazy:!0}),Ja.register(nl.MEDIA_EXTRACTION,{factory:async()=>{const{EnhancedMediaExtractionService:e}=await t((async()=>{const{EnhancedMediaExtractionService:e}=await Promise.resolve().then((()=>(rl(),tl)))
return{EnhancedMediaExtractionService:e}}),void 0)
return e.getInstance()},singleton:!0,lazy:!0}),Ja.register(nl.MEDIA_FILENAME,{factory:async()=>{const{MediaFilenameService:e}=await t((async()=>{const{MediaFilenameService:e}=await Promise.resolve().then((()=>(Ha(),Oa)))
return{MediaFilenameService:e}}),void 0)
return e.getInstance()},singleton:!0,lazy:!0}),Ja.register(nl.PAGE_SCROLL_LOCK,{factory:async()=>{const{PageScrollLockManager:e}=await t((async()=>{const{PageScrollLockManager:e}=await Promise.resolve().then((()=>(yo(),ao)))
return{PageScrollLockManager:e}}),void 0)
return e.getInstance()},singleton:!0,lazy:!0}),Ja.register(nl.GALLERY_SCROLL,{factory:async()=>{const{GalleryScrollManager:e}=await t((async()=>{const{GalleryScrollManager:e}=await Promise.resolve().then((()=>(Io(),_o)))
return{GalleryScrollManager:e}}),void 0)
return e.getInstance()},singleton:!0,lazy:!0}),Ja.register(nl.AUTO_THEME,{factory:async()=>{const{AutoThemeController:e}=await t((async()=>{const{AutoThemeController:e}=await Promise.resolve().then((()=>(Do(),xo)))
return{AutoThemeController:e}}),void 0)
return e.getInstance()},singleton:!0,lazy:!0}),Ja.register(nl.VIDEO_STATE,{factory:async()=>{const{VideoStateManager:e}=await t((async()=>{const{VideoStateManager:e}=await Promise.resolve().then((()=>(Na(),Ra)))
return{VideoStateManager:e}}),void 0)
return e.getInstance()},singleton:!0,lazy:!0}),Ja.register(nl.VIDEO_CONTROL,{factory:async()=>{const{VideoControlUtil:e}=await t((async()=>{const{VideoControlUtil:e}=await Promise.resolve().then((()=>(La(),Ua)))
return{VideoControlUtil:e}}),void 0)
return e.getInstance()},singleton:!0,lazy:!0})
const e=this.serviceManager.getRegisteredServices()
a.info(`[IntegratedServiceManager] Registered ${e.length} services`),this.isInitialized=!0,a.info('[IntegratedServiceManager] Initialization completed')}catch(e){throw a.error('[IntegratedServiceManager] Initialization failed:',e),e}}getService(e){if(!this.isInitialized)throw Error('[IntegratedServiceManager] Manager not initialized. Call initialize() first.')
if(this.isDestroyed)throw Error('[IntegratedServiceManager] Manager has been destroyed')
try{return this.serviceManager.getService(e)}catch(t){throw a.error(`[IntegratedServiceManager] Failed to get service '${e}':`,t),t}}async getServiceAsync(e){if(!this.isInitialized)throw Error('[IntegratedServiceManager] Manager not initialized. Call initialize() first.')
if(this.isDestroyed)throw Error('[IntegratedServiceManager] Manager has been destroyed')
try{return await this.serviceManager.get(e)}catch(t){throw a.error(`[IntegratedServiceManager] Failed to get service async '${e}':`,t),t}}async destroy(){if(this.isDestroyed)return a.debug('[IntegratedServiceManager] Already destroyed'),void 0
try{a.info('[IntegratedServiceManager] Destroying service manager...'),this.serviceManager.cleanup(),this.isInitialized=!1,this.isDestroyed=!0,e.instance=null,a.info('[IntegratedServiceManager] Destruction completed')}catch(t){throw a.error('[IntegratedServiceManager] Destruction failed:',t),t}}isReady(){return this.isInitialized&&!this.isDestroyed}getRegisteredServices(){return this.serviceManager.getRegisteredServices()}getLoadedServices(){return this.serviceManager.getLoadedServices()}getDiagnostics(){const e=this.serviceManager.getDiagnostics()
return{registeredServices:e.registeredServices,initializedServices:e.initializedServices,memoryUsage:e.memoryUsage??{services:0,configs:0,initialized:0,loading:0}}}async initializeBatch(e){if(!this.isInitialized)throw Error('[IntegratedServiceManager] Manager not initialized. Call initialize() first.')
try{await this.serviceManager.initializeBatch(e)}catch(t){throw a.error('[IntegratedServiceManager] Batch initialization failed:',t),t}}hasService(e){return this.serviceManager.getRegisteredServices().includes(e)}isServiceInitialized(e){return this.serviceManager.getLoadedServices().includes(e)}},o.defineProperty(e,'instance',null),e),cl=d({'src/core/factories/gallery.factory.ts'(){var e
p(),It(),al(),o.defineProperty(e=class{static async createGalleryRenderer(){return a.warn('[GalleryFactory] DEPRECATED: Use ServiceManager instead'),il(nl.GALLERY_RENDERER)}static async createMediaExtractor(){return a.warn('[GalleryFactory] DEPRECATED: Use ServiceManager instead'),il(nl.MEDIA_EXTRACTION)}static async initializeAll(){a.warn('[GalleryFactory] DEPRECATED: Use ServiceManager instead')
try{const{serviceManager:e}=await t((async()=>{const{serviceManager:e}=await Promise.resolve().then((()=>(ro(),eo)))
return{serviceManager:e}}),void 0)
return await e.initializeAll(),!0}catch(e){return a.error('[GalleryFactory] Failed to initialize services:',e),!1}}static cleanup(){a.warn('[GalleryFactory] DEPRECATED: Use ServiceManager instead'),this.galleryRenderer=null,this.mediaExtractor=null,this.isInitialized=!1}static isReady(){return a.warn('[GalleryFactory] DEPRECATED: Use ServiceManager instead'),this.isInitialized}},'galleryRenderer',null),o.defineProperty(e,'mediaExtractor',null),o.defineProperty(e,'isInitialized',!1),ol=e}}),ul={}
f(ul,{GalleryApp:()=>sl})
var dl=d({'src/features/app/GalleryApp.ts'(){Us(),cl(),Ro(),rl(),It(),La(),Na(),sl=class{constructor(){o.defineProperty(this,'galleryRenderer',null),o.defineProperty(this,'mediaExtractor',null),o.defineProperty(this,'galleryState',null),o.defineProperty(this,'videoControlUtil',null),o.defineProperty(this,'videoStateManager',null),o.defineProperty(this,'isInitialized',!1),o.defineProperty(this,'clickHandler',null),o.defineProperty(this,'keyHandler',null),o.defineProperty(this,'galleryTriggerHandler',null)}async initialize(){try{a.info('GalleryApp: \ud1b5\ud569 \ubaa8\ub4dc\ub85c \ucd08\uae30\ud654 \uc2dc\uc791'),await this.initializeServices(),this.setupTweetPhotoClickListener(),this.setupVideoStateManagement(),this.isInitialized=!0,a.info('GalleryApp: \ucd08\uae30\ud654 \uc644\ub8cc - tweetPhoto \ud074\ub9ad \ub300\uae30 \uc911'),a.debug('GalleryApp: \uc774\ubca4\ud2b8 \ub9ac\uc2a4\ub108 \ud65c\uc131\ud654 \uc0c1\ud0dc:',{clickHandlerActive:!!this.clickHandler,clickHandlerType:typeof this.clickHandler})}catch(e){throw a.error('GalleryApp: \ucd08\uae30\ud654 \uc2e4\ud328:',e),e}}async initializeServices(){try{a.debug('GalleryApp: \uc11c\ube44\uc2a4 \ucd08\uae30\ud654 \uc911...'),this.galleryRenderer=await ol.createGalleryRenderer(),this.mediaExtractor=Qs.getInstance(),this.galleryState=Ao.getInstance(),this.videoControlUtil=Ca.getInstance(),this.videoStateManager=Da.getInstance(),a.debug('GalleryApp: \uc11c\ube44\uc2a4 \ucd08\uae30\ud654 \uc644\ub8cc')}catch(e){throw a.error('GalleryApp: \uc11c\ube44\uc2a4 \ucd08\uae30\ud654 \uc2e4\ud328:',e),e}}shouldBlockGalleryTrigger(e){if(e.closest('[data-testid="playButton"]'))return a.debug('GalleryApp: \ud50c\ub808\uc774 \ubc84\ud2bc \ud074\ub9ad \uac10\uc9c0 - \uae30\ubcf8 \ub3d9\uc791 \ud5c8\uc6a9'),!0
if(e.closest('[data-testid="playButton"]')&&('svg'===e.tagName||'circle'===e.tagName||'path'===e.tagName))return a.debug('GalleryApp: \ud50c\ub808\uc774 \ubc84\ud2bc \ub0b4 SVG \uc694\uc18c \ud074\ub9ad \uac10\uc9c0 - \uae30\ubcf8 \ub3d9\uc791 \ud5c8\uc6a9'),!0
if(e.closest('button[aria-label*="\ub2e4\uc2dc\ubcf4\uae30"], button[aria-label*="\uc77c\uc2dc\uc815\uc9c0"], button[aria-label*="\uc7ac\uc0dd"], button[aria-label*="Replay"], button[aria-label*="Pause"], button[aria-label*="Play"]'))return a.debug('GalleryApp: \ub3d9\uc601\uc0c1 \uc81c\uc5b4 \ubc84\ud2bc \ud074\ub9ad \uac10\uc9c0 - \uae30\ubcf8 \ub3d9\uc791 \ud5c8\uc6a9'),!0
const t=e.closest('button')?.getAttribute('aria-label')
return!(!t||!(t.includes('\ub2e4\uc2dc\ubcf4\uae30')||t.includes('\uc77c\uc2dc\uc815\uc9c0')||t.includes('\uc7ac\uc0dd')||t.includes('Replay')||t.includes('Pause')||t.includes('Play'))||(a.debug('GalleryApp: \ub3d9\uc601\uc0c1 \uc81c\uc5b4 \ubc84\ud2bc \ub0b4\ubd80 \uc694\uc18c \ud074\ub9ad \uac10\uc9c0 - \uae30\ubcf8 \ub3d9\uc791 \ud5c8\uc6a9'),0))}setupTweetPhotoClickListener(){this.clickHandler=e=>{if(0!==e.button)return
const t=e.target
if(t.closest('[data-testid="tweetPhoto"]')){if(a.debug('GalleryApp: tweetPhoto \ub0b4\ubd80 \ud074\ub9ad \uac10\uc9c0',{tagName:t.tagName,className:t.className,containerFound:!0}),this.shouldBlockGalleryTrigger(t))return a.info('GalleryApp: \uac24\ub7ec\ub9ac \ucc28\ub2e8 \uc694\uc18c \ud074\ub9ad - \uae30\ubcf8 \ub3d9\uc791 \ud5c8\uc6a9'),void 0
e.preventDefault(),e.stopPropagation(),a.info('GalleryApp: tweetPhoto \ub0b4\ubd80 \uc694\uc18c \ud074\ub9ad - \uac24\ub7ec\ub9ac \uc2e4\ud589',{tagName:t.tagName,isImage:'IMG'===t.tagName,isVideoThumbnail:'IMG'===t.tagName&&Ms.isVideoThumbnailUrl(t.src)}),this.handleTweetPhotoClick(e)}},document.addEventListener('click',this.clickHandler,!0),a.debug('GalleryApp: tweetPhoto \ud074\ub9ad \ub9ac\uc2a4\ub108 \ub4f1\ub85d \uc644\ub8cc')}async handleTweetPhotoClick(e){try{this.isInitialized||await this.loadGalleryComponents(),this.galleryState&&this.mediaExtractor&&await this.extractAndOpenGallery(e)}catch(t){a.error('GalleryApp: tweetPhoto \ud074\ub9ad \ucc98\ub9ac \uc2e4\ud328:',t)}}async loadGalleryComponents(){a.info('GalleryApp: \uac24\ub7ec\ub9ac \ucef4\ud3ec\ub10c\ud2b8 \uc9c0\uc5f0 \ub85c\ub529 \uc2dc\uc791'),this.galleryState&&this.galleryRenderer||await this.initializeServices(),this.setupGalleryKeyboardEvents(),a.info('GalleryApp: \uac24\ub7ec\ub9ac \ucef4\ud3ec\ub10c\ud2b8 \ub85c\ub529 \uc644\ub8cc')}setupVideoStateManagement(){this.videoStateManager&&(this.galleryTriggerHandler=e=>{const t=e,{mediaItems:n,clickedIndex:r}=t.detail
this.galleryState&&n.length>0&&(a.info('GalleryApp: \ucee4\uc2a4\ud140 \ud2b8\ub9ac\uac70\ub85c \uac24\ub7ec\ub9ac \uc5f4\uae30',{mediaCount:n.length,clickedIndex:r}),this.galleryState.openGallery(n,r))},document.addEventListener('xeg-gallery-trigger',this.galleryTriggerHandler),this.videoStateManager.startDOMObserver(((e,t)=>{a.debug('GalleryApp: \ub3d9\uc601\uc0c1 \uc7ac\uc0dd \uac10\uc9c0, \ud2b8\ub9ac\uac70 \uc0dd\uc131 \uc900\ube44',{tweetId:e})
const n=t.closest('[data-testid="tweet"]')
n&&this.videoStateManager&&setTimeout((()=>{this.videoStateManager&&this.videoStateManager.createGalleryTrigger(n,e,((e,t)=>{this.galleryState&&this.galleryState.openGallery(e,t)}))}),200)})),a.debug('GalleryApp: \ub3d9\uc601\uc0c1 \uc0c1\ud0dc \uad00\ub9ac \uc124\uc815 \uc644\ub8cc'))}extractTweetIdFromContainer(e){const t=e.querySelectorAll('a[href*="/status/"]')
for(const n of t){const e=n.href.match(/\/status\/(\d+)/)
if(e?.[1])return e[1]}return null}setupGalleryKeyboardEvents(){this.keyHandler=e=>{if(this.galleryState?.isOpen.value)switch(e.key){case'Escape':this.galleryState.closeGallery(),e.preventDefault()
break
case'ArrowLeft':this.galleryState.goToPrevious(),e.preventDefault()
break
case'ArrowRight':this.galleryState.goToNext(),e.preventDefault()
break
case'Home':this.galleryState.goToFirst(),e.preventDefault()
break
case'End':this.galleryState.goToLast(),e.preventDefault()}},document.addEventListener('keydown',this.keyHandler),a.debug('GalleryApp: \uac24\ub7ec\ub9ac \ud0a4\ubcf4\ub4dc \uc774\ubca4\ud2b8 \uc124\uc815 \uc644\ub8cc')}async extractAndOpenGallery(e){const t=e.target
try{if(a.debug('GalleryApp: \uac1c\uc120\ub41c \ubbf8\ub514\uc5b4 \ucd94\ucd9c \uc2dc\uc791'),!this.mediaExtractor)return a.error('GalleryApp: MediaExtractor\uac00 \ucd08\uae30\ud654\ub418\uc9c0 \uc54a\uc74c'),void 0
const e=this.mediaExtractor,n=await e.extractFromClickedElement(t,{includeVideoElements:!0,preserveVideoState:!0,enableMutationObserver:!1,fallbackToVideoAPI:!0})
if(n.success&&n.mediaItems.length>0){const e=n.clickedIndex??0,r=t.closest('[data-testid="tweet"]')
if(r&&this.videoStateManager){const e=this.extractTweetIdFromContainer(r)
e&&(this.videoStateManager.cacheMediaForTweet(e,r,[...n.mediaItems]),n.mediaItems.some((e=>'video'===e.type))&&a.debug('GalleryApp: \ub3d9\uc601\uc0c1 \ud3ec\ud568 \ubbf8\ub514\uc5b4 - DOM \ubcc0\ud654 \uac10\uc9c0 \uc900\ube44',{tweetId:e}))}a.info(`GalleryApp: \uac24\ub7ec\ub9ac \uc5f4\uae30 - ${n.mediaItems.length}\uac1c \ubbf8\ub514\uc5b4, \uc2dc\uc791 \uc778\ub371\uc2a4: ${e}`,{strategy:n.metadata?.strategy,sourceType:n.metadata?.sourceType}),this.galleryState&&this.galleryState.openGallery(n.mediaItems,e)}else a.warn('GalleryApp: \uc720\ud6a8\ud55c \ubbf8\ub514\uc5b4\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc74c:',{error:n.error,mediaCount:n.mediaItems.length,strategy:n.metadata?.strategy})}catch(n){a.error('GalleryApp: \ubbf8\ub514\uc5b4 \ucd94\ucd9c \ubc0f \uac24\ub7ec\ub9ac \uc5f4\uae30 \uc2e4\ud328:',n)}}async cleanup(){a.info('GalleryApp: \uc815\ub9ac \uc2dc\uc791'),this.clickHandler&&(document.removeEventListener('click',this.clickHandler,!0),this.clickHandler=null),this.keyHandler&&(document.removeEventListener('keydown',this.keyHandler),this.keyHandler=null),this.galleryTriggerHandler&&(document.removeEventListener('xeg-gallery-trigger',this.galleryTriggerHandler),this.galleryTriggerHandler=null),this.galleryState?.isOpen.value&&this.galleryState.closeGallery(),this.videoControlUtil&&(this.videoControlUtil.cleanup(),this.videoControlUtil=null),this.videoStateManager&&(this.videoStateManager.cleanup(),this.videoStateManager=null),this.galleryRenderer&&(this.galleryRenderer.destroy(),this.galleryRenderer=null),this.galleryState=null,this.mediaExtractor=null,this.isInitialized=!1,a.info('GalleryApp: \uc815\ub9ac \uc644\ub8cc')}}}})
p(),It()
const hl=new class{constructor(){o.defineProperty(this,'isRunning',!1),o.defineProperty(this,'isInitialized',!1),o.defineProperty(this,'integratedServiceManager',void 0),this.integratedServiceManager=ll.getInstance()}async start(){if(!this.isRunning)try{a.info('\ud83d\ude80 X.com Enhanced Gallery v1.0.0 \uc2dc\uc791')
const e=performance.now()
await this.initializeServiceRegistry(),await this.initializeEssentialServices(),await this.initializeGalleryApp(),this.isRunning=!0
const t=performance.now()
a.info(`\u2705 \uac24\ub7ec\ub9ac \uc571 \ucd08\uae30\ud654 \uc644\ub8cc (${(t-e).toFixed(2)}ms)`)}catch(e){throw a.error('\u274c \uac24\ub7ec\ub9ac \uc571 \uc2dc\uc791 \uc2e4\ud328:',e),await this.cleanup(),e}}async initializeServiceRegistry(){if(!this.isInitialized)try{await this.integratedServiceManager.initialize()
const e=this.integratedServiceManager.getRegisteredServices()
a.debug(`\ud83d\udccb IntegratedServiceManager \ucd08\uae30\ud654 \uc644\ub8cc: ${e.length}\uac1c \uc11c\ube44\uc2a4`),this.isInitialized=!0}catch(e){throw a.error('\u274c IntegratedServiceManager \ucd08\uae30\ud654 \uc2e4\ud328:',e),e}}async initializeEssentialServices(){const e=[nl.AUTO_THEME,nl.PAGE_SCROLL_LOCK]
try{await this.integratedServiceManager.initializeBatch(e),(await this.integratedServiceManager.getServiceAsync(nl.AUTO_THEME)).updateConfig({enabled:!0,timeBasedTheme:!0,contentBasedTheme:!0,debug:!1}),a.info('\ud83c\udfa8 \ud544\uc218 \uc11c\ube44\uc2a4 \ucd08\uae30\ud654 \uc644\ub8cc')}catch(t){throw a.error('\u274c \ud544\uc218 \uc11c\ube44\uc2a4 \ucd08\uae30\ud654 \uc2e4\ud328:',t),t}}async initializeGalleryApp(){const{GalleryApp:e}=await t((async()=>{const{GalleryApp:e}=await Promise.resolve().then((()=>(dl(),ul)))
return{GalleryApp:e}}),void 0),n=new e
await n.initialize(),globalThis.__XEG_APP__=n,a.info('\u2705 \uac24\ub7ec\ub9ac \uc571 \ucef4\ud3ec\ub10c\ud2b8 \ucd08\uae30\ud654 \uc644\ub8cc')}async cleanup(){try{const e=globalThis.__XEG_APP__
e&&'object'==typeof e&&'cleanup'in e&&'function'==typeof e.cleanup&&(e.cleanup(),delete globalThis.__XEG_APP__),await this.integratedServiceManager.destroy(),this.isRunning=!1,this.isInitialized=!1,a.info('\ud83e\uddf9 \uac24\ub7ec\ub9ac \uc571 \uc815\ub9ac \uc644\ub8cc'),'function'==typeof globalThis.gc&&globalThis.gc()}catch(e){a.warn('\uc815\ub9ac \uc911 \uc624\ub958:',e)}}isAppRunning(){return this.isRunning}getServiceStatus(){return this.integratedServiceManager.getLoadedServices()}}
window.addEventListener('beforeunload',(()=>{hl.cleanup().catch((e=>a.error('\uc815\ub9ac \uc911 \uc624\ub958:',e)))})),window.addEventListener('pagehide',(()=>{hl.cleanup().catch((e=>a.error('\ud398\uc774\uc9c0 \uc228\uae40 \uc911 \uc815\ub9ac \uc624\ub958:',e)))})),'loading'===document.readyState?document.addEventListener('DOMContentLoaded',(()=>{hl.start().catch((e=>a.error('\uac24\ub7ec\ub9ac \uc571 \uc790\ub3d9 \uc2dc\uc791 \uc2e4\ud328:',e)))})):hl.start().catch((e=>a.error('\uac24\ub7ec\ub9ac \uc571 \uc790\ub3d9 \uc2dc\uc791 \uc2e4\ud328:',e)))}()

  } catch (error) {
    console.error('[XEG] Initialization failed:', error);
  }
})();