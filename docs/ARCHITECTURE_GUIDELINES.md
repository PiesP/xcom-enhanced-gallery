# ğŸ—ï¸ X.com Enhanced Gallery - Architecture Guidelines

> **3-Layer Clean Architecture ê¸°ë°˜ ì‹œìŠ¤í…œ ì„¤ê³„ ê°€ì´ë“œ**
>
> **PC í™˜ê²½ ì „ìš© ì„¤ê³„ ì² í•™ ë° ì•„í‚¤í…ì²˜ ì›ì¹™**

## ğŸ“‹ ëª©ì°¨

1. [ì•„í‚¤í…ì²˜ ì² í•™](#ì•„í‚¤í…ì²˜-ì² í•™)
2. [3-Layer Architecture ì„¤ê³„](#3-layer-architecture-ì„¤ê³„)
3. [ë ˆì´ì–´ë³„ ì„¤ê³„ ì›ì¹™](#ë ˆì´ì–´ë³„-ì„¤ê³„-ì›ì¹™)
4. [PC í™˜ê²½ ìµœì í™” ì„¤ê³„](#pc-í™˜ê²½-ìµœì í™”-ì„¤ê³„)
5. [ê¸°ìˆ  ìŠ¤íƒ ì•„í‚¤í…ì²˜](#ê¸°ìˆ -ìŠ¤íƒ-ì•„í‚¤í…ì²˜)
6. [ì„±ëŠ¥ ë° ë²ˆë“¤ ìµœì í™”](#ì„±ëŠ¥-ë°-ë²ˆë“¤-ìµœì í™”)
7. [í™•ì¥ì„± ì„¤ê³„](#í™•ì¥ì„±-ì„¤ê³„)

---

## ğŸ¯ ì•„í‚¤í…ì²˜ ì² í•™

### í•µì‹¬ ì„¤ê³„ ì›ì¹™

1. **ë‹¨ìˆœì„± ìš°ì„  (Simplicity First)**
   - ë¶ˆí•„ìš”í•œ ì¶”ìƒí™” ì œê±°ë¡œ ëª…í™•í•œ êµ¬ì¡° êµ¬í˜„
   - 3-Layer êµ¬ì¡°ë¡œ ë³µì¡ë„ ìµœì†Œí™”
   - ì½”ë“œ ê°€ë…ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„± ìµœìš°ì„ 

2. **PC í™˜ê²½ ì „ìš© ìµœì í™”**
   - í„°ì¹˜ ê¸°ë°˜ ì¸í„°ë™ì…˜ ì™„ì „ ì œê±°
   - ë§ˆìš°ìŠ¤/í‚¤ë³´ë“œ ì¤‘ì‹¬ ì¸í„°í˜ì´ìŠ¤
   - ë°ìŠ¤í¬í†± ë¸Œë¼ìš°ì € ì„±ëŠ¥ ìµœì í™”

3. **ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ê²©ë¦¬**
   - ëª¨ë“  ì™¸ë¶€ ì˜ì¡´ì„±ì„ External ë ˆì´ì–´ì— ê²©ë¦¬
   - ë¼ì´ë¸ŒëŸ¬ë¦¬ êµì²´ ë° ì—…ë°ì´íŠ¸ ìš©ì´ì„±
   - í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•œ êµ¬ì¡° ì„¤ê³„

4. **ë²ˆë“¤ í¬ê¸° ìµœì í™”**
   - Tree-shaking ì¹œí™”ì  êµ¬ì¡°
   - ì§€ì—° ë¡œë”© ê°€ëŠ¥í•œ ëª¨ë“ˆ ì„¤ê³„
   - ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê¸°ëŠ¥ ìë™ ì œê±°

---

## ğŸ›ï¸ 3-Layer Architecture ì„¤ê³„

### ë‹¨ìˆœí™”ëœ ê³„ì¸µ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Features Layer                   â”‚ â† ë¹„ì¦ˆë‹ˆìŠ¤ ê¸°ëŠ¥
â”‚          (gallery, settings)                    â”‚   (ë„ë©”ì¸ë³„ êµ¬ì„±)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ depends on
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Shared Layer                    â”‚ â† ê³µí†µ ì»´í¬ë„ŒíŠ¸
â”‚    (components, hooks, utils, services)         â”‚   (ì¬ì‚¬ìš© ê°€ëŠ¥)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ depends on
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               External Layer                    â”‚ â† ì™¸ë¶€ ì˜ì¡´ì„±
â”‚        (vendors, browser APIs)                  â”‚   (ê¸°ìˆ  êµ¬í˜„)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì˜ì¡´ì„± ê·œì¹™

- **ë‹¨ë°©í–¥ ì˜ì¡´ì„±**: Features â†’ Shared â†’ External ìˆœì„œë¡œë§Œ ì˜ì¡´
- **ê²©ë¦¬ëœ ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬**: External ë ˆì´ì–´ì—ì„œë§Œ ì§ì ‘ ì ‘ê·¼
- **ì¶”ìƒí™” ê³„ì¸µ**: ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•œ ëŠìŠ¨í•œ ê²°í•©

---

## ğŸ¨ ë ˆì´ì–´ë³„ ì„¤ê³„ ì›ì¹™

### 1. Features Layer (`src/features/`)

**ì±…ì„**: ë„ë©”ì¸ë³„ ë¹„ì¦ˆë‹ˆìŠ¤ ê¸°ëŠ¥ êµ¬í˜„

```typescript
// ê°¤ëŸ¬ë¦¬ ê¸°ëŠ¥ ëª¨ë“ˆ êµ¬ì¡°
src/features/gallery/
â”œâ”€â”€ GalleryApp.ts          // ê°¤ëŸ¬ë¦¬ ì•± ë©”ì¸ ë¡œì§
â”œâ”€â”€ GalleryRenderer.ts     // ë Œë”ë§ ë¡œì§
â”œâ”€â”€ components/            // ê°¤ëŸ¬ë¦¬ ì „ìš© ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ hooks/                 // ê°¤ëŸ¬ë¦¬ ì „ìš© í›…
â”œâ”€â”€ renderers/             // ê²©ë¦¬ ë Œë”ëŸ¬
â”œâ”€â”€ styles/                // ê°¤ëŸ¬ë¦¬ ì „ìš© ìŠ¤íƒ€ì¼
â””â”€â”€ types.ts               // ê°¤ëŸ¬ë¦¬ íƒ€ì… ì •ì˜

// ì„¤ì • ê¸°ëŠ¥ ëª¨ë“ˆ êµ¬ì¡°
src/features/settings/
â”œâ”€â”€ services/              // ì„¤ì • ê´€ë ¨ ì„œë¹„ìŠ¤
â””â”€â”€ types/                 // ì„¤ì • íƒ€ì… ì •ì˜
```

**ì„¤ê³„ ì›ì¹™**:

- ë„ë©”ì¸ ê¸°ë°˜ ì™„ì „í•œ ëª¨ë“ˆ ë¶„ë¦¬
- ê¸°ëŠ¥ ê°„ ì§ì ‘ ì˜ì¡´ì„± ê¸ˆì§€ (Sharedë¥¼ í†µí•´ì„œë§Œ í†µì‹ )
- PC ì „ìš© ì¸í„°ë™ì…˜ íŒ¨í„´
- ë…ë¦½ì  í…ŒìŠ¤íŠ¸ ê°€ëŠ¥ êµ¬ì¡°

### 2. Shared Layer (`src/shared/`)

**ì±…ì„**: ì—¬ëŸ¬ ê¸°ëŠ¥ì—ì„œ ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ê³µí†µ ìš”ì†Œ

```typescript
// ê³µí†µ ë ˆì´ì–´ êµ¬ì¡°
src/shared/
â”œâ”€â”€ components/            // ì¬ì‚¬ìš© ê°€ëŠ¥í•œ UI ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ ui/               // ê¸°ë³¸ UI ìš”ì†Œ
â”‚   â”œâ”€â”€ hoc/              // ê³ ì°¨ ì»´í¬ë„ŒíŠ¸
â”‚   â””â”€â”€ isolation/        // ê²©ë¦¬ ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ hooks/                // ê³µí†µ ì»¤ìŠ¤í…€ í›…
â”œâ”€â”€ services/             // ë¹„ì¦ˆë‹ˆìŠ¤ ì„œë¹„ìŠ¤ë“¤
â”œâ”€â”€ state/                // ì „ì—­ ìƒíƒœ ê´€ë¦¬ (Preact Signals)
â”œâ”€â”€ utils/                // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
â”œâ”€â”€ types/                // ê³µí†µ íƒ€ì… ì •ì˜
â””â”€â”€ interfaces/           // ê³µí†µ ì¸í„°í˜ì´ìŠ¤
```

**ì„¤ê³„ ì›ì¹™**:

- Features ë ˆì´ì–´ ê°„ í†µì‹  ë§¤ê°œì²´
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ê³¼ ìƒíƒœ ê´€ë¦¬ ì¤‘ì•™í™”
- íƒ€ì… ì•ˆì „ì„± ë³´ì¥
- ì„±ëŠ¥ ìµœì í™”ëœ ìœ í‹¸ë¦¬í‹°

### 3. External Layer (`src/shared/external/`)

**ì±…ì„**: ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ë¸Œë¼ìš°ì € API ê²©ë¦¬

```typescript
// ì™¸ë¶€ ì˜ì¡´ì„± ê²©ë¦¬ êµ¬ì¡°
src/shared/external/
â”œâ”€â”€ vendors/              // ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë˜í•‘
â”‚   â”œâ”€â”€ vendor-manager.ts // ë¼ì´ë¸ŒëŸ¬ë¦¬ ê´€ë¦¬
â”‚   â””â”€â”€ vendor-api.ts     // ê³µê°œ API
â””â”€â”€ zip/                  // ZIP ì••ì¶• ì„œë¹„ìŠ¤

// ë¼ì´ë¸ŒëŸ¬ë¦¬ ì ‘ê·¼ ì œì–´
interface VendorAccess {
  getFflate: () => FflateAPI;
  getPreact: () => PreactAPI;
  getPreactSignals: () => PreactSignalsAPI;
}
```

**ì„¤ê³„ ì›ì¹™**:

- ëª¨ë“  ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì ‘ê·¼ í†µì œ
- ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ ì¶”ìƒí™”
- ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ ê´€ë¦¬ ì¤‘ì•™í™”
- ì—ëŸ¬ ì²˜ë¦¬ ë° ë³µêµ¬ ì „ëµ

---

## ğŸ’» PC í™˜ê²½ ìµœì í™” ì„¤ê³„

### ì¸í„°ë™ì…˜ íŒ¨í„´ ì„¤ê³„

```typescript
// PC ì „ìš© ì¸í„°ë™ì…˜ ì¸í„°í˜ì´ìŠ¤
interface PCInteractionConfig {
  mouse: {
    wheelSensitivity: number;
    dragThreshold: number;
    hoverDelay: number;
  };
  keyboard: {
    supportedKeys: KeyboardKey[];
    shortcuts: KeyboardShortcut[];
  };
}

// í„°ì¹˜ ì´ë²¤íŠ¸ ì™„ì „ ì œê±°
// âŒ TouchEvent ê´€ë ¨ ì½”ë“œ ì—†ìŒ
// âœ… MouseEvent, KeyboardEventë§Œ ì‚¬ìš©
```

### ì„±ëŠ¥ ìµœì í™” ì„¤ê³„

```typescript
// PC í™˜ê²½ ì„±ëŠ¥ ìµœì í™”
interface PCPerformanceConfig {
  rendering: {
    useGPUAcceleration: boolean;
    enableVsync: boolean;
    maxFPS: number;
  };
  memory: {
    imageCache: CacheConfig;
    componentPool: PoolConfig;
  };
}
```

---

## ğŸ”§ ê¸°ìˆ  ìŠ¤íƒ ì•„í‚¤í…ì²˜

### ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ê´€ë¦¬

```typescript
// ëª¨ë“  ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì ‘ê·¼ì€ ë°˜ë“œì‹œ getter í•¨ìˆ˜ë¥¼ í†µí•´ì„œë§Œ
// âŒ ì§ì ‘ import ê¸ˆì§€
import { deflate } from 'fflate';
import { render } from 'preact';

// âœ… ì¶”ìƒí™” ê³„ì¸µì„ í†µí•œ ì ‘ê·¼
import { getFflate, getPreact } from '@shared/external/vendors';

const { deflate } = getFflate();
const { render } = getPreact();
```

### ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„ íƒ ê¸°ì¤€

1. **ë²ˆë“¤ í¬ê¸° ìµœì†Œí™”**
   - Preact (3KB) vs React (42KB)
   - í•„ìˆ˜ ê¸°ëŠ¥ë§Œ í¬í•¨ëœ ê²½ëŸ‰ ë¼ì´ë¸ŒëŸ¬ë¦¬

2. **PC í™˜ê²½ ìµœì í™”**
   - í„°ì¹˜ ê´€ë ¨ ê¸°ëŠ¥ì´ ì—†ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬
   - ë§ˆìš°ìŠ¤/í‚¤ë³´ë“œ ìµœì í™”ëœ ì¸í„°í˜ì´ìŠ¤

3. **ë¼ì´ì„¼ìŠ¤ í˜¸í™˜ì„±**
   - MIT ë¼ì´ì„¼ìŠ¤ ìš°ì„ 
   - ìƒì—…ì  ì‚¬ìš© ê°€ëŠ¥
   - ë¼ì´ì„¼ìŠ¤ ê³ ì§€ ìš”êµ¬ì‚¬í•­ ì¤€ìˆ˜

### í˜„ì¬ ì‚¬ìš© ë¼ì´ë¸ŒëŸ¬ë¦¬

| ë¼ì´ë¸ŒëŸ¬ë¦¬       | ë²„ì „   | ìš©ë„                 | ë²ˆë“¤ í¬ê¸° |
| ---------------- | ------ | -------------------- | --------- |
| **Preact**       | 10.x   | UI í”„ë ˆì„ì›Œí¬        | ~3KB      |
| **@preact/signals** | 2.x | ë°˜ì‘í˜• ìƒíƒœ ê´€ë¦¬     | ~2KB      |
| **fflate**       | 0.8.x  | ê³ ì„±ëŠ¥ ì••ì¶•          | ~8KB      |

---

## âš¡ ì„±ëŠ¥ ë° ë²ˆë“¤ ìµœì í™”

### ë²ˆë“¤ë§ ì „ëµ

```typescript
// ëª¨ë“ˆ ë¡œë”© ì „ëµ
interface ModuleLoadingStrategy {
  features: 'lazy';     // ì§€ì—° ë¡œë”©
  shared: 'eager';      // ì¦‰ì‹œ ë¡œë”©
  external: 'on-demand'; // í•„ìš”ì‹œ ë¡œë”©
}

// Tree-shaking ìµœì í™”
// âœ… ëª…ì‹œì  export
export { specificFunction } from './module';

// âŒ ì „ì²´ export (Tree-shaking ë°©í•´)
export * from './module';
```

### ëŸ°íƒ€ì„ ìµœì í™”

```typescript
// ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
interface PerformanceMetrics {
  bundleSize: {
    development: number;  // ~400KB
    production: number;   // ~240KB
  };
  loadTime: number;
  memoryUsage: number;
  renderTime: number;
}

// ë©”ëª¨ë¦¬ ê´€ë¦¬
interface MemoryManagement {
  imageCache: {
    maxSize: number;
    evictionPolicy: 'LRU';
  };
  componentPool: {
    maxPoolSize: number;
    preallocationSize: number;
  };
}
```

---

## ğŸ”„ í™•ì¥ì„± ì„¤ê³„

### ê¸°ëŠ¥ í™•ì¥ íŒ¨í„´

```typescript
// ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€ íŒ¨í„´
// 1. Features ë ˆì´ì–´ì— ìƒˆ ëª¨ë“ˆ ìƒì„±
src/features/new-feature/
â”œâ”€â”€ NewFeatureApp.ts       // ê¸°ëŠ¥ ë©”ì¸ ë¡œì§
â”œâ”€â”€ components/            // ì „ìš© ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ hooks/                 // ì „ìš© í›…
â””â”€â”€ types.ts               // íƒ€ì… ì •ì˜

// 2. Shared ë ˆì´ì–´ì— ê³µí†µ ìš”ì†Œ ì¶”ê°€ (í•„ìš”ì‹œ)
src/shared/services/NewFeatureService.ts

// 3. ë©”ì¸ ì•±ì—ì„œ ì´ˆê¸°í™”
// main.tsì—ì„œ ìƒˆ ê¸°ëŠ¥ ë“±ë¡
```

### ë²„ì „ ê´€ë¦¬ ì „ëµ

```typescript
// API ë²„ì „ ê´€ë¦¬
interface FeatureAPI {
  readonly version: string;
  readonly compatibleVersions: string[];
  readonly breaking: boolean;
}

// í•˜ìœ„ í˜¸í™˜ì„± ë³´ì¥
interface BackwardCompatibility {
  supportedVersions: string[];
  migrationGuides: MigrationPlan[];
}
```

---

## ğŸ“Š ì•„í‚¤í…ì²˜ ê²€ì¦

### ì„¤ê³„ ì›ì¹™ ê²€ì¦

1. **ì˜ì¡´ì„± ê·œì¹™ ê²€ì¦**
   - ìˆœí™˜ ì˜ì¡´ì„± ìë™ ê²€ì‚¬ (`npm run deps:check`)
   - ê³„ì¸µ ê°„ ì˜ì¡´ì„± ë°©í–¥ ê²€ì¦
   - ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ê²©ë¦¬ í™•ì¸

2. **ì„±ëŠ¥ ìš”êµ¬ì‚¬í•­ ê²€ì¦**
   - ë²ˆë“¤ í¬ê¸° ì œí•œ ì¤€ìˆ˜ (production < 250KB)
   - ë¡œë”© ì‹œê°„ ë²¤ì¹˜ë§ˆí¬ (< 1ì´ˆ)
   - ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§

3. **PC í™˜ê²½ ìµœì í™” ê²€ì¦**
   - í„°ì¹˜ ì´ë²¤íŠ¸ ì½”ë“œ ë¶€ì¬ í™•ì¸
   - ë§ˆìš°ìŠ¤/í‚¤ë³´ë“œ ìµœì í™” ê²€ì¦
   - ë°ìŠ¤í¬í†± ë¸Œë¼ìš°ì € í˜¸í™˜ì„± í…ŒìŠ¤íŠ¸

### ì§€ì†ì  í’ˆì§ˆ ê´€ë¦¬

```typescript
// í’ˆì§ˆ ë©”íŠ¸ë¦­ìŠ¤ ëª¨ë‹ˆí„°ë§
interface QualityMetrics {
  coupling: CouplingMetrics;      // ê²°í•©ë„
  cohesion: CohesionMetrics;      // ì‘ì§‘ë„
  complexity: ComplexityMetrics;  // ë³µì¡ë„
  testability: TestabilityMetrics; // í…ŒìŠ¤íŠ¸ì„±
}

// ìë™í™”ëœ í’ˆì§ˆ ê²€ì‚¬
const qualityGates = {
  typeScript: 'strict',
  eslint: 'error',
  prettier: 'enforced',
  tests: 'coverage > 80%',
  dependencies: 'no-violations',
};
```

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [Clean Architecture - Robert C. Martin](https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html)
- [PC ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„±ëŠ¥ ìµœì í™”](https://web.dev/performance/)
- [Tree-shaking ìµœì í™” ê°€ì´ë“œ](https://webpack.js.org/guides/tree-shaking/)
- [Preact ì„±ëŠ¥ ìµœì í™”](https://preactjs.com/guide/v10/performance/)

---

<div align="center">

**ğŸ—ï¸ "Architecture is about the important stuff. Whatever that is." - Ralph Johnson**

</div>
