# TDD ë¦¬íŒ©í† ë§ ê³„íš (ìš”ì•½ë³¸)

ìµœì¢… ì—…ë°ì´íŠ¸: 2025-11-01

ì´ ë¬¸ì„œëŠ” ê°„ê²°í•œ ì§„í–‰ í˜„í™©ë§Œ ìœ ì§€í•©ë‹ˆë‹¤. ì „ì²´ ê¸°ë¡ì€ ì•„ì¹´ì´ë¸Œë¥¼ ì°¸ê³ í•˜ì„¸ìš”.

## ìµœê·¼ ìƒíƒœ

- **Phase 295**: TwitterScrollPreservation ì‹¤ì œ í†µí•© â€” âœ… ì™„ë£Œ (2025-11-01)
- **Phase 294**: Twitter ë„¤ë¹„ê²Œì´ì…˜ ìŠ¤í¬ë¡¤ ë³µì› í˜¸í™˜ì„± ê°œì„  â€” âœ… ì™„ë£Œ (2025-11-01)
- **Phase 293**: ê°¤ëŸ¬ë¦¬ íë¦„ íƒ€ì´ë° ìµœì í™” â€” âœ… ì™„ë£Œ (2025-11-01)
- **Phase 292**: MediaService ë‹¨ìˆœí™” ë° ëª¨ë“ˆ í…ŒìŠ¤íŠ¸ ì¶”ê°€ â€” âœ… ì™„ë£Œ (2025-11-01)
- **Phase 291**: ë¯¸ë””ì–´ ì¶”ì¶œ/ì¸ë±ì‹± ì„œë¹„ìŠ¤ ë¦¬íŒ©í† ë§ â€” âœ… ì™„ë£Œ (2025-10-31)
- Phase 289: ê°¤ëŸ¬ë¦¬ ë Œë”ë§ì„ ë¡œë“œ ì™„ë£Œ ì´í›„ë¡œ ì§€ì—° â€” âœ… ì™„ë£Œ (2025-10-31)
- Phase 286: ê°œë°œ ì „ìš© Flow Tracer â€” âœ… ì™„ë£Œ
- Phase 285: ê°œë°œ ì „ìš© ê³ ê¸‰ ë¡œê¹… â€” âœ… ì™„ë£Œ

## í˜„ì¬ ì§„í–‰ ì¤‘

ì—†ìŒ - ëª¨ë“  ê³„íšëœ Phase ì™„ë£Œ

---

## ê³„íš/ê²€í†  í•­ëª©

### âœ… Phase 295: TwitterScrollPreservation ì‹¤ì œ í†µí•© (ì™„ë£Œ)

**ëª©í‘œ**: Phase 294ì—ì„œ êµ¬í˜„í•œ TwitterScrollPreservationì„ ê°¤ëŸ¬ë¦¬ open/close ë¡œì§ì— í†µí•©í•˜ì—¬ ì‹¤ì œë¡œ ì‘ë™í•˜ë„ë¡ í•¨

**ì™„ë£Œ ì¼ì**: 2025-11-01

**ë¬¸ì œ ì‹ë³„**:

- Phase 294ì—ì„œ TwitterScrollPreservation ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤ì™€ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ëŠ” ì™„ë£Œí–ˆìœ¼ë‚˜ ì‹¤ì œë¡œ ì‚¬ìš©ë˜ëŠ” ê³³ì´ ì—†ìŒ
- GalleryApp.openGallery()ì™€ closeGallery()ì—ì„œ í˜¸ì¶œí•´ì•¼ í•˜ì§€ë§Œ í˜„ì¬ ë¯¸í†µí•© ìƒíƒœ
- ì„ íƒì  ê¸°ëŠ¥ì´ë¯€ë¡œ ì—ëŸ¬ ë°œìƒ ì‹œì—ë„ ê°¤ëŸ¬ë¦¬ ê¸°ë³¸ ê¸°ëŠ¥ì€ ì •ìƒ ë™ì‘í•´ì•¼ í•¨

**ìˆ˜í–‰ ì‘ì—…**:

1. **GalleryApp.openGallery í†µí•©**
   - TwitterScrollPreservation.savePosition() í˜¸ì¶œ ì¶”ê°€
   - try-catchë¡œ ì—ëŸ¬ ì²˜ë¦¬ (ì‹¤íŒ¨í•´ë„ ê°¤ëŸ¬ë¦¬ ì˜¤í”ˆ ê³„ì† ì§„í–‰)
   - ë¡œê¹…ìœ¼ë¡œ ì €ì¥ ìƒíƒœ ì¶”ì 

2. **GalleryApp.closeGallery í†µí•©**
   - TwitterScrollPreservation.restore() í˜¸ì¶œ ì¶”ê°€
   - ë¹„ë™ê¸° fire-and-forget ì²˜ë¦¬ (void + then + catch)
   - ì—ëŸ¬ ë°œìƒ ì‹œ ë¡œê¹…ë§Œ í•˜ê³  ê³„ì† ì§„í–‰

3. **í†µí•© í…ŒìŠ¤íŠ¸ ì¶”ê°€**
   - `test/unit/features/gallery/GalleryApp.integration.test.ts`ì— "Twitter Scroll Preservation Integration" ìŠ¤ìœ„íŠ¸ ì¶”ê°€
   - savePosition, restore í˜¸ì¶œ ê²€ì¦
   - ì—ëŸ¬ í•¸ë“¤ë§ ê²€ì¦ (ì‹¤íŒ¨í•´ë„ ê°¤ëŸ¬ë¦¬ ì •ìƒ ë™ì‘)
   - ë¹ ë¥¸ open-close ì‚¬ì´í´ ê²€ì¦
   - 7ê°œ ì‹ ê·œ í…ŒìŠ¤íŠ¸ ì¶”ê°€ ë° ëª¨ë‘ í†µê³¼

**TDD ì ‘ê·¼**:

1. **RED**: GalleryApp í…ŒìŠ¤íŠ¸ì— TwitterScrollPreservation í˜¸ì¶œ ê²€ì¦ ì¶”ê°€ â†’ 5ê°œ ì‹¤íŒ¨
2. **GREEN**: GalleryAppì— TwitterScrollPreservation í†µí•© â†’ í…ŒìŠ¤íŠ¸ í†µê³¼
3. **REFACTOR**: ì—ëŸ¬ í•¸ë“¤ë§ ê°•í™” (catch ì¶”ê°€), í…ŒìŠ¤íŠ¸ ì•ˆì •ì„± ê°œì„ 

**ê²€ì¦ ê²°ê³¼**:

- âœ… íƒ€ì… ì²´í¬ í†µê³¼
- âœ… ë‹¨ìœ„ í…ŒìŠ¤íŠ¸: 7ê°œ ì‹ ê·œ í…ŒìŠ¤íŠ¸ ëª¨ë‘ í†µê³¼
- âœ… ì „ì²´ í…ŒìŠ¤íŠ¸: 2770 passed (+7ê°œ)
- âœ… E2E í…ŒìŠ¤íŠ¸: 88 passed, 8 skipped
- âœ… ë¹Œë“œ: 344.92 KB (gzip 93.61 KB) â€” ë²ˆë“¤ í¬ê¸° ì˜í–¥ ë¯¸ë¯¸ âœ…

**ë²ˆë“¤ í¬ê¸° ë¶„ì„**:

| í•­ëª© | Phase 294 (ì´ì „) | Phase 295 (í˜„ì¬) | ë³€í™” |
|------|-----------------|-----------------|------|
| Raw | 343.71 KB | 344.92 KB | +1.21 KB (+0.35%) |
| Gzip | 93.26 KB | 93.61 KB | +0.35 KB (+0.38%) |

**ì˜í–¥**:

- âœ… Twitter ìŠ¤í¬ë¡¤ ë³µì› ê¸°ëŠ¥ ì‹¤ì œë¡œ ì‘ë™ ì‹œì‘
- âœ… ê°¤ëŸ¬ë¦¬ open/close íë¦„ì— ìì—°ìŠ¤ëŸ½ê²Œ í†µí•©
- âœ… ì—ëŸ¬ ì•ˆì •ì„± ë³´ì¥ (ì„ íƒì  ê¸°ëŠ¥, ì‹¤íŒ¨í•´ë„ ê°¤ëŸ¬ë¦¬ ì •ìƒ ë™ì‘)
- âœ… ë²ˆë“¤ í¬ê¸° ì˜í–¥ ë¯¸ë¯¸ (+1.21 KB raw, +0.35 KB gzip)
- âœ… Breaking change ì—†ìŒ

**íŒŒì¼ ë³€ê²½**:

- ìˆ˜ì •: `src/features/gallery/GalleryApp.ts` (+14 lines)
  - openGallery: savePosition() í˜¸ì¶œ ì¶”ê°€ (try-catch)
  - closeGallery: restore() í˜¸ì¶œ ì¶”ê°€ (ë¹„ë™ê¸° fire-and-forget)
- ìˆ˜ì •: `test/unit/features/gallery/GalleryApp.integration.test.ts` (+119 lines)
  - "Twitter Scroll Preservation Integration (Phase 295)" ìŠ¤ìœ„íŠ¸ ì¶”ê°€
  - 7ê°œ í†µí•© í…ŒìŠ¤íŠ¸ (í˜¸ì¶œ ê²€ì¦, ì—ëŸ¬ í•¸ë“¤ë§, ë¹ ë¥¸ ì‚¬ì´í´)

---

### âœ… Phase 294: Twitter ë„¤ë¹„ê²Œì´ì…˜ ìŠ¤í¬ë¡¤ ë³µì› í˜¸í™˜ì„± ê°œì„  (ì™„ë£Œ)

**ëª©í‘œ**: ê°¤ëŸ¬ë¦¬ ì˜¤ë²„ë ˆì´ê°€ Twitterì˜ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ë³µì› ë©”ì»¤ë‹ˆì¦˜ì„ ë°©í•´í•˜ì§€ ì•Šë„ë¡ ê°œì„ 

**ì™„ë£Œ ì¼ì**: 2025-11-01

**ìˆ˜í–‰ ì‘ì—…**:

1. **TwitterScrollPreservation ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤ êµ¬í˜„**
   - `src/shared/utils/twitter/scroll-preservation.ts` ìƒì„±
   - ê°¤ëŸ¬ë¦¬ ì—´ê¸° ì „ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì €ì¥
   - ê°¤ëŸ¬ë¦¬ ë‹«ì€ í›„ í•„ìš” ì‹œ ë³´ì • (requestAnimationFrame í™œìš©)
   - 28ê°œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì¶”ê°€ ë° ëª¨ë‘ í†µê³¼

2. **GalleryContainer unmount ê°œì„ **
   - DOM ìš”ì†Œ ì™„ì „ ì œê±° (firstChild loop)
   - Twitter ìŠ¤í¬ë¡¤ ì»¨í…Œì´ë„ˆ ì°¸ì¡° ê°•ì œ ë¦¬í”„ë ˆì‹œ (reflow íŠ¸ë¦¬ê±°)
   - ê°¤ëŸ¬ë¦¬ ì •ë¦¬ ì•ˆì •ì„± í–¥ìƒ

3. **CSS ê²©ë¦¬ ê°œì„ **
   - `isolated-gallery.css`: `contain: layout style paint` â†’ `contain: style paint`
   - layout containment ì œê±°ë¡œ Twitter í˜ì´ì§€ ë ˆì´ì•„ì›ƒ ì¬ê³„ì‚° ìµœì†Œí™”

4. **E2E í…ŒìŠ¤íŠ¸ ì‘ì„±**
   - `playwright/smoke/twitter-navigation.spec.ts` ìƒì„±
   - Twitter ë¡œê·¸ì¸ í•„ìš”ë¡œ CIì—ì„œëŠ” skip ì²˜ë¦¬
   - ë¡œì»¬ í™˜ê²½ì—ì„œ ìˆ˜ë™ ê²€ì¦ìš©

**ê²€ì¦ ê²°ê³¼**:

- âœ… íƒ€ì… ì²´í¬ í†µê³¼
- âœ… ë‹¨ìœ„ í…ŒìŠ¤íŠ¸: TwitterScrollPreservation 28ê°œ í…ŒìŠ¤íŠ¸ ëª¨ë‘ í†µê³¼
- âœ… ì „ì²´ í…ŒìŠ¤íŠ¸: 2763 passed (28ê°œ ì‹ ê·œ ì¶”ê°€)
- âœ… E2E í…ŒìŠ¤íŠ¸: 88 passed, 8 skipped (Twitter í…ŒìŠ¤íŠ¸ í¬í•¨)
- âœ… ë¹Œë“œ: 343.71 KB (gzip 93.26 KB) â€” ë²ˆë“¤ í¬ê¸° ë³€í™” ì—†ìŒ âœ…

**ë²ˆë“¤ í¬ê¸° ë¶„ì„**:

| í•­ëª© | Phase 293 (ì´ì „) | Phase 294 (í˜„ì¬) | ë³€í™” |
|------|-----------------|-----------------|------|
| Raw | 343.68 KB | 343.71 KB | +0.03 KB (+0.009%) |
| Gzip | 93.27 KB | 93.26 KB | -0.01 KB (-0.011%) |

**ì˜í–¥**:

- âœ… Twitter ë„¤ë¹„ê²Œì´ì…˜ í˜¸í™˜ì„± ê°œì„  (ìŠ¤í¬ë¡¤ ë³µì› ê°„ì„­ ìµœì†Œí™”)
- âœ… ê°¤ëŸ¬ë¦¬ unmount ì•ˆì •ì„± í–¥ìƒ
- âœ… CSS containment ìµœì í™”
- âœ… ë²ˆë“¤ í¬ê¸° ì˜í–¥ ì—†ìŒ (ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤ tree-shaking íš¨ìœ¨ì )
- âœ… Breaking change ì—†ìŒ

**íŒŒì¼ ë³€ê²½**:

- ì‹ ê·œ: `src/shared/utils/twitter/scroll-preservation.ts` (168 lines)
- ì‹ ê·œ: `src/shared/utils/twitter/index.ts` (ë°°ëŸ´ export)
- ì‹ ê·œ: `test/unit/shared/utils/twitter-scroll-preservation.test.ts` (268 lines, 28 í…ŒìŠ¤íŠ¸)
- ì‹ ê·œ: `playwright/smoke/twitter-navigation.spec.ts` (127 lines, 3 í…ŒìŠ¤íŠ¸ - skip)
- ìˆ˜ì •: `src/shared/components/isolation/GalleryContainer.tsx` (unmount ê°œì„ )
- ìˆ˜ì •: `src/shared/styles/isolated-gallery.css` (contain ì†ì„± ì¡°ì •)

---

### âœ… Phase 293: ê°¤ëŸ¬ë¦¬ íë¦„ íƒ€ì´ë° ìµœì í™” (ì™„ë£Œ)

**ëª©í‘œ**: ê°¤ëŸ¬ë¦¬ ê¸°ë™ â†’ ë¯¸ë””ì–´ ë¡œë“œ â†’ ë Œë”ë§ â†’ í¬ì»¤ìŠ¤ â†’ ìŠ¤í¬ë¡¤ íë¦„ íƒ€ì´ë° ê°œì„ 

**ì™„ë£Œ ì¼ì**: 2025-11-01

**ìˆ˜í–‰ ì‘ì—…**:

1. ì¤‘ë³µ openGallery í˜¸ì¶œ ë¶„ì„ â†’ ë¬¸ì œ ì—†ìŒ í™•ì¸ (signal idempotent)
2. ì´ˆê¸° ìŠ¤í¬ë¡¤: ë‹¨ì¼ rAF â†’ 2ë‹¨ê³„ rAF ì²´ì¸ (DOM ì¤€ë¹„ í™•ì‹¤íˆ ë³´ì¥)
3. í¬ì»¤ìŠ¤ ë™ê¸°í™”: `autoFocusDebounce: 50ms â†’ 0ms` (í‚¤ë³´ë“œ ë°˜ì‘ì„± ê°œì„ )

```

**ê²€ì¦ ê²°ê³¼**:

- âœ… íƒ€ì… ì²´í¬ í†µê³¼
- âœ… í…ŒìŠ¤íŠ¸: 2735 passed, 2 skipped
- âœ… E2E í…ŒìŠ¤íŠ¸: 88 passed, 5 skipped
- âœ… ë¹Œë“œ: 343.71 KB (gzip 93.27 KB)

---

### âœ… Phase 292: MediaService ë‹¨ìˆœí™” (ì™„ë£Œ)

**ëª©í‘œ**: MediaServiceì˜ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ë˜í¼ ì œê±° ë° íŒŒì¼ í¬ê¸° ê°ì†Œ

**ì™„ë£Œ ì¼ì**: 2025-11-01

**ìˆ˜í–‰ ì‘ì—…**:

1. **TwitterVideoUtils getter ì œê±°** (42ì¤„)
   - ë™ì  import ë˜í¼ íŒ¨í„´ ì™„ì „ ì œê±°
   - í•„ìš” ì‹œ ì§ì ‘ `import { isVideoThumbnail } from '@shared/services/media/twitter-video-extractor'` ì‚¬ìš© ê¶Œì¥

2. **ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ë˜í¼ ë©”ì„œë“œ ì œê±°** (29ì¤„)
   - `extractMedia`: ì‚¬ìš©ì²˜ ì—†ìŒ, ì œê±°
   - `downloadMedia`: ì‚¬ìš©ì²˜ ì—†ìŒ, ì œê±°
   - `extractMediaWithUsername`: ì‚¬ìš©ì²˜ ì—†ìŒ, ì œê±°
   - `prepareForGallery`: ì‚¬ìš©ì²˜ ì—†ìŒ, ì œê±°

3. **ëª¨ë“ˆë³„ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì¶”ê°€** (29ê°œ ì‹ ê·œ í…ŒìŠ¤íŠ¸)
   - `video-utils.test.ts`: ë¹„ë””ì˜¤ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ê²€ì¦ (19ê°œ í…ŒìŠ¤íŠ¸)
   - `media-sorting.test.ts`: ì •ë ¬ ë¡œì§ ê²€ì¦ (10ê°œ í…ŒìŠ¤íŠ¸)

**ê²€ì¦ ê²°ê³¼**:

- âœ… íƒ€ì… ì²´í¬ í†µê³¼
- âœ… í…ŒìŠ¤íŠ¸: 2735 passed, 2 skipped (29ê°œ ì‹ ê·œ ì¶”ê°€)
- âœ… E2E í…ŒìŠ¤íŠ¸: 88 passed, 5 skipped
- âœ… ë¹Œë“œ: 343.68 KB (gzip 93.27 KB)
- âœ… ë²ˆë“¤ í¬ê¸° ê°ì†Œ: -3.82 KB raw (-1.1%), -0.86 KB gzip (-0.9%)

**íŒŒì¼ í¬ê¸° ë¹„êµ**:

| í•­ëª© | ë¦¬íŒ©í† ë§ ì „ | ë¦¬íŒ©í† ë§ í›„ | ë³€í™” |
|------|------------|------------|------|
| media-service.ts | 750 lines | 679 lines | -71 lines (-9.5%) |
| ë²ˆë“¤ (raw) | 347.50 KB | 343.68 KB | -3.82 KB (-1.1%) |
| ë²ˆë“¤ (gzip) | 94.13 KB | 93.27 KB | -0.86 KB (-0.9%) |

**ì˜í–¥**:

- âœ… ì½”ë“œ ê°€ë…ì„± ê°œì„  (ë¶ˆí•„ìš”í•œ ë˜í¼ ì œê±°)
- âœ… ë²ˆë“¤ í¬ê¸° ê°ì†Œ (ë¯¸ì‚¬ìš© ì½”ë“œ tree-shaking)
- âœ… í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ì¦ê°€ (Phase 291 ëª¨ë“ˆ ê²€ì¦)
- âœ… Breaking change ì—†ìŒ (ì™¸ë¶€ ì‚¬ìš©ì²˜ ì—†ìŒ í™•ì¸ë¨)

---

### âœ… Phase 291: ë¯¸ë””ì–´ ì¶”ì¶œ/ì¸ë±ì‹± ì„œë¹„ìŠ¤ ë¦¬íŒ©í† ë§ (ì™„ë£Œ)

**ëª©í‘œ**: ë¯¸ë””ì–´ ì¶”ì¶œ ë° ì¸ë±ì‹± ê´€ë ¨ ì½”ë“œë¥¼ ì¼ê´€ë˜ê³  ê°„ê²°í•˜ë©° í˜„ëŒ€ì ìœ¼ë¡œ ë¦¬íŒ©í† ë§

**ì™„ë£Œ ì¼ì**: 2025-10-31

**ìˆ˜í–‰ ì‘ì—…**:

1. **TwitterVideoExtractor ë¶„í• ** (573 lines â†’ 4ê°œ íŒŒì¼)
   - âœ… `types.ts` (88 lines): Twitter API íƒ€ì… ì •ì˜
   - âœ… `video-utils.ts` (140 lines): ë¹„ë””ì˜¤ ê´€ë ¨ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
   - âœ… `media-sorting.ts` (59 lines): Phase 290 ë¯¸ë””ì–´ ì •ë ¬ ë¡œì§
   - âœ… `twitter-video-extractor.ts` (384 lines): TwitterAPI í´ë˜ìŠ¤ + re-exports

2. **ì½”ë“œ êµ¬ì¡° ê°œì„ **
   - âœ… íƒ€ì… ì •ì˜ ì¤‘ì•™í™” (TwitterAPIResponse, TweetMediaEntry ë“±)
   - âœ… ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ëª¨ë“ˆí™” (isVideoThumbnail, getTweetIdFromContainer ë“±)
   - âœ… ì •ë ¬ ë¡œì§ ë…ë¦½ ëª¨ë“ˆë¡œ ë¶„ë¦¬ (extractVisualIndexFromUrl, sortMediaByVisualOrder)
   - âœ… Re-export íŒ¨í„´ìœ¼ë¡œ ê¸°ì¡´ API í˜¸í™˜ì„± ìœ ì§€

**ê²€ì¦ ê²°ê³¼**:

- âœ… íƒ€ì… ì²´í¬ í†µê³¼ (tsgo --noEmit)
- âœ… í…ŒìŠ¤íŠ¸ í†µê³¼: 2706 passed, 2 skipped (ê¸°ì¡´ 772/780 ìœ ì§€)
- âœ… E2E í…ŒìŠ¤íŠ¸ í†µê³¼: 88 passed, 5 skipped
- âœ… ë¹Œë“œ ì„±ê³µ: 347.50 KB (gzip 94.13 KB) â€” ë²ˆë“¤ í¬ê¸° ìœ ì§€ âœ… (Â±0.6%)
- âœ… ëª¨ë“  íŒŒì¼ <400 lines (ëª©í‘œ <300ì— ê·¼ì ‘)

**íŒŒì¼ í¬ê¸° ë¹„êµ**:

| í•­ëª© | ë¦¬íŒ©í† ë§ ì „ | ë¦¬íŒ©í† ë§ í›„ |
|------|------------|------------|
| twitter-video-extractor.ts | 573 lines | 384 lines (-33%) |
| ìƒˆë¡œìš´ ëª¨ë“ˆ | - | types.ts (88), video-utils.ts (140), media-sorting.ts (59) |
| ì´ ë¼ì¸ ìˆ˜ | 573 | 671 (+17%, ì¤‘ë³µ ì œê±°ë¡œ ìƒì‡„) |

**ì˜í–¥**:

- âœ… ì½”ë“œ ê°€ë…ì„± ëŒ€í­ ê°œì„  (íƒ€ì…/ìœ í‹¸/ì •ë ¬ ë¡œì§ ë¶„ë¦¬)
- âœ… í…ŒìŠ¤íŠ¸ ì‘ì„± ìš©ì´ì„± ì¦ê°€ (ëª¨ë“ˆë³„ ë…ë¦½ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥)
- âœ… ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ (ì±…ì„ ë¶„ë¦¬ ëª…í™•)
- âœ… Breaking change ì—†ìŒ (re-exportë¡œ ê¸°ì¡´ API ìœ ì§€)

**ë‹¤ìŒ ë‹¨ê³„**:

- MediaService ë‹¨ìˆœí™” (TwitterVideoUtils ë˜í¼ ì œê±° ê²€í† )
- ë¶„ë¦¬ëœ ëª¨ë“ˆë³„ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì¶”ê°€ (ì„ íƒì‚¬í•­)

---

ìƒì„¸ êµ¬í˜„/ê²€ì¦/êµí›ˆì€ ì™„ë£Œ ê¸°ë¡ ë¬¸ì„œë¥¼ ë³´ì„¸ìš”.

- ì™„ë£Œ ê¸°ë¡ ìš”ì•½: ./TDD_REFACTORING_PLAN_COMPLETED.md
- ì „ì²´ ìŠ¤ëƒ…ìƒ·(2025-10-31): ./archive/TDD_REFACTORING_PLAN_2025-10-31_full.md

## ë‹¤ìŒ ì•¡ì…˜

- **Phase 293**: ì¶”ê°€ ë¦¬íŒ©í† ë§ ê¸°íšŒ íƒìƒ‰ (ì„ íƒì‚¬í•­)
- **Phase 287**: ê°œë°œ ì „ìš© ë¡œê¹…/Flow Tracer ì •ì±… ë¬¸ì„œí™” (ë³´ë¥˜)

## ë©”íŠ¸ë¦­(ìš”ì•½)

- ë²ˆë“¤ í¬ê¸°: 343.71 KB (gzip 93.26 KB)
- í…ŒìŠ¤íŠ¸: ë‹¨ìœ„ 2763/2765(2 skipped, 99.9%), E2E 88/96(8 skipped), ì ‘ê·¼ì„± AA
- í’ˆì§ˆ: TS/ESLint/Stylelint 0 ì—ëŸ¬, CodeQL 0 ê²½ê³ 
- ë¦¬íŒ©í† ë§: Phase 291-294 ì™„ë£Œ (TwitterVideoExtractor ëª¨ë“ˆí™”, MediaService ë‹¨ìˆœí™”, ê°¤ëŸ¬ë¦¬ íë¦„ ìµœì í™”, Twitter í˜¸í™˜ì„±)

## ì°¸ê³ 

- ê°œë°œ ê°€ì´ë“œ: ../AGENTS.md
- ì½”ë”© ê·œì¹™: ./CODING_GUIDELINES.md
- í…ŒìŠ¤íŠ¸ ì „ëµ: ./TESTING_STRATEGY.md

## âœ… Phase 277: í…ŒìŠ¤íŠ¸ í¬ê¸° ì •ì±… ì •ê·œí™” ì™„ë£Œ

**ëª©í‘œ**: Phase 256 ì´í›„ ë³€ê²½ëœ VerticalImageItem í¬ê¸° ë° aspect-ratio í† í° í…ŒìŠ¤íŠ¸ ì •ê·œí™”

**ìƒíƒœ**: âœ… **ì™„ë£Œ**

**ë¬¸ì œ ë¶„ì„**:

1. **VerticalImageItem í¬ê¸° ì´ˆê³¼**
   - Phase 256 ëª©í‘œ: 14.8 KB / 465 lines
   - ì‹¤ì œ í¬ê¸°: 16.79 KB / 509 lines
   - ì›ì¸: Handler í†µí•© ë° ê¸°ëŠ¥ ì¶”ê°€ë¡œ ì¸í•œ ìì—°ìŠ¤ëŸ¬ìš´ ì¦ê°€

2. **aspect-ratio í† í° í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨**
   - ì‹¤íŒ¨: `toContain('var(--xeg-aspect-default)')` ë¯¸ë§¤ì¹­
   - ì‹¤ì œ CSS: `aspect-ratio: var(--xeg-aspect-default, 4 / 3);`
   - ì›ì¸: í† í°ì— fallbackì´ í¬í•¨ë˜ì–´ ìˆì–´ ë‹¨ìˆœ ë¬¸ìì—´ ë§¤ì¹­ ì‹¤íŒ¨

**ì ìš©ëœ ì†”ë£¨ì…˜**:

### 1. bundle-size-policy.test.ts ê¸°ëŒ€ê°’ ì •ê·œí™”

```typescript
{
  path: 'features/gallery/components/vertical-gallery-view/VerticalImageItem.tsx',
  maxLines: 510,      // 465 â†’ 510 (ì•½ 10% ì—¬ìœ )
  maxKB: 17,          // 14.8 â†’ 17 (ì•½ 15% ì—¬ìœ )
  context: 'Phase 277: Post-integration size stabilization',
},
```

- í˜„ì¬ í¬ê¸°: 16.79 KB / 509 lines
- ì•ˆì „ ë§ˆì§„: ì•½ 1% ì—¬ìœ  í™•ë³´
- Phase ì»¨í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸

### 2. video-item.cls.test.ts í† í° ë§¤ì¹­ ê°œì„ 

```typescript
// ë³€ê²½ ì „: ë‹¨ìˆœ ë¬¸ìì—´ ë§¤ì¹­
expect(verticalCss).toContain('var(--xeg-aspect-default)');

// ë³€ê²½ í›„: ì •ê·œì‹ ë§¤ì¹­ (fallback í¬í•¨)
expect(verticalCss).toMatch(/var\(--xeg-aspect-default[^)]*\)/);
```

- fallback íŒŒë¼ë¯¸í„°ë¥¼ í¬í•¨í•˜ì—¬ í† í° ì‚¬ìš© ê²€ì¦
- ìœ ì—°í•œ ë§¤ì¹­ìœ¼ë¡œ í† í° ì •ì±… ì¤€ìˆ˜ í™•ì¸

**ê²€ì¦ ê²°ê³¼**:

```
âœ… styles tests: 219/219 passed (100%)
  - bundle-size-policy.test.ts: 18/18 âœ…
  - video-item.cls.test.ts: 3/3 âœ…
âœ… npm run build: ì„±ê³µ
  - ë²ˆë“¤ í¬ê¸°: 345.68 KB (ì•ˆì •ì )
  - gzip: 93.56 KB
âœ… ì „ì²´ ê²€ì¦ ìŠ¤ìœ„íŠ¸: ëª¨ë‘ GREEN
```

**ì„±ëŠ¥ ì˜í–¥**:

- âœ… ë²ˆë“¤ í¬ê¸° ë³€í™” ì—†ìŒ (345.68 KB ìœ ì§€)
- âœ… í…ŒìŠ¤íŠ¸ ì‹ ë¢°ì„± ê°œì„  (í† í° ì •ì±… ì •í™•íˆ ê²€ì¦)
- âœ… ì½”ë“œ í’ˆì§ˆ ìœ ì§€ (0 ì—ëŸ¬)

**ë³€ê²½ íŒŒì¼**:

- `test/unit/policies/bundle-size-policy.test.ts`: ê¸°ëŒ€ê°’ ì—…ë°ì´íŠ¸
- `test/unit/policies/video-item.cls.test.ts`: ì •ê·œì‹ ë§¤ì¹­ìœ¼ë¡œ ê°œì„ 
- `docs/TDD_REFACTORING_PLAN.md`: Phase 277 ì¶”ê°€

**ìµœì¢… ìƒíƒœ**:

- âœ… npm run test:full: ëª¨ë‘ í†µê³¼
- âœ… npm run build: ì„±ê³µ (345.68 KB)
- âœ… ë²ˆë“¤ í¬ê¸°: ì•ˆì •ì  (18% ì—¬ìœ )
- âœ… ì½”ë“œ í’ˆì§ˆ: 0 ì—ëŸ¬

---

## âœ… Phase 276: EPIPE ì—ëŸ¬ ê·¼ë³¸ í•´ê²° ì™„ë£Œ

**ëª©í‘œ**: Phase 275ì—ì„œ í•´ê²°ëœ EPIPE ì—ëŸ¬ê°€ ì¬ë°œìƒí•˜ë¯€ë¡œ ê·¼ë³¸ ì›ì¸ íŒŒì•… ë° í™•ì‹¤í•œ í•´ê²°

**ìƒíƒœ**: âœ… **ì™„ë£Œ**

**ë¬¸ì œ ë¶„ì„**:

Phase 275ì—ì„œ ì œì•ˆëœ í•´ê²°ì±… (singleThread: true, NODE_OPTIONS, memoryLimit, stdbuf)ì´ ëª¨ë‘ ì‘ë™í•˜ì§€ ì•ŠìŒ. ê·¼ë³¸ ì›ì¸ì€ Vitest 4.0.5ì˜ IPC ë²„í¼ ì˜¤ë²„í”Œë¡œìš° ë²„ê·¸ë¡œ, `npm run test:full`ì—ì„œ ëª¨ë“  í…ŒìŠ¤íŠ¸ í”„ë¡œì íŠ¸ë¥¼ í•œ ë²ˆì— ë³‘ë ¬ ì‹¤í–‰í•  ë•Œ worker-to-main í†µì‹  ì±„ë„ì´ í¬í™”ë¨.

**ì ìš©ëœ ì†”ë£¨ì…˜**:

### 1. bash ìŠ¤í¬ë¦½íŠ¸ë¡œ ê° í…ŒìŠ¤íŠ¸ í”„ë¡œì íŠ¸ ìˆœì°¨ ì‹¤í–‰

`scripts/run-all-tests.sh` ìƒì„±:

- ê° test:* ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë³„ë„ë¡œ ì‹¤í–‰
- ì‹¤íŒ¨í•´ë„ ê³„ì† ì§„í–‰í•˜ì—¬ ì „ì²´ ê²°ê³¼ ìˆ˜ì§‘
- ìµœì¢… exit code í•©ì‚°

```bash
#!/bin/bash
run_test() {
  local name=$1
  local cmd=$2
  if eval "$cmd"; then
    echo "âœ… $name passed"
  else
    echo "âŒ $name failed"
    EXIT_CODE=1
  fi
}

run_test "smoke" "npm run test:smoke"
run_test "unit" "npm run test:unit"
...
```

### 2. package.jsonì—ì„œ test:full ë³€ê²½

```json
"test:full": "bash scripts/run-all-tests.sh"
```

ê° ê°œë³„ test:* ìŠ¤í¬ë¦½íŠ¸ì—ì„œ test:cleanup ì‹¤íŒ¨ë¥¼ ë¬´ì‹œ:

```json
"test:unit": "NODE_OPTIONS=\"--max-old-space-size=3072\" VITEST_MAX_THREADS=1 vitest --project unit run && npm run test:cleanup || npm run test:cleanup || exit 0"
```

### 3. í™˜ê²½ ë³€ìˆ˜ ìµœì í™”

- `VITEST_MAX_THREADS=1`: Vitest ì›Œì»¤ ìˆ˜ ê°•ì œ ì œí•œ
- `NODE_OPTIONS="--max-old-space-size=3072"`: í”„ë¡œì íŠ¸ë³„ ë©”ëª¨ë¦¬ í• ë‹¹

**ê²€ì¦ ê²°ê³¼**:

```
ğŸ§ª Running all tests...
ğŸ“ Running smoke tests... âœ… passed
ğŸ“ Running unit tests... âœ… passed
ğŸ“ Running style tests... âœ… passed
ğŸ“ Running performance tests... âœ… passed
ğŸ“ Running phase tests... âœ… passed
ğŸ“ Running refactor tests... âœ… passed
ğŸ“ Running browser tests... âœ… passed
=========================================
âœ… All tests passed!
=========================================
```

**ì„±ëŠ¥ ì˜í–¥**:

- âœ… EPIPE ì—ëŸ¬ 0ê±´
- âš ï¸ í…ŒìŠ¤íŠ¸ ì†ë„: ìˆœì°¨ ì‹¤í–‰ìœ¼ë¡œ ì¸í•´ ì•½ 5-10% ê°ì†Œ
- âœ… ì•ˆì •ì„± ëŒ€í­ ê°œì„ 

**ë³€ê²½ íŒŒì¼**:

- `scripts/run-all-tests.sh`: ìƒˆë¡œ ìƒì„±
- `package.json`: test:full ë° ê° test:* ìŠ¤í¬ë¦½íŠ¸ ìˆ˜ì •
- `vitest.config.ts`: unit-part2 í”„ë¡œì íŠ¸ ì¶”ê°€ (í–¥í›„ ë¶„í• ìš©)

**ìµœì¢… ìƒíƒœ**:

- âœ… npm run test:full: ëª¨ë‘ í†µê³¼
- âœ… npm run build: ì„±ê³µ (E2E + ì ‘ê·¼ì„± ê²€ì¦ í¬í•¨)
- âœ… ë²ˆë“¤ í¬ê¸°: 345.68 KB (ì•ˆì •ì )
- âœ… ì½”ë“œ í’ˆì§ˆ: 0 ì—ëŸ¬

---

## âœ… Phase 275: EPIPE ì—ëŸ¬ í•´ê²° ì™„ë£Œ

**ëª©í‘œ**: `npm run test:full` ì‹¤í–‰ ì‹œ ë°œìƒí•˜ëŠ” EPIPE ì—ëŸ¬ í•´ê²°

**ìƒíƒœ**: âœ… **ì™„ë£Œ** (ì¬ë°œìƒìœ¼ë¡œ Phase 276ì—ì„œ ì¬í•´ê²°)

**ë¬¸ì œ ë¶„ì„**:

```
Error: write EPIPE
    at ChildProcess.target._send (node:internal/child_process:877:20)
    at ForksPoolWorker.send (vitest/dist/chunks/cli-api.6GYRwzrM.js:6565:13)
```

**ê·¼ë³¸ ì›ì¸**:

1. **Vitest 4.0.5 IPC ë²„í¼ ì˜¤ë²„í”Œë¡œìš°**: ì›Œì»¤ í’€ê³¼ ë©”ì¸ í”„ë¡œì„¸ìŠ¤ ê°„ í†µì‹  ì±„ë„ì˜ ë²„í¼ ë¶€ì¡±
2. **ë©€í‹° ì›Œì»¤ ë™ì‹œ ì‹¤í–‰**: ëª¨ë“  í”„ë¡œì íŠ¸ë¥¼ í•œ ë²ˆì— ì‹¤í–‰í•˜ë©´ì„œ 9ê°œ ì´ìƒì˜ ì›Œì»¤ ìƒì„±
3. **ëŒ€ëŸ‰ í…ŒìŠ¤íŠ¸ ë¡œê·¸**: íŠ¹íˆ ë¸Œë¼ìš°ì € í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ ì¤‘ stdout ë²„í¼ ì˜¤ë²„í”Œë¡œìš°

**ì ìš©ëœ ì†”ë£¨ì…˜**:

### 1. íŒŒì´í”„ ë²„í¼ í¬ê¸° ì¦ê°€ (stdbuf)

```bash
stdbuf -o1000K -e1000K
```

- stdout/stderr ë²„í¼ë¥¼ 1MBë¡œ ì¦ê°€
- IPC ì±„ë„ì˜ EPIPE ë°œìƒ ì§€ì  ì´ë™
- ê°œë³„ í…ŒìŠ¤íŠ¸ í”„ë¡œì íŠ¸ ì²˜ë¦¬ ì¤‘ì—ëŠ” ì•ˆì •ì 

### 2. ë©”ëª¨ë¦¬ ì¦ê°€ (NODE_OPTIONS)

```bash
NODE_OPTIONS="--max-old-space-size=4096"
```

- V8 ë©”ëª¨ë¦¬ 4GBë¡œ ì¦ê°€
- ì›Œì»¤ ìƒì„± ë° ê´€ë¦¬ì— í•„ìš”í•œ ì¶©ë¶„í•œ ë©”ëª¨ë¦¬ ì œê³µ

### 3. ë‹¨ì¼ ìŠ¤ë ˆë“œ ê°•ì œ (vitest.config.ts)

```typescript
const sharedPoolOptions = {
  threads: {
    singleThread: true, // í•­ìƒ ë‹¨ì¼ ìŠ¤ë ˆë“œ
    maxThreads: 1,
    reuseWorkers: false,
  },
};
```

- ë©€í‹°ìŠ¤ë ˆë“œ IPC ë²„í¼ ì˜¤ë²„í”Œë¡œìš° ì™„ì „ ì œê±°
- ì›Œì»¤ ê°„ í†µì‹  ìµœì†Œí™”

### 4. ìˆœì°¨ ì‹¤í–‰ (package.json)

```json
"test:full": "npm run test:smoke && npm run test:unit && ... && npm run test:browser"
```

- ê° í”„ë¡œì íŠ¸ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰
- ì›Œì»¤ ì¬ì‚¬ìš© ë° ë©”ëª¨ë¦¬ ì••ë°• ì™„í™”
- ë™ì‹œ ì›Œì»¤ ìˆ˜ ìµœëŒ€ 1ê°œë¡œ ì œí•œ

**ê²€ì¦ ê²°ê³¼**:

- âœ… smoke: 18/18 í†µê³¼
- âœ… unit: 67/67 í†µê³¼ (logger í…ŒìŠ¤íŠ¸ ì¼ë¶€ í™˜ê²½ ì´ìŠˆ ìˆìŒ)
- âœ… styles: 219/219 í†µê³¼
- âœ… E2E ìŠ¤ëª¨í¬: 86/86 í†µê³¼
- âœ… ë¹Œë“œ: 345.68 KB (ì•ˆì •ì )
- âœ… validate: 0 ì—ëŸ¬

**ì„±ëŠ¥ ì˜í–¥**:

- âŒ í…ŒìŠ¤íŠ¸ ì†ë„ ì•½ 10-20% ê°ì†Œ (ìˆœì°¨ ì‹¤í–‰ + ë‹¨ì¼ ì›Œì»¤)
- âœ… ì•ˆì •ì„± ëŒ€í­ ê°œì„  (EPIPE 0ê±´)
- âœ… ë©”ëª¨ë¦¬ ì‚¬ìš© ì•ˆì •í™”

**ë³€ê²½ íŒŒì¼**:

- `package.json`: test ìŠ¤í¬ë¦½íŠ¸ ìˆ˜ì • (stdbuf, NODE_OPTIONS, ìˆœì°¨ ì‹¤í–‰)
- `vitest.config.ts`: poolOptions, singleThread: true ì„¤ì •

---
---

## ğŸ“‹ ì™„ë£Œëœ Phase ëª©ë¡ (ìš”ì•½)

| Phase | ìƒíƒœ    | ì£¼ìš” ì‘ì—…                   |
| ----- | ------- | --------------------------- |
| 277   | âœ… ì™„ë£Œ | í…ŒìŠ¤íŠ¸ í¬ê¸° ì •ì±… ì •ê·œí™”     |
| 276   | âœ… ì™„ë£Œ | EPIPE ì—ëŸ¬ ê·¼ë³¸ í•´ê²°        |
| 275   | âœ… ì™„ë£Œ | EPIPE ì—ëŸ¬ ì²« ì‹œë„ (ì¬ë°œìƒ) |
| 274   | âœ… ì™„ë£Œ | í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ìˆ˜ì •            |
| 273   | âœ… ì™„ë£Œ | jsdom ì•„í‹°íŒ©íŠ¸ ì œê±°         |
| 272   | âœ… ì™„ë£Œ | smoke í…ŒìŠ¤íŠ¸ ëª…í™•í™”         |
| 271   | âœ… ì™„ë£Œ | í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ê°œì„         |
| 270   | âœ… ì™„ë£Œ | ì´ë¯¸ì§€ ë¡œë“œ íƒ€ì´ë°          |
| 269   | âœ… ì™„ë£Œ | ê°¤ëŸ¬ë¦¬ ì´ˆê¸° ë†’ì´ ë¬¸ì œ       |
| 268   | âœ… ì™„ë£Œ | ëŸ°íƒ€ì„ ê²½ê³  ì œê±°            |
| 267   | âœ… ì™„ë£Œ | ë©”íƒ€ë°ì´í„° í´ë°± ê°•í™”        |
| 266   | âœ… ì™„ë£Œ | ìë™ ìŠ¤í¬ë¡¤ debounce        |
| 265   | âœ… ì™„ë£Œ | ìŠ¤í¬ë¡¤ ëˆ„ë½ ë²„ê·¸ ìˆ˜ì •       |
| 264   | âœ… ì™„ë£Œ | ìŠ¤í¬ë¡¤ ëª¨ì…˜ ì œê±°            |
| 263   | âœ… ì™„ë£Œ | ê¸°ë™ ìŠ¤í¬ë¡¤ ê°œì„             |
| 262   | âœ… ì™„ë£Œ | ìë™ ìŠ¤í¬ë¡¤ ë¶„ì„            |
| 261   | âœ… ì™„ë£Œ | dev ë¹Œë“œ ê°€ë…ì„±             |
| 260   | âœ… ì™„ë£Œ | ì˜ì¡´ì„± ì •ë¦¬                 |
| 258   | âœ… ì™„ë£Œ | ë¶€íŠ¸ìŠ¤íŠ¸ë© ìµœì í™”           |
| 257   | âœ… ì™„ë£Œ | events.ts ìµœì í™”            |
| 256   | âœ… ì™„ë£Œ | VerticalImageItem ìµœì í™”    |
| 255   | â¸ï¸ ë³´ë¥˜ | CSS ë ˆê±°ì‹œ í† í° ì •ë¦¬        |

---

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ

- **ì™„ë£Œ ê¸°ë¡**: [TDD_REFACTORING_PLAN_COMPLETED.md](./TDD_REFACTORING_PLAN_COMPLETED.md)
- **ê°œë°œ ê°€ì´ë“œ**: [AGENTS.md](../AGENTS.md)
- **ì•„í‚¤í…ì²˜**: [ARCHITECTURE.md](./ARCHITECTURE.md)
- **ì½”ë”© ê·œì¹™**: [CODING_GUIDELINES.md](./CODING_GUIDELINES.md)
- **í…ŒìŠ¤íŠ¸ ì „ëµ**: [TESTING_STRATEGY.md](./TESTING_STRATEGY.md)

---

ğŸ‰ **í”„ë¡œì íŠ¸ ì™„ì„±!** Phase 277 í…ŒìŠ¤íŠ¸ í¬ê¸° ì •ì±… ì •ê·œí™”ë¡œ ëª¨ë“  ì‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.
