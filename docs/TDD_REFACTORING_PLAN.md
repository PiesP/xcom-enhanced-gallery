# TDD ë¦¬íŒ©í† ë§ í™œì„± ê³„íš

> **ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-10-13
>
> **ë¸Œëœì¹˜**: feature/phase-34-optimization-plan
>
> **ìƒíƒœ**: Phase 34 ê³„íš ìˆ˜ë¦½ ì¤‘ ğŸ“

## í”„ë¡œì íŠ¸ ìƒíƒœ

- **ë¹Œë“œ**: dev 726.49 KB / prod 318.04 KB âœ…
- **í…ŒìŠ¤íŠ¸**: 657/677 passing (24 skipped, 1 todo) âœ…
- **íƒ€ì…**: 0 errors (TypeScript strict) âœ…
- **ë¦°íŠ¸**: 0 warnings âœ…
- **ì˜ì¡´ì„±**: 0 violations (269 modules, 736 dependencies) âœ…

## ì°¸ê³  ë¬¸ì„œ

- `AGENTS.md`: ê°œë°œ í™˜ê²½ ë° ì›Œí¬í”Œë¡œ
- `TDD_REFACTORING_PLAN_COMPLETED.md`: Phase 1-33 ì™„ë£Œ ê¸°ë¡
- `ARCHITECTURE.md`: ì•„í‚¤í…ì²˜ êµ¬ì¡°
- `CODING_GUIDELINES.md`: ì½”ë”© ê·œì¹™

---

## Phase 34: ì½”ë“œ í’ˆì§ˆ í–¥ìƒ ë° ìµœì í™”

### ëª©í‘œ

1. **ë¯¸ì‚¬ìš© ì½”ë“œ ì œê±°**: ì‹¤ì œë¡œ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” export ì œê±°ë¡œ ì½”ë“œë² ì´ìŠ¤ ì •ë¦¬
2. **ëŒ€í˜• íŒŒì¼ ë¦¬íŒ©í† ë§**: 23KB+ íŒŒì¼ë“¤ì„ ì±…ì„ë³„ë¡œ ë¶„ë¦¬í•˜ì—¬ ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ

### ìš°ì„ ìˆœìœ„

**Phase 34 Step 1** â†’ ë¯¸ì‚¬ìš© Export ì œê±° (ë¹ ë¥¸ ì„±ê³¼)  
**Phase 34 Step 2** â†’ ëŒ€í˜• íŒŒì¼ ë¦¬íŒ©í† ë§ (êµ¬ì¡° ê°œì„ )

---

## Phase 34 Step 1: ë¯¸ì‚¬ìš© Export ì œê±° ğŸ¯

**ë¸Œëœì¹˜**: `feature/phase-34-step-1-unused-exports`

### ë°°ê²½

`style-utils.ts`ì— 2ê°œ í•¨ìˆ˜ê°€ exportëŠ” ë˜ì§€ë§Œ ì‹¤ì œë¡œëŠ” ì‚¬ìš©ë˜ì§€ ì•ŠìŒ:

- `getCSSVariable`: CSS ë³€ìˆ˜ ì¡°íšŒ í•¨ìˆ˜
- `applyTheme`: í…Œë§ˆ í´ë˜ìŠ¤ ì ìš© í•¨ìˆ˜

### ì˜í–¥ ë¶„ì„

**í˜„ì¬ ìƒíƒœ**:

- `style-utils.ts` (33ì¤„): re-export 6ê°œ + ë…ë¦½ í•¨ìˆ˜ 2ê°œ
- `index.ts`ì—ì„œ ì¬exportë˜ì–´ public APIë¡œ ë…¸ì¶œë¨
- ì‹¤ì œ ì‚¬ìš©ì²˜: 0ê°œ (ì •ì˜ ë° exportë§Œ ì¡´ì¬)

**ì˜ˆìƒ íš¨ê³¼**:

- ì†ŒìŠ¤ ì½”ë“œ ì •ë¦¬: ~20 lines ê°ì†Œ
- ë²ˆë“¤ í¬ê¸°: ë³€í™” ì—†ìŒ (tree-shaking ì´ë¯¸ ìµœì í™”ë¨)
- API ëª…í™•ì„±: ì‚¬ìš©ë˜ëŠ” í•¨ìˆ˜ë§Œ export
- ìœ ì§€ë³´ìˆ˜ì„±: ë¶ˆí•„ìš”í•œ ì½”ë“œ ê´€ë¦¬ ë¶€ë‹´ ê°ì†Œ

### TDD ê³„íš

#### Step 1-A: RED - ë¯¸ì‚¬ìš© Export ê°ì§€ í…ŒìŠ¤íŠ¸

**í…ŒìŠ¤íŠ¸ íŒŒì¼**: `test/unit/refactoring/unused-exports-removal.test.ts`

```typescript
describe('Unused Exports Detection - style-utils.ts', () => {
  it('should detect getCSSVariable is not used in codebase', async () => {
    // ì½”ë“œë² ì´ìŠ¤ ì „ì²´ ìŠ¤ìº”
    // getCSSVariable ì‚¬ìš©ì²˜ê°€ ì •ì˜/export ì™¸ì— ì—†ì–´ì•¼ í•¨
  });

  it('should detect applyTheme is not used in codebase', async () => {
    // ì½”ë“œë² ì´ìŠ¤ ì „ì²´ ìŠ¤ìº”
    // applyTheme ì‚¬ìš©ì²˜ê°€ ì •ì˜/export ì™¸ì— ì—†ì–´ì•¼ í•¨
  });

  it('should verify other exports are still used', () => {
    // combineClasses, toggleClass ë“±ì€ ì‹¤ì œë¡œ ì‚¬ìš©ë¨ì„ í™•ì¸
  });
});
```

**ì˜ˆìƒ ê²°ê³¼**: RED (2ê°œ í•¨ìˆ˜ê°€ ë¯¸ì‚¬ìš©ìœ¼ë¡œ ê²€ì¶œ)

#### Step 1-B: GREEN - ë¯¸ì‚¬ìš© í•¨ìˆ˜ ì œê±°

**ë³€ê²½ ëŒ€ìƒ íŒŒì¼**:

1. `src/shared/utils/styles/style-utils.ts`:
   - `getCSSVariable` í•¨ìˆ˜ ì œê±°
   - `applyTheme` í•¨ìˆ˜ ì œê±°
   - ì£¼ì„ ì—…ë°ì´íŠ¸: "CSS ìœ í‹¸ë¦¬í‹° re-export only"
2. `src/shared/utils/styles/index.ts`:
   - `getCSSVariable` export ì œê±°
   - `applyTheme` export ì œê±°

**ê²€ì¦**:

- í…ŒìŠ¤íŠ¸: GREEN ì „í™˜ í™•ì¸
- íƒ€ì… ì²´í¬: `npm run typecheck`
- ì „ì²´ í…ŒìŠ¤íŠ¸: `npm test`
- ë¹Œë“œ: `npm run build`

#### Step 1-C: REFACTOR - ë¬¸ì„œ ë° ì£¼ì„ ì •ë¦¬

- `style-utils.ts` íŒŒì¼ í—¤ë” ì£¼ì„ ê°„ì†Œí™”
- ë‚¨ì€ re-export í•¨ìˆ˜ë“¤ì˜ ì—­í•  ëª…í™•í™”
- ë³€ê²½ ì´ë ¥ ì»¤ë°‹ ë©”ì‹œì§€ ì‘ì„±

### ì˜ˆìƒ ì‚°ì¶œë¬¼

| í•­ëª©           | Before | After | ë³€í™”       |
| -------------- | ------ | ----- | ---------- |
| style-utils.ts | 33ì¤„   | ~13ì¤„ | -20ì¤„      |
| index.ts       | 22ì¤„   | ~20ì¤„ | -2ì¤„       |
| ë¯¸ì‚¬ìš© export  | 2ê°œ    | 0ê°œ   | -2ê°œ âœ…    |
| ë²ˆë“¤ í¬ê¸°      | 318KB  | 318KB | 0KB (ì˜ˆìƒ) |

---

## Phase 34 Step 2: ëŒ€í˜• íŒŒì¼ ë¦¬íŒ©í† ë§ ğŸ¯

**ë¸Œëœì¹˜**: `feature/phase-34-step-2-large-files`

### ë°°ê²½

4ê°œ íŒŒì¼ì´ 20KB ì´ìƒìœ¼ë¡œ ë‹¨ì¼ ì±…ì„ ì›ì¹™ ê²€í†  í•„ìš”:

1. **events.ts** (717ì¤„, 23.73 KB): í†µí•© ì´ë²¤íŠ¸ ê´€ë¦¬
2. **accessibility-utils.ts** (790ì¤„, 23.25 KB): ì ‘ê·¼ì„± ìœ í‹¸ë¦¬í‹°
3. **url-patterns.ts** (847ì¤„, 23.19 KB): URL íŒ¨í„´ ë§¤ì¹­
4. **media-service.ts** (720ì¤„, 21.35 KB): ë¯¸ë””ì–´ ì„œë¹„ìŠ¤

### ë¦¬íŒ©í† ë§ ì „ëµ

ê° íŒŒì¼ì˜ ì±…ì„ì„ ë¶„ì„í•˜ê³  í•„ìš” ì‹œ ë¶„í• í•©ë‹ˆë‹¤.

#### Step 2-A: events.ts ë¶„ì„ ë° ë¶„í• 

**í˜„ì¬ êµ¬ì¡°** (ì¶”ì •):

- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ê´€ë¦¬
- ê°¤ëŸ¬ë¦¬ ì´ë²¤íŠ¸ í•¸ë“¤ë§
- í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜
- ë¹„ë””ì˜¤ ì¬ìƒ ì œì–´
- íŠ¸ìœ„í„° ë„¤ì´í‹°ë¸Œ ê°¤ëŸ¬ë¦¬ ê°ì§€

**ë¶„í•  í›„ë³´**:

```
shared/utils/events/
  â”œâ”€â”€ event-manager.ts          // ë¦¬ìŠ¤ë„ˆ ë“±ë¡/í•´ì œ (core)
  â”œâ”€â”€ gallery-event-handlers.ts // ê°¤ëŸ¬ë¦¬ ì „ìš© í•¸ë“¤ëŸ¬
  â”œâ”€â”€ keyboard-handlers.ts      // í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜
  â”œâ”€â”€ video-handlers.ts         // ë¹„ë””ì˜¤ ì œì–´
  â””â”€â”€ twitter-detection.ts      // íŠ¸ìœ„í„° ë„¤ì´í‹°ë¸Œ ê°ì§€
```

**TDD ì ‘ê·¼**:

1. RED: íŒŒì¼ í¬ê¸° ê°€ë“œ í…ŒìŠ¤íŠ¸ (500ì¤„ ì œí•œ)
2. GREEN: ì±…ì„ë³„ë¡œ ëª¨ë“ˆ ë¶„ë¦¬
3. REFACTOR: import ê²½ë¡œ ì •ë¦¬, í…ŒìŠ¤íŠ¸ ë³´ê°•

**ì˜ˆìƒ íš¨ê³¼**:

- ê° ëª¨ë“ˆ: ~150-200ì¤„
- ì±…ì„ ë¶„ë¦¬ë¡œ í…ŒìŠ¤íŠ¸ ìš©ì´ì„± í–¥ìƒ
- ë³€ê²½ ì˜í–¥ ë²”ìœ„ ê°ì†Œ

#### Step 2-B: accessibility-utils.ts ë¶„ì„ ë° ë¶„í• 

**í˜„ì¬ êµ¬ì¡°** (ì¶”ì •):

- ìƒ‰ìƒ ëŒ€ë¹„ ê³„ì‚° (WCAG)
- ìƒëŒ€ íœ˜ë„ ê³„ì‚°
- ìƒ‰ìƒ íŒŒì‹± (RGB, HEX)
- í¬ì»¤ìŠ¤ ê´€ë¦¬
- ìŠ¤í¬ë¦° ë¦¬ë” ì§€ì›

**ë¶„í•  í›„ë³´**:

```
shared/utils/accessibility/
  â”œâ”€â”€ contrast-calculator.ts    // ëŒ€ë¹„ ë¹„ìœ¨ ê³„ì‚°
  â”œâ”€â”€ color-parser.ts           // ìƒ‰ìƒ íŒŒì‹± ìœ í‹¸
  â”œâ”€â”€ focus-management.ts       // í¬ì»¤ìŠ¤ ê´€ë¦¬ (ì´ë¯¸ ë¶„ë¦¬?)
  â””â”€â”€ aria-helpers.ts           // ARIA ì†ì„± í—¬í¼
```

**TDD ì ‘ê·¼**:

1. RED: ìƒ‰ìƒ ê´€ë ¨/í¬ì»¤ìŠ¤ ê´€ë ¨ ì±…ì„ ë¶„ë¦¬ í…ŒìŠ¤íŠ¸
2. GREEN: ê¸°ëŠ¥ë³„ ëª¨ë“ˆ ë¶„ë¦¬
3. REFACTOR: ê° ëª¨ë“ˆì˜ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ í™•ì¸

#### Step 2-C: url-patterns.ts ë¶„ì„ ë° ë¶„í• 

**í˜„ì¬ êµ¬ì¡°** (ì¶”ì •):

- íŠ¸ìœ— URL íŒ¨í„´
- ë¯¸ë””ì–´ URL íŒ¨í„´
- ì´ë¯¸ì§€/ë¹„ë””ì˜¤ URL ê°ì§€
- URL íŒŒì‹± ìœ í‹¸ë¦¬í‹°

**ë¶„í•  í›„ë³´**:

```
shared/utils/patterns/
  â”œâ”€â”€ tweet-patterns.ts         // íŠ¸ìœ— URL íŒ¨í„´
  â”œâ”€â”€ media-patterns.ts         // ë¯¸ë””ì–´ URL íŒ¨í„´
  â”œâ”€â”€ url-matchers.ts           // URL ë§¤ì¹­ ë¡œì§
  â””â”€â”€ url-extractors.ts         // URL ì •ë³´ ì¶”ì¶œ
```

**íŒë‹¨ ê¸°ì¤€**:

- í˜„ì¬ êµ¬ì¡°ê°€ "URLPatterns ê°ì²´ í•˜ë‚˜ì— ëª¨ë“  íŒ¨í„´" í˜•íƒœë¼ë©´ ìœ ì§€
- ë³µì¡í•œ íŒŒì‹± ë¡œì§ì´ í¬í•¨ë˜ì–´ ìˆë‹¤ë©´ ë¶„ë¦¬ ê²€í† 

#### Step 2-D: media-service.ts ê²€í† 

**ìƒíƒœ**: Phase 33 Step 2Cì—ì„œ ì´ë¯¸ ìµœì í™”ë¨ (975ì¤„ â†’ 613ì¤„ â†’ 720ì¤„)

**í˜„ì¬ í¬ê¸°**: 21.35 KB (720ì¤„)

**íŒë‹¨**:

- ì´ë¯¸ ì£¼ì„ ì œê±° ë° ìµœì í™” ì™„ë£Œ
- 720ì¤„ì€ ì„œë¹„ìŠ¤ ë ˆì´ì–´ë¡œ ìˆ˜ìš© ê°€ëŠ¥í•œ í¬ê¸°
- ì¶”ê°€ ë¶„í•  í•„ìš”ì„± ë‚®ìŒ

**Action**: Step 2-DëŠ” ìƒëµ ë˜ëŠ” ê²€í† ë§Œ ìˆ˜í–‰

### Phase 34 Step 2 ìš°ì„ ìˆœìœ„

1. **events.ts** (ìµœìš°ì„ ): ê°€ì¥ í¬ê³  ì±…ì„ì´ ë§ìŒ
2. **accessibility-utils.ts** (ì¤‘ìš”): WCAG ê³„ì‚° ë¡œì§ ë¶„ë¦¬ ê°€ì¹˜ ìˆìŒ
3. **url-patterns.ts** (ê²€í† ): í˜„ì¬ êµ¬ì¡° í™•ì¸ í›„ ê²°ì •
4. **media-service.ts** (ìƒëµ): ì´ë¯¸ ìµœì í™”ë¨

### TDD ì§„í–‰ ìˆœì„œ

**Phase 34 Step 2-1: events.ts ë¦¬íŒ©í† ë§**

1. RED: íŒŒì¼ í¬ê¸°/ì±…ì„ ë¶„ë¦¬ í…ŒìŠ¤íŠ¸
2. GREEN: 5ê°œ ëª¨ë“ˆë¡œ ë¶„í• 
3. REFACTOR: í…ŒìŠ¤íŠ¸ ë³´ê°• ë° ë¬¸ì„œí™”

**Phase 34 Step 2-2: accessibility-utils.ts ë¦¬íŒ©í† ë§**

1. RED: ìƒ‰ìƒ/í¬ì»¤ìŠ¤ ì±…ì„ ë¶„ë¦¬ í…ŒìŠ¤íŠ¸
2. GREEN: 4ê°œ ëª¨ë“ˆë¡œ ë¶„í• 
3. REFACTOR: WCAG ê³„ì‚° ë¡œì§ ê²€ì¦ ê°•í™”

**Phase 34 Step 2-3: url-patterns.ts ê²€í† **

1. í˜„ì¬ êµ¬ì¡° ë¶„ì„
2. ë¶„í•  í•„ìš”ì„± íŒë‹¨
3. í•„ìš” ì‹œ ë¦¬íŒ©í† ë§, ì•„ë‹ˆë©´ í˜„ì¬ êµ¬ì¡° ìœ ì§€

---

## ì‘ì—… ìˆœì„œ ìš”ì•½

```
1. Phase 34 Step 1: ë¯¸ì‚¬ìš© Export ì œê±°
   â”œâ”€ Step 1-A: RED (unused-exports-removal.test.ts)
   â”œâ”€ Step 1-B: GREEN (í•¨ìˆ˜ 2ê°œ ì œê±°)
   â””â”€ Step 1-C: REFACTOR (ë¬¸ì„œ ì •ë¦¬)

2. Phase 34 Step 2: ëŒ€í˜• íŒŒì¼ ë¦¬íŒ©í† ë§
   â”œâ”€ Step 2-1: events.ts â†’ 5ê°œ ëª¨ë“ˆ
   â”œâ”€ Step 2-2: accessibility-utils.ts â†’ 4ê°œ ëª¨ë“ˆ
   â””â”€ Step 2-3: url-patterns.ts ê²€í†  ë° í•„ìš” ì‹œ ë¶„í• 
```

---

## ë‹¤ìŒ ì‘ì—…

**ì¦‰ì‹œ ì‹œì‘ ê°€ëŠ¥**: Phase 34 Step 1 (ë¯¸ì‚¬ìš© Export ì œê±°)

- ë¸Œëœì¹˜ ìƒì„±: `git checkout -b feature/phase-34-step-1-unused-exports`
- í…ŒìŠ¤íŠ¸ ì‘ì„±: `test/unit/refactoring/unused-exports-removal.test.ts`
- TDD ì‚¬ì´í´ ì§„í–‰: RED â†’ GREEN â†’ REFACTOR

---

**ì´ì „ ì™„ë£Œ Phase**: Phase 1-33 â†’ `TDD_REFACTORING_PLAN_COMPLETED.md` ì°¸ì¡°
