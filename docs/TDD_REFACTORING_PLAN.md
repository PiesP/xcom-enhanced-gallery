# TDD 리팩토링 활성 계획

> **최종 업데이트**: 2025-10-18 | **상태**: Phase 102 완료, Phase 103+ 우선순위
> 재평가 필요 📋

## 프로젝트 현황

### 빌드 및 품질 지표

- **빌드**: 330.42 KB / 335 KB (4.58 KB 여유, 98.6%) ⚠️
- **타입**: TypeScript strict, 0 errors ✅
- **린트**: ESLint 0 warnings, Markdown 0 errors ✅
- **CSS 린트**: stylelint 0 warnings ✅
- **CodeQL**: 5/5 쿼리 통과, 병렬 실행 109.78초 ✅
- **의존성**: 0 violations (263 modules, 736 dependencies) ✅

### 테스트 현황

- **단위 테스트**: 1081 passing / 10 skipped (99.1% 통과율) ✅
- **E2E 테스트**: 28 passed / 1 skipped (96.6% 통과율) ✅
- **커버리지**: v8로 통일 완료, 45% 기준선 설정 ✅

### 코드 품질

- **로깅 일관성**: console 직접 사용 0건 (logger.ts 경유) ✅
- **디자인 토큰**: px 하드코딩 0개, rgba 0개, oklch 전용 ✅
- **브라우저 지원**: Safari 14+, Chrome 110+ (OKLCH 폴백 적용) ✅
- **타입 단언**: **27개** (Phase 102: 설계상 필수 8개 재분류, 실제 제거 2개) ⚠️

### 완료된 Phase (최근 5개)

| Phase | 주제                             | 완료일     | 결과                                 |
| ----- | -------------------------------- | ---------- | ------------------------------------ |
| 98    | Icon Registry 타입 안전성        | 2025-10-17 | 타입 단언 5개 제거                   |
| 99    | Signal 타입 단언 제거            | 2025-10-17 | 타입 단언 7개 제거 (38→31)           |
| 100   | 타입 단언 전수 조사              | 2025-10-17 | 31개 분석, 우선순위 결정             |
| 101   | 즉시 제거 7개                    | 2025-10-17 | 타입 단언 7개 제거 (31→24), 22% 감소 |
| 102   | 검토 후 제거 가능 타입 단언 10개 | 2025-10-18 | 실제 2개 제거 (24→27), 8개 재분류    |

> 상세 내용:
> [`TDD_REFACTORING_PLAN_COMPLETED.md`](./TDD_REFACTORING_PLAN_COMPLETED.md)

##

## 활성 Phase

## Phase 103+: 보류/대안 필요 타입 단언 25개 ⏸️

**우선순위**: 검토 필요 | **위험도**: 높음 | **상태**: 우선순위 재평가

### 현황

Phase 102에서 다음 타입 단언 8개를 재분류함:

- **Settings 서비스 DI**: 4개 (설계상 필수, 중첩 객체 경로 접근)
- **DOM 캐시**: 2개 (설계상 필수, NodeListOf/Element 통합 저장)
- **기타 재분류 필요**: 2개

### 보류 이유

| 카테고리             | 개수 | 이유                       |
| -------------------- | ---- | -------------------------- |
| 타입 시스템 한계     | 6개  | 조건부 타입, 제네릭 제약   |
| 구조적 개선 필요     | 6개  | DI 패턴, 캐시 재설계       |
| 타입 라이브러리 제약 | 5개  | 외부 의존성 타입 정의 미흡 |

---

## 우선순위 재평가

Phase 102 완료 후:

✅ **즉시 제거 가능한 타입 단언**: 모두 완료 (Phase 101-102)  
⚠️ **설계 개선 필요**: 8개 (문서화 완료, 아키텍처 리팩토링은 범위 재정의 필요)  
⏸️ **장기 계획**: 15개 (타입 시스템/구조 개선, 별도 Phase로 분리 필요)

### 다음 작업 제안

1. **Phase 103**: 필수 타입 단언 문서화 (인라인 주석)
2. **Phase 104+**: 아키텍처 리팩토링 계획 (범위 재정의 후)

---

## 참고 문서

- **[TDD_REFACTORING_PLAN_COMPLETED.md](./TDD_REFACTORING_PLAN_COMPLETED.md)**:
  완료된 Phase 97-102 상세 기록
- **[AGENTS.md](../AGENTS.md)**: 개발 워크플로우, 스크립트 사용법
- **[ARCHITECTURE.md](./ARCHITECTURE.md)**: 3계층 구조
- **[CODING_GUIDELINES.md](./CODING_GUIDELINES.md)**: 코딩 규칙

> **업데이트**: 2025-10-18 | Phase 102 완료, 문서화 최신화

| ----------------------- | ---- | ---------------------------------- | |
EventListener 타입 변환 | 6 | 브라우저 타입 불일치 (시스템 설계) | | 브라우저
API 타입 확장 | 6 | GM\_\* API 타입 불완전성 | | 기타 타입 변환 | 3 | 서드파티
라이브러리 제약 |

> **상세 분석**:
> [`docs/phase-100-type-assertion-analysis.md`](./phase-100-type-assertion-analysis.md)

**재평가 조건**: 타입 시스템 한계 해결 또는 라이브러리 타입 개선 시 검토

##

## 유지 관리 모드 ✅

### 주요 활동

- 사용자 피드백 모니터링
- 버그 리포트 대응
- 의존성 보안 업데이트 (`npm audit`)
- 정기 유지보수 점검 (`npm run maintenance:check`)

### 경계 조건

| 지표           | 임계값     | 현재 상태               | 조치            |
| -------------- | ---------- | ----------------------- | --------------- |
| 번들 크기      | 335 KB     | 330.42 KB (98.6%)       | 4.58 KB 여유 ⚠️ |
| 테스트 Skipped | 20개       | 10개 (단위) + 1개 (E2E) | 정상 범위 ✅    |
| 테스트 통과율  | 95%        | 99.1% / 96.6%           | 우수 ✅         |
| 문서 크기      | 500줄/파일 | PLAN 830줄 → 신규 작성  | 간소화 완료 ✅  |

### 주기별 점검

**주간**: 번들 크기, 테스트 통과율, Skipped 수 **월간**: 의존성 보안, 문서
최신성, maintenance 점검 **분기**: 아키텍처 리뷰, 성능 벤치마크, 사용자 피드백
분석

##

## 참고 문서

- **[TDD_REFACTORING_PLAN_COMPLETED.md](./TDD_REFACTORING_PLAN_COMPLETED.md)**:
  완료된 Phase 97-101 상세 기록
- **[AGENTS.md](../AGENTS.md)**: 개발 워크플로우, 스크립트 사용법
- **[ARCHITECTURE.md](./ARCHITECTURE.md)**: 3계층 구조
- **[CODING_GUIDELINES.md](./CODING_GUIDELINES.md)**: 코딩 규칙
- **[TESTING_STRATEGY.md](./TESTING_STRATEGY.md)**: Testing Trophy, E2E 하네스
  패턴
- **[MAINTENANCE.md](./MAINTENANCE.md)**: 유지보수 체크리스트

##

> **유지보수 정책**: 이 문서는 활성 Phase만 포함. 완료 시 즉시
> `TDD_REFACTORING_PLAN_COMPLETED.md`로 이관. 500줄 초과 시 간소화 검토.
