# ğŸ” src/shared/hooks ê°ì‹œ ë³´ê³ ì„œ

**ë‚ ì§œ**: 2025-10-26  
**ë²”ìœ„**: `src/shared/hooks/` ì „ì²´ íŒŒì¼ ê°ì‹œ ë° ìµœì í™” ì œì•ˆ

---

## ğŸ“Š í˜„í™© ìš”ì•½

### ë””ë ‰í„°ë¦¬ êµ¬ì¡°

```
src/shared/hooks/
â”œâ”€â”€ index.ts                              (í™œì„±, ë‚´ë³´ë‚´ê¸° ê´€ë¦¬)
â”œâ”€â”€ use-focus-trap.ts                    (í™œì„±, KeyboardHelpOverlay ì‚¬ìš©)
â”œâ”€â”€ use-toolbar-state.ts                 (í™œì„±, Toolbar ì‚¬ìš©)
â”œâ”€â”€ use-gallery-toolbar-logic.ts         (ë¯¸ì‚¬ìš©, í›… ì œê±° í›„ë³´)
â””â”€â”€ toolbar/
    â””â”€â”€ use-toolbar-settings-controller.ts  (í™œì„±, Toolbar ì‚¬ìš©)
```

### íŒŒì¼ ë¶„ì„

| íŒŒì¼                               | ì¤„ ìˆ˜ | ìƒíƒœ      | ì‚¬ìš©ì²˜                    | ë“±ê¸‰        | ê²€í†  í•„ìš”      |
| ---------------------------------- | ----- | --------- | ------------------------- | ----------- | -------------- |
| use-focus-trap.ts                  | 119   | âœ… í™œì„±   | KeyboardHelpOverlay (1ê°œ) | ì–‘í˜¸        | íƒ€ì… ê°œì„       |
| use-toolbar-state.ts               | 226   | âœ… í™œì„±   | Toolbar (1ê°œ)             | ì–‘í˜¸        | í—¬í¼ ë¶„ë¦¬ ê²€í†  |
| use-gallery-toolbar-logic.ts       | 212   | âŒ ë¯¸ì‚¬ìš© | ì—†ìŒ                      | ì‚­ì œ ëŒ€ìƒ   | ì¦‰ì‹œ ì œê±°      |
| use-toolbar-settings-controller.ts | 426   | âœ… í™œì„±   | Toolbar (1ê°œ)             | ë³µì¡ë„ ë†’ìŒ | ë‹¨ìˆœí™” í•„ìš”    |

---

## âš ï¸ ì£¼ìš” ë°œê²¬ ì‚¬í•­

### 1. ë¯¸ì‚¬ìš© íŒŒì¼: use-gallery-toolbar-logic.ts

**ìƒíƒœ**: ì „í˜€ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ  
**ì´ìœ **: Phase 140.2 ë¯¸ì‚¬ìš© í›… ì œê±° ì´í›„ exportë˜ì§€ ì•ŠìŒ

```
index.tsì—ì„œ exportë˜ì§€ ì•ŠìŒ (ì£¼ì„ ì²˜ë¦¬ë¨)
// export { useGalleryToolbarLogic } from './use-gallery-toolbar-logic';
```

**ì•¡ì…˜**: ğŸ—‘ï¸ **ì¦‰ì‹œ ì‚­ì œ ê¶Œê³ **

- í…ŒìŠ¤íŠ¸ íŒŒì¼ë„ archiveë¡œ ì´ë™ë˜ì—ˆìŒ (test/archive/ì— ìˆìŒ)
- 120ì¤„ ì´ìƒì˜ dead code
- ì €ì¥ì†Œ ì •ë¦¬ ë°©í•´

---

### 2. êµ¬ì¡°ì  ë¬¸ì œ: 3ê°œ í›…ì´ í•˜ë‚˜ì˜ ì»´í¬ë„ŒíŠ¸ì— ì¢…ì†

**í˜„í™©**: `src/shared/components/ui/Toolbar/Toolbar.tsx`ì—ì„œ

- `useToolbarState()` í˜¸ì¶œ
- `useToolbarSettingsController()` í˜¸ì¶œ
- ë¡œì§ì´ Toolbar ì»´í¬ë„ŒíŠ¸ ìì²´ì— í¬í•¨ë¨

**ë¬¸ì œì **:

- í›…ë“¤ì´ Toolbar ì»´í¬ë„ŒíŠ¸ì™€ ê°•í•˜ê²Œ ê²°í•©ë¨
- ì¬ì‚¬ìš©ì„± ë‚®ìŒ (Toolbar ì™¸ ë‹¤ë¥¸ ê³³ì—ì„œ ì“¸ ìˆ˜ ì—†ìŒ)
- ì±…ì„ì´ íë¦¿í•¨ (í›… vs ì»´í¬ë„ŒíŠ¸ ë¡œì§ ê²½ê³„ ëª¨í˜¸)

**ì œì•ˆ**: ì•„í‚¤í…ì²˜ ë¦¬ë·° í›„

- ìƒíƒœ ê´€ë¦¬ë¥¼ `shared/state`ë¡œ ì´ë™ ê³ ë ¤
- í›…ì„ ì»´í¬ë„ŒíŠ¸ë³„ ë¡œì»¬ ë¡œì§ìœ¼ë¡œ ë‹¨ìˆœí™”

---

### 3. íŒŒì¼ ìœ„ì¹˜ ì¬ê²€í†  í•„ìš”

#### use-toolbar-state.ts (226ì¤„)

**í˜„ì¬ ìœ„ì¹˜**: `src/shared/hooks/use-toolbar-state.ts`  
**ê²€í†  ì‚¬í•­**:

- ìˆœìˆ˜ ìƒíƒœ ê´€ë¦¬ ë¡œì§ (Signal ìƒì„±, ìƒíƒœ ë³€ê²½)
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ì ìŒ
- **ì œì•ˆ**: `shared/state/toolbar-state-machine.ts`ë¡œ ì´ë™ ê²€í† 

**ê·¼ê±°**:

- `shared/state/`ì—ëŠ” ì´ë¯¸:
  - `app-state.ts`
  - `download-state-machine.ts`
  - `navigation-state-machine.ts`
  - `settings-state-machine.ts`
  - `toast-state-machine.ts`

- íŒ¨í„´ ì¼ê´€ì„±: ìƒíƒœ/ìƒíƒœë¨¸ì‹ ì€ `state/` í´ë”ì—

#### use-toolbar-settings-controller.ts (426ì¤„)

**í˜„ì¬ ìœ„ì¹˜**: `src/shared/hooks/toolbar/use-toolbar-settings-controller.ts`  
**ê²€í†  ì‚¬í•­**:

- ë³µì¡í•œ ì´ë²¤íŠ¸ ì²˜ë¦¬ ë¡œì§ (scroll, outside-click, keyboard)
- UI ì œì–´ ë¡œì§ì´ ê°•í•¨ (í¬ì»¤ìŠ¤, íŒ¨ë„ í† ê¸€)
- **ì œì•ˆ**: ìœ„ì¹˜ëŠ” ê·¸ëŒ€ë¡œ, í•˜ì§€ë§Œ **ë‹¨ìˆœí™”** ë° **ì±…ì„ ë¶„ë¦¬** í•„ìš”

**ê°œì„  ì˜ì—­**:

1. ê³ ëŒ€ë¹„ ê°ì§€ ë¡œì§ ë¶„ë¦¬ â†’ `shared/services/contrast-detection.ts`
2. ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë¶„ë¦¬ â†’ ê°ê° ë³„ë„ í•¨ìˆ˜ë¡œ
3. íƒ€ì… ë‹¨ìˆœí™” â†’ ë¶ˆí•„ìš”í•œ íƒ€ì… ì œê±°

#### use-focus-trap.ts (119ì¤„)

**í˜„ì¬ ìœ„ì¹˜**: `src/shared/hooks/use-focus-trap.ts`  
**ê²€í† **: âœ… ì ì ˆí•œ ìœ„ì¹˜

- ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ë…ë¦½ì  í›…
- í•˜ë‚˜ì˜ ì±…ì„ë§Œ ìˆ˜í–‰
- í†µí•© ìœ í‹¸(`shared/utils/focus-trap.ts`)ì— ìœ„ì„

---

## ğŸ¯ ì•¡ì…˜ í”Œëœ

### Phase 1: ê¸´ê¸‰ (1-2ì¼)

- [ ] `use-gallery-toolbar-logic.ts` ì‚­ì œ
  - íŒŒì¼ ì‚­ì œ
  - `index.ts` export ì œê±° (ì´ë¯¸ ì£¼ì„ ì²˜ë¦¬ë¨)
  - í…ŒìŠ¤íŠ¸ íŒŒì¼ í™•ì¸ (archiveì— ìˆì–´ì•¼ í•¨)
  - ì°¸ì¡° ì¬ê²€ì‚¬ (grep)

### Phase 2: ë‹¨ê¸° (3-5ì¼)

- [ ] `use-toolbar-state.ts` í—¬í¼ í•¨ìˆ˜ ë¶„ë¦¬
  - `getToolbarDataState()`, `getToolbarClassName()` ì¶”ì¶œ
  - ìƒˆ íŒŒì¼: `shared/utils/toolbar-utils.ts` ìƒì„±
  - import ê²½ë¡œ ì—…ë°ì´íŠ¸
  - í…ŒìŠ¤íŠ¸ ì—…ë°ì´íŠ¸

### Phase 3: ì¤‘ê¸° (1ì£¼)

- [ ] `use-toolbar-settings-controller.ts` ë‹¨ìˆœí™”
  - ê³ ëŒ€ë¹„ ê°ì§€ ë¡œì§ ì¶”ì¶œ
  - ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë¶„ë¦¬
  - íƒ€ì… ì •ë¦¬
  - ë³µì¡ë„ 50% ê°ì†Œ ëª©í‘œ

### Phase 4: ì•„í‚¤í…ì²˜ ê²€í†  (2ì£¼)

- [ ] ìƒíƒœ ê´€ë¦¬ ê³„ì¸µí™” ê²€í† 
  - `use-toolbar-state` â†’ `shared/state/toolbar-state-machine.ts`?
  - ë‹¤ë¥¸ ìƒíƒœë¨¸ì‹ ê³¼ì˜ íŒ¨í„´ ì¼ê´€ì„± í™•ì¸
  - ARCHITECTURE.md ì—…ë°ì´íŠ¸

---

## ğŸ“ ë¬¸ì„œ ì—…ë°ì´íŠ¸ í•„ìš”

### ARCHITECTURE.md

- [ ] `shared/hooks/` í´ë” ì„¤ëª… ì¶”ê°€/ê°±ì‹ 
- [ ] í›… vs ì„œë¹„ìŠ¤ vs ìƒíƒœì˜ ì±…ì„ ê²½ê³„ ëª…í™•í™”
- [ ] íŒŒì¼ ìœ„ì¹˜ ê°€ì´ë“œë¼ì¸ ì¶”ê°€

### CODING_GUIDELINES.md

- [ ] í›… ì‘ì„± ê·œì¹™ ì„¹ì…˜ ì¶”ê°€
- [ ] í›…ì˜ ì ì ˆí•œ í¬ê¸°/ë³µì¡ë„ ê°€ì´ë“œë¼ì¸
- [ ] "ì–¸ì œ í›…ì„ ì“¸ê¹Œ, ì–¸ì œ ì„œë¹„ìŠ¤ë¥¼ ì“¸ê¹Œ" ì˜ì‚¬ê²°ì • íŠ¸ë¦¬

---

## ğŸ“Œ ìš”ì•½

| í•­ëª©      | í˜„í™©                           | ìš°ì„ ìˆœìœ„   |
| --------- | ------------------------------ | ---------- |
| íŒŒì¼ ì •ë¦¬ | use-gallery-toolbar-logic ì‚­ì œ | ğŸ”´ ê¸´ê¸‰    |
| ì½”ë“œ í’ˆì§ˆ | í—¬í¼ í•¨ìˆ˜ ë¶„ë¦¬, ë³µì¡ë„ ê°ì†Œ    | ğŸŸ¡ ì¤‘ìš”    |
| ì•„í‚¤í…ì²˜  | ìƒíƒœ ê´€ë¦¬ ê³„ì¸µí™” ê²€í†           | ğŸŸ¢ ì§„í–‰ ì¤‘ |
| ë¬¸ì„œí™”    | í›… ê°€ì´ë“œë¼ì¸ ì¶”ê°€ í•„ìš”        | ğŸŸ¡ ì¤‘ìš”    |

---

**ì‘ì„±ì**: GitHub Copilot  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-10-26
