# í…ŒìŠ¤íŠ¸ ì „ëµ ê°€ì´ë“œ (Testing Strategy)

> xcom-enhanced-gallery í”„ë¡œì íŠ¸ì˜ í…ŒìŠ¤íŠ¸ ì±…ì„ ë¶„ë¦¬ ë° ì‹¤í–‰ ì „ëµ

**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-10-29 (Phase 234 ê°„ì†Œí™”)

---

## ğŸ“Š í…ŒìŠ¤íŠ¸ í”¼ë¼ë¯¸ë“œ (Testing Trophy)

Kent C. Doddsì˜ Testing Trophy ëª¨ë¸ ê¸°ë°˜:

```text
          /\
         /A11y\        â† ìµœì†Œ: ì ‘ê·¼ì„± ìë™ ê²€ì¦ (WCAG 2.1 AA)
        /------\
       /  E2E  \       â† ì ìŒ: í•µì‹¬ ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤ (Playwright)
      /----------\
     / Browser    \    â† ì†ŒëŸ‰: Solid.js ë°˜ì‘ì„±, ì‹¤ì œ API (Vitest + Chromium)
    /--------------\
   /  Integration  \   â† ì¤‘ê°„: ì„œë¹„ìŠ¤ ê°„ ìƒí˜¸ì‘ìš© (JSDOM + ëª¨í‚¹)
  /------------------\
 /    Unit Tests     \ â† ë§ìŒ: ìˆœìˆ˜ ë¡œì§, ìœ í‹¸ë¦¬í‹° (JSDOM)
/----------------------\
/  Static Analysis     \  â† ê°€ì¥ ë§ìŒ: TypeScript, ESLint, stylelint
/------------------------\
/  Security Analysis    \  â† ê¸°ë°˜: CodeQL (ë³´ì•ˆ ì·¨ì•½ì  ê²€ì¦)
```

**ì›ì¹™**: ë‚®ì€ ê³„ì¸µì—ì„œ ë¹ ë¥´ê²Œ ë§ì´ í…ŒìŠ¤íŠ¸, ë†’ì€ ê³„ì¸µì—ì„œ ëŠë¦¬ì§€ë§Œ ì‹ ë¢°ë„ ë†’ì€
í…ŒìŠ¤íŠ¸ë¥¼ ì„ ë³„ì ìœ¼ë¡œ ì‹¤í–‰

---

## ğŸ¯ í…ŒìŠ¤íŠ¸ íƒ€ì…ë³„ ì±…ì„ ë¶„ë¦¬

| íƒ€ì…                    | í™˜ê²½                  | ì±…ì„                                           | ì‹¤í–‰ ì‹œê°„ | ëª…ë ¹ì–´                              |
| ----------------------- | --------------------- | ---------------------------------------------- | --------- | ----------------------------------- |
| **Security Analysis**   | CodeQL                | ë³´ì•ˆ ì·¨ì•½ì  (XSS, ì¸ì ì…˜, prototype pollution) | ìˆ˜ì´ˆ      | `npm run codeql:check` (ë¡œì»¬, ì„ íƒ) |
| **Static Analysis**     | TS, ESLint            | íƒ€ì… ì•ˆì •ì„±, ì½”ë”© ê·œì¹™ ìœ„ë°˜                    | ìˆ˜ì´ˆ      | `npm run validate`                  |
| **Unit Tests**          | JSDOM                 | ìˆœìˆ˜ í•¨ìˆ˜, ì„œë¹„ìŠ¤, ì»´í¬ë„ŒíŠ¸ ë Œë”ë§             | 1-2ë¶„     | `npm run test:unit`                 |
| **Browser Tests**       | Vitest + Chromium     | Solid.js ë°˜ì‘ì„±, ë ˆì´ì•„ì›ƒ, Observers, í¬ì»¤ìŠ¤   | 8-10ì´ˆ    | `npm run test:browser`              |
| **Integration Tests**   | JSDOM + ëª¨í‚¹          | ë‹¤ì¤‘ ì„œë¹„ìŠ¤ í˜‘ì—…, ìƒíƒœ ë™ê¸°í™”                  | 2-5ë¶„     | `npm run test:unit` (í¬í•¨)          |
| **E2E Tests**           | Playwright            | í•µì‹¬ ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤, ë¸Œë¼ìš°ì € ì „ìš© API        | 5-15ë¶„    | `npm run e2e:smoke`                 |
| **Accessibility Tests** | Playwright + axe-core | WCAG 2.1 AA ì¤€ìˆ˜, ìƒ‰ìƒ ëŒ€ë¹„, í‚¤ë³´ë“œ íƒìƒ‰       | 3-8ë¶„     | `npm run e2e:a11y`                  |

### ì£¼ìš” íŠ¹ì§• ë° ì œì•½ì‚¬í•­

**JSDOM ì œì•½**:

- âŒ Solid.js fine-grained reactivity (signal boundary ë¯¸ìˆ˜ë¦½)
- âŒ ë ˆì´ì•„ì›ƒ ê³„ì‚° (`getBoundingClientRect()` í•­ìƒ 0)
- âŒ IntersectionObserver, ResizeObserver (ë¶€ë¶„ ëª¨í‚¹ í•„ìš”)
- âœ… ì í•©: ìˆœìˆ˜ í•¨ìˆ˜, ë°ì´í„° ë³€í™˜, ì¡°ê±´ë¶€ ë Œë”ë§, ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬

**ê°œë°œ ì „ìš© íŠ¸ë ˆì´ì‹±(Flow Tracer) í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ**:

- jsdom í™˜ê²½ì—ì„œëŠ” ìë™ ì‹œì‘ë˜ì§€ ì•Šë„ë¡ ê°€ë“œë˜ì–´ì•¼ í•¨(UA ê²€ì‚¬ ë“±)
- dev ë¹Œë“œì—ëŠ” íŠ¸ë ˆì´ì‹± ì‹¬ë³¼ì´ ì¡´ì¬, prod ë¹Œë“œì—ì„œëŠ” grep ê¸°ì¤€ ì™„ì „ ì œê±°ê°€
  í™•ì¸ë˜ì–´ì•¼ í•¨

**Browser Tests í˜„í™©** (111 tests):

- Solid.js Reactivity: 16 tests (Signal + Store + Advanced)
- Events: 8 tests (click, keyboard, delegation, preventDefault)
- Focus Management: 8 tests
- Layout APIs: 8 tests
- Animations: 9 tests
- Observers: 16 tests (MutationObserver 9 + ResizeObserver 7)
- Scroll Chaining: 43 tests
- Gallery Features: 3 tests

**E2E Tests í˜„í™©**: 82 passed / 5 skipped (94.3% í†µê³¼ìœ¨)

**Accessibility Tests í˜„í™©**: 14 tests (Gallery, Toolbar, KeyboardHelpOverlay,
Toast)

---

## ğŸ” í…ŒìŠ¤íŠ¸ ì„ íƒ ê¸°ì¤€

| ìƒí™©                                 | ì¶”ì²œ í…ŒìŠ¤íŠ¸ íƒ€ì…        |
| ------------------------------------ | ----------------------- |
| ìˆœìˆ˜ í•¨ìˆ˜, ìœ í‹¸ë¦¬í‹°, ì„œë¹„ìŠ¤ ë¡œì§     | **Unit (JSDOM)**        |
| Solid.js ë°˜ì‘ì„± (Signal/Store â†’ DOM) | **Browser**             |
| ë ˆì´ì•„ì›ƒ ê³„ì‚°, í¬ê¸°, ìœ„ì¹˜            | **Browser**             |
| ë¸Œë¼ìš°ì € API (Observers, í¬ì»¤ìŠ¤)     | **Browser**             |
| ì• ë‹ˆë©”ì´ì…˜/íŠ¸ëœì§€ì…˜                  | **Browser**             |
| ë‹¤ì¤‘ ì„œë¹„ìŠ¤ í˜‘ì—…, ìƒíƒœ ë™ê¸°í™”        | **Integration (JSDOM)** |
| í•µì‹¬ ì‚¬ìš©ì ì—¬ì •                     | **E2E**                 |
| ë¸Œë¼ìš°ì € ê°„ í˜¸í™˜ì„±                   | **E2E**                 |
| ì ‘ê·¼ì„± (ARIA, ëŒ€ë¹„, í‚¤ë³´ë“œ)          | **Accessibility**       |

---

## ğŸš€ ì‹¤í–‰ ì „ëµ

### ê°œë°œ ì¤‘ (ë¡œì»¬)

| ë‹¨ê³„ | ëª…ë ¹ì–´                                | ì†Œìš” ì‹œê°„ | ëª©ì                |
| ---- | ------------------------------------- | --------- | ------------------ |
| 1    | `npm run typecheck`                   | ìˆ˜ì´ˆ      | íƒ€ì… ê²€ì¦          |
| 2    | `npm run test:watch -- -t "í…ŒìŠ¤íŠ¸ëª…"` | ì¦‰ì‹œ      | ê´€ë ¨ í…ŒìŠ¤íŠ¸ë§Œ ì›Œì¹˜ |
| 3    | `npm run test:unit`                   | 1-2ë¶„     | ì „ì²´ ë‹¨ìœ„+í†µí•©     |
| 4    | `npm run test:fast`                   | 30ì´ˆ      | ë¹ ë¥¸ ë‹¨ìœ„+ìŠ¤ëª¨í¬   |

### Pre-Push (Git Hook)

```bash
# Husky ìë™ ì‹¤í–‰ (ê¸°ë³¸: smoke í”„ë¡œì íŠ¸, 10-20ì´ˆ)
git push

# ì „ì²´ ìŠ¤ìœ„íŠ¸ (5-10ë¶„)
export XEG_PREPUSH_SCOPE='full'
git push
```

**ë²”ìœ„ ì„ íƒ**:

| ë²”ìœ„    | ìš©ë„                | ì‹œê°„    |
| ------- | ------------------- | ------- |
| `smoke` | ê¸°ë³¸ê°’, ë¹ ë¥¸ ê²€ì¦   | 20-30ì´ˆ |
| `fast`  | ì£¼ìš” ë‹¨ìœ„ í…ŒìŠ¤íŠ¸    | 30-60ì´ˆ |
| `unit`  | ì „ì²´ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸    | 1-2ë¶„   |
| `full`  | ëª¨ë“  ê²€ì¦ (PR ê¶Œì¥) | 5-10ë¶„  |

### CI (GitHub Actions)

1. `npm run typecheck` â†’ íƒ€ì… ì²´í¬
2. `npm run lint` â†’ ESLint, stylelint, markdownlint ê²€ì¦
3. `npm test` â†’ ì „ì²´ JSDOM í…ŒìŠ¤íŠ¸ (ì»¤ë²„ë¦¬ì§€ í¬í•¨)
4. `npm run test:browser` â†’ ë¸Œë¼ìš°ì € í…ŒìŠ¤íŠ¸ (2ê°œ ìƒ¤ë“œ ë³‘ë ¬)
5. `npm run e2e:smoke` â†’ E2E ìŠ¤ëª¨í¬ í…ŒìŠ¤íŠ¸
6. `npm run e2e:a11y` â†’ ì ‘ê·¼ì„± í…ŒìŠ¤íŠ¸
7. `npm run build` â†’ dev + prod ë¹Œë“œ ê²€ì¦

**CI ìµœì í™”**:

- Node 22 ë‹¨ì¼ í™˜ê²½ (10-15ë¶„ ì ˆì•½)
- ë¸Œë¼ìš°ì € í…ŒìŠ¤íŠ¸ ìƒ¤ë”© (5ë¶„ ì ˆì•½)
- Playwright ë¸Œë¼ìš°ì € ìºì‹± (30-60ì´ˆ ì ˆì•½)
- ì˜ˆìƒ ì´ ì‹œê°„: ~8-10ë¶„

---

## ğŸ“¦ Vitest Projects

`vitest.config.ts`ì—ì„œ projectsë¡œ í…ŒìŠ¤íŠ¸ ë¶„í• :

| Project         | ë²”ìœ„                      | ì‹¤í–‰ ì‹œê°„ | ëª…ë ¹ì–´                  |
| --------------- | ------------------------- | --------- | ----------------------- |
| **smoke**       | êµ¬ì„±/í† í° ê°€ë“œ            | 10-20ì´ˆ   | `npm run test:smoke`    |
| **fast**        | ë¹ ë¥¸ ë‹¨ìœ„ (RED/ë²¤ì¹˜ ì œì™¸) | 30-60ì´ˆ   | `npm run test:fast`     |
| **unit**        | ì „ì²´ ë‹¨ìœ„                 | 1-2ë¶„     | `npm run test:unit`     |
| **browser**     | ë¸Œë¼ìš°ì € ëª¨ë“œ             | 2-5ë¶„     | `npm run test:browser`  |
| **styles**      | ìŠ¤íƒ€ì¼/í† í°/ì •ì±…          | 20-40ì´ˆ   | `npm run test:styles`   |
| **performance** | ì„±ëŠ¥/ë²¤ì¹˜ë§ˆí¬             | 40-80ì´ˆ   | `npm run test:perf`     |
| **phases**      | ë‹¨ê³„ë³„(phase-\*)          | 1-2ë¶„     | `npm run test:phases`   |
| **refactor**    | ë¦¬íŒ©í† ë§ ê°€ë“œ             | 1-2ë¶„     | `npm run test:refactor` |

---

## ğŸ¯ npm run build vs npm test

| í•­ëª©          | npm run build (ê¶Œì¥ â­)                           | npm test (ê°œë°œìš©)          |
| ------------- | ------------------------------------------------- | -------------------------- |
| **ì‹¤í–‰ ë²”ìœ„** | ì „ì²´ ê²€ì¦ íŒŒì´í”„ë¼ì¸                              | vitest projects ë¶„ë¦¬       |
| **í¬í•¨ ë‚´ìš©** | typecheck, lint, deps, CodeQL, browser, E2E, a11y | fast + raf-timing projects |
| **ì‹ ë¢°ë„**    | âœ… ë†’ìŒ (í”„ë¡œë•ì…˜ ì¤€ë¹„)                           | âš ï¸ ë‚®ìŒ (í”„ë¡œì íŠ¸ ê²©ë¦¬)    |
| **ì‹¤í–‰ ì‹œê°„** | ~8-10ë¶„                                           | ~1-2ë¶„                     |
| **ìš©ë„**      | CI, ë¦´ë¦¬ì¦ˆ ê²€ì¦                                   | ë¡œì»¬ ê°œë°œ í”¼ë“œë°±           |

### ê¶Œì¥ ì›Œí¬í”Œë¡œìš°

**ì¼ë°˜ ê°œë°œ**:

```bash
# 1ë‹¨ê³„: ê¸°ëŠ¥ ê°œë°œ ì¤‘
npm run test:watch -- -t "ê¸°ëŠ¥ëª…"  # 1-2ì´ˆ í”¼ë“œë°±

# 2ë‹¨ê³„: PR/ë¦¬ë·° ì „ ìµœì¢… ê²€ì¦
npm run build  # 8-10ë¶„, ëª¨ë“  ê²€ì¦ í¬í•¨

# 3ë‹¨ê³„: ì»¤ë°‹ ì¤€ë¹„
git push  # pre-push hook ìë™ ì‹¤í–‰
```

**ë²„ê·¸ ìˆ˜ì •**:

```bash
npm run test:fast  # 30-60ì´ˆ
npm run build      # ìµœì¢… í™•ì¸
```

**ì£¼ìš” ê¸°ëŠ¥ ì¶”ê°€**:

```bash
npm run build    # ë°˜ë“œì‹œ í†µê³¼í•´ì•¼ í•¨
```

---

## ğŸ§© ìœ ì € ìŠ¤í¬ë¦½íŠ¸ íŠ¹í™” ê°€ì´ë“œ

### ê¶Œì¥ ë¶„í¬ (ê°€ì´ë“œë¼ì¸)

```text
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚   E2E (5%)   â”‚  â† ì‹¤ì œ X.com í™˜ê²½ (Playwright ìŠ¤ëª¨í¬)
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Integration (15%) â”‚  â† ë¸Œë¼ìš°ì €/DOM ìƒí˜¸ì‘ìš© (ë¸Œë¼ìš°ì € ëª¨ë“œ í¬í•¨)
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚    Unit (60%)         â”‚  â† ìˆœìˆ˜ ë¡œì§/ì„œë¹„ìŠ¤/ìœ í‹¸ë¦¬í‹°
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  Static Analysis (20%)      â”‚  â† íƒ€ì…/ë¦°íŠ¸/ë³´ì•ˆ
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ìœ ì € ìŠ¤í¬ë¦½íŠ¸ Do & Don't

âœ… **Do**:

- ì„ íƒì ìƒìˆ˜í™”: `src/constants.ts`ì˜ `SELECTORS`/`STABLE_SELECTORS` ì‚¬ìš©
- ë¸Œë¼ìš°ì €/GM API ì¶”ìƒí™”: `@shared/external/vendors`,
  `@shared/external/userscript/adapter` getter ì‚¬ìš©
- Fail-fast: ì™¸ë¶€ DOM ë³€ê²½ ê°ì§€ ì‹œ ì¡°ê¸° ì˜ˆì™¸ + í´ë°± ê²½ë¡œ
- PC ì „ìš© ì´ë²¤íŠ¸ë§Œ ì‚¬ìš©: click, keydown/keyup, wheel, contextmenu (Touch/Pointer
  ê¸ˆì§€)

âŒ **Don't**:

- X.com DOM ì…€ë ‰í„°ë¥¼ í…ŒìŠ¤íŠ¸ì— í•˜ë“œì½”ë”© (ì¤‘ë³µ)
- GM\_\* ì§ì ‘ í˜¸ì¶œ â†’ `getUserscript()` ê²½ìœ 
- E2E ë²”ìœ„ ë¶ˆí•„ìš”í•˜ê²Œ í™•ì¥ â†’ ìŠ¤ëª¨í¬ë¡œ í•µì‹¬ë§Œ ìœ ì§€
- ì‹¤ì œ ë‹¤ìš´ë¡œë“œ í…ŒìŠ¤íŠ¸ â†’ Blob/ZIP ìƒì„±ê¹Œì§€ë§Œ

---

## ğŸ“š ì°¸ê³  ë¬¸ì„œ

- **[AGENTS.md](../AGENTS.md)**: E2E í•˜ë„¤ìŠ¤ íŒ¨í„´, Solid.js ë°˜ì‘ì„± ì œì•½ì‚¬í•­,
  Pre-push hook ë²”ìœ„ ì„¤ì •
- **[SOLID_REACTIVITY_LESSONS.md](./SOLID_REACTIVITY_LESSONS.md)**: Solid.js
  ë°˜ì‘ì„± ì‹œìŠ¤í…œ êµí›ˆ
- **[ARCHITECTURE.md](./ARCHITECTURE.md)**: 3ê³„ì¸µ êµ¬ì¡° (Features â†’ Shared â†’
  External)
- **[test/README.md](../test/README.md)**: Vitest ì‚¬ìš©ë²•, DOM ì‹œë®¬ë ˆì´ì…˜
- **[test/archive/README.md](../test/archive/README.md)**: ì•„ì¹´ì´ë¸Œ ì •ì±… ë° ê³¼ê±°
  Phase ê¸°ë¡

---

## ğŸ›¡ï¸ í”„ë¡œì íŠ¸ ìƒíƒœ ê²€ì¦

**ê°€ë“œ í…ŒìŠ¤íŠ¸** (`test/guards/project-health.test.ts`):

í”„ë¡œì íŠ¸ ìƒíƒœë¥¼ ê²€ì¦í•˜ëŠ” ìµœì†Œ ê°€ë“œ í…ŒìŠ¤íŠ¸:

- ë¹Œë“œ ìƒíƒœ: ë²ˆë“¤ í¬ê¸° 339.55 KB (ì œí•œ 420 KB) âœ…
- ì•„í‚¤í…ì²˜: 3ê³„ì¸µ êµ¬ì¡° âœ…
- ì½”ë”© ê·œì¹™: Vendor getter, PC ì´ë²¤íŠ¸, ë””ìì¸ í† í° âœ…
- í…ŒìŠ¤íŠ¸ êµ¬ì¡°: í•„ìˆ˜ í´ë” ë° íŒŒì¼ âœ…
- ì„œë¹„ìŠ¤ í‘œì¤€í™”: ë¡œê¹… ì ‘ë‘ì‚¬ [ServiceName] âœ…
- íšŒê·€ ë°©ì§€: ê°‘ì‘ìŠ¤ëŸ¬ìš´ ë²ˆë“¤ í¬ê¸° ì¦ê°€ ê°ì§€ âœ…

**í…ŒìŠ¤íŠ¸ ì•„ì¹´ì´ë¸Œ** (`test/archive/`):

ì™„ë£Œëœ Phase ë° ê³¼ê±° ê°œë°œ ë‹¨ê³„ì˜ í…ŒìŠ¤íŠ¸ ë³´ê´€:

- cleanup-phases/: Phase 1~7 ì •ë¦¬ í…ŒìŠ¤íŠ¸
- integration-behavioral/: ê³¼ê±° í–‰ìœ„ ê²€ì¦ í…ŒìŠ¤íŠ¸
- integration/: test/integration ì•„ì¹´ì´ë¸Œ (Phase 171B)

ìƒì„¸: [test/archive/README.md](../test/archive/README.md)

---

> **í…ŒìŠ¤íŠ¸ ì •ì±…**: ìƒˆ ê¸°ëŠ¥ì€ ë°˜ë“œì‹œ í…ŒìŠ¤íŠ¸ì™€ í•¨ê»˜ ì œì¶œ. TDD ê¶Œì¥ (RED â†’ GREEN â†’
> REFACTOR).
>
> **í˜„ì¬ ìƒíƒœ**: 1389 ë‹¨ìœ„ í…ŒìŠ¤íŠ¸, 111 ë¸Œë¼ìš°ì € í…ŒìŠ¤íŠ¸, 82 E2E í…ŒìŠ¤íŠ¸, 14 ì ‘ê·¼ì„±
> í…ŒìŠ¤íŠ¸ (100% í†µê³¼ìœ¨) âœ…
>
> **ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-10-29 (Phase 234 ê°„ì†Œí™”: 517ì¤„ â†’ 192ì¤„, 63% ê°ì†Œ)

---

## ğŸ§­ X.com (Twitter) DOM/API ë³€í™” ë°˜ì˜ ì •ì±… â€” 2025-11

ìµœì‹  X.com ë³€ê²½ì— ëŒ€í•œ ë‚´ì„±ì„ ê°•í™”í•˜ê¸° ìœ„í•´ ë‹¤ìŒ ì›ì¹™ê³¼ í…ŒìŠ¤íŠ¸ë¥¼ ìœ ì§€í•©ë‹ˆë‹¤.

- DOM ì…€ë ‰í„° ë‚´ì„±
  - íƒ€ì„ë¼ì¸ ìŠ¤í¬ë¡¤ ì»¨í…Œì´ë„ˆ ì ‘ê·¼ì€ ë‹¨ì¼ data-testid ì˜ì¡´ì„ ê¸ˆì§€í•˜ê³  ìš°ì„ ìˆœìœ„
    í´ë°±ì„ ì‚¬ìš©í•©ë‹ˆë‹¤:
    1. `[data-testid="primaryColumn"]` â†’ 2) `main[role="main"]` â†’ 3)
       `.css-1dbjc4n[data-at-shortcutkeys]` â†’ 4) `body`.
  - ìœ ë‹› í…ŒìŠ¤íŠ¸ë¡œ í´ë°± ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ê³ ì •í•©ë‹ˆë‹¤: `primaryColumn` ë¶€ì¬ ì‹œì—ë„
    `main[role='main']` ê²½ë¡œë¡œ ì €ì¥/ë³µì›ì´ ë™ì‘í•´ì•¼ í•©ë‹ˆë‹¤.

- API í† í°/í—¤ë” ë‚´ì„±
  - `gt` ì¿ í‚¤ê°€ ì—†ìœ¼ë©´ `https://api.twitter.com/1.1/guest/activate.json` í˜¸ì¶œë¡œ
    ê²ŒìŠ¤íŠ¸ í† í°ì„ í™œì„±í™”í•˜ê³ , GraphQL ìš”ì²­ì— `x-guest-token` í—¤ë”ë¥¼ ì²¨ë¶€í•©ë‹ˆë‹¤.
  - í™˜ê²½ì— ë”°ë¼ `x-csrf-token`ì´ ë¹ˆ ê°’ì¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, í…ŒìŠ¤íŠ¸ëŠ” í—ˆìš© ë²”ìœ„(ë¹ˆ
    ë¬¸ìì—´/undefined)ë¥¼ ì¸ì •í•©ë‹ˆë‹¤.
  - GraphQL Query IDëŠ” ë³€ê²½ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ë„¤íŠ¸ì›Œí¬ ëª¨í‚¹ ê¸°ë°˜ í…ŒìŠ¤íŠ¸ëŠ” ID ìƒìˆ˜
    ê°’ì— ê³¼ë„í•˜ê²Œ ì˜ì¡´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

ê´€ë ¨ í…ŒìŠ¤íŠ¸:

- `test/unit/shared/utils/twitter-scroll-preservation.test.ts`
  - "Fallback selector behavior" ì„¹ì…˜: `primaryColumn` ë¶€ì¬ ì‹œ
    `main[role='main']` í´ë°± ë™ì‘ ê²€ì¦
- `test/unit/shared/services/media/twitter-video-extractor.test.ts`
  - "TwitterAPI auth/header formation" ì„¹ì…˜: ê²ŒìŠ¤íŠ¸ í† í° í™œì„±í™” í´ë°± ë° í—¤ë”
    êµ¬ì„± ê²€ì¦
