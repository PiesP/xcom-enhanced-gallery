/**
 * @fileoverview CSS Cascade Layers 정의
 * @description CSS 스타일 우선순위 계층 구조 정의
 * @version 1.0.0
 */

/**
 * CSS Cascade Layers 순서 정의
 *
 * Layer 우선순위 (낮음 → 높음):
 * 1. reset - CSS 리셋
 * 2. tokens - 디자인 토큰
 * 3. base - 기본 스타일
 * 4. layout - 레이아웃 컴포넌트
 * 5. components - UI 컴포넌트
 * 6. gallery - 갤러리 전용 스타일 (Light DOM 전환 후 추가)
 * 7. utilities - 유틸리티 클래스
 * 8. overrides - 긴급 오버라이드
 */
@layer reset, tokens, base, layout, components, gallery, utilities, overrides;

/**
 * Reset Layer - 브라우저 기본 스타일 초기화
 */
@layer reset {
  @import url('./reset.css');
}

/**
 * Tokens Layer - 디자인 토큰 시스템
 */
@layer tokens {
  @import url('./design-tokens.css');
}

/**
 * Base Layer - 기본 HTML 요소 스타일
 */
@layer base {
  @import url('../assets/styles/base/reset.css');
}

/**
 * Layout Layer - 레이아웃 관련 스타일
 */
@layer layout {
  /* 갤러리 전체 레이아웃 */
  .xeg-gallery-layout {
    display: grid;
    grid-template-areas:
      'toolbar'
      'content'
      'controls';
    grid-template-rows: auto 1fr auto;
    height: 100vh;
    width: 100vw;
  }

  .xeg-gallery-toolbar {
    grid-area: toolbar;
  }

  .xeg-gallery-content {
    grid-area: content;
    overflow: clip;
  }

  .xeg-gallery-controls {
    grid-area: controls;
  }
}

/**
 * Components Layer - UI 컴포넌트 스타일
 * CSS Modules로 관리되는 컴포넌트들이 이 레이어에 속함
 */
@layer components {
  /* CSS Modules 컴포넌트들은 빌드 시 자동으로 이 레이어에 포함 */
}

/**
 * Gallery Layer - 갤러리 전용 스타일
 * Shadow DOM에서 Light DOM 전환을 위한 스타일 격리
 * components보다 높은 우선순위로 Twitter UI와의 충돌 방지
 */
@layer gallery {
  /* 갤러리 루트 컨테이너 */
  .xeg-gallery-root {
    /* Twitter 스타일과 격리를 위한 기본 리셋 */
    all: initial;

    /* 고정 위치 오버레이 */
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;

    /* 최상위 레이어 */
    z-index: var(--xeg-z-gallery, 9999);

    /* 스타일 격리 */
    isolation: isolate;
    contain: layout style paint;

    /* 기본 폰트 복원 */
    font-family:
      system-ui,
      -apple-system,
      BlinkMacSystemFont,
      'Segoe UI',
      Roboto,
      Oxygen,
      Ubuntu,
      Cantarell,
      'Open Sans',
      'Helvetica Neue',
      sans-serif;
    font-size: 1rem; /* 16px */
    line-height: 1.5;

    /* 박스 모델 */
    box-sizing: border-box;
  }

  .xeg-gallery-root *,
  .xeg-gallery-root *::before,
  .xeg-gallery-root *::after {
    box-sizing: border-box;
  }

  /* 갤러리 전역 스타일은 gallery-global.css에서 관리 */
  /* import는 Vite 빌드 시점에 처리됨 */
}

/**
 * Utilities Layer - 유틸리티 클래스
 */
@layer utilities {
  /* 기존 design-tokens.css의 유틸리티 클래스들을 이곳으로 이동 예정 */
  .xeg-sr-only {
    position: absolute !important;
    width: 0.0625rem !important; /* 1px */
    height: 0.0625rem !important; /* 1px */
    padding: 0 !important;
    margin: -0.0625rem !important; /* -1px */
    overflow: clip !important;
    clip: rect(0, 0, 0, 0) !important;
    white-space: nowrap !important;
    border: 0 !important;
  }

  .xeg-visually-hidden {
    clip: rect(0 0 0 0);
    clip-path: inset(50%);
    height: 0.0625rem; /* 1px */
    overflow: clip;
    position: absolute;
    white-space: nowrap;
    width: 0.0625rem; /* 1px */
  }

  .xeg-focus-visible {
    outline: 0.125rem solid var(--xeg-color-primary); /* 2px */
    outline-offset: 0.125rem; /* 2px */
  }
}

/**
 * Overrides Layer - 긴급 상황을 위한 오버라이드
 */
@layer overrides {
  /* 외부 스타일 시스템과의 충돌 해결을 위한 긴급 오버라이드 */
  .xeg-important-reset {
    all: unset !important;
  }

  /* 트위터 UI와의 격리를 위한 오버라이드 */
  .xeg-isolated {
    isolation: isolate !important;
    contain: layout style paint !important;
  }
}
