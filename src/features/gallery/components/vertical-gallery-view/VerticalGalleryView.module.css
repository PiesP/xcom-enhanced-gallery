/**
 * VerticalGalleryView Component Styles
 * @version 5.0.0 - Phase 2: 최신 CSS 기능 ?�전 ?�합
 *
 * @description
 * Phase 2?�서 ?��???CSS 기능???�전???�합???�직 갤러�?�?컴포?�트.
 * CSS Cascade Layers, OKLCH ?�상, Container Queries, CSS Subgrid, CSS Containment ?�용.
 *
 * @features
 * - CSS Cascade Layers�??��????�선?�위 명확?? * - OKLCH ?�상 공간?�로 ?��????�상 ?�스?? * - Container Queries�?진정??컴포?�트 기반 반응???�자?? * - CSS Subgrid�?고급 ?�이?�웃 구현
 * - CSS Containment�??�더�??�능 최적?? * - CSS Logical Properties�?�?��??지?? * - 고급 CSS ?�택??(:has, :where, :is) ?�용
 * - CSS Nesting?�로 가?�성 ?�상
 */

/* CSS Cascade Layer ?�의 */
@layer base, components, utilities;

/* 컨테?�너 ?�정 - ?�직 갤러�??�용 컨테?�너 */
.xegVerticalGalleryContainer {
  container-type: size;
  container-name: vertical-gallery;

  /* CSS Containment�??�능 최적?? */
  contain: layout style paint;
  content-visibility: auto;
  contain-intrinsic-size: 100vw 100vh;
}

@layer base {
  :root {
    /* ?�능 최적??변?? */
    --xeg-vertical-gpu-acceleration: translateZ(0);

    /* Container Query 지??감�? */
    --supports-container-queries: 1;
  }
}

@layer components {
  /* 공통 CSS 변???�의 - OKLCH ?�상 ?�스???�용 */
  :root {
    /* ?�랜지??- 최신 easing ?�수 ?�용 */
    --xeg-transition-fast:
      transform var(--xeg-duration-fast) var(--xeg-easing-ease-out),
      opacity var(--xeg-duration-fast) var(--xeg-easing-ease-out);
    --xeg-transition-normal:
      transform var(--xeg-duration-fade) var(--xeg-easing-ease-in-out),
      opacity var(--xeg-duration-fade) var(--xeg-easing-ease-in-out);
    --xeg-transition-smooth: transform var(--xeg-duration-slow) var(--xeg-easing-ease-out);
    --xeg-transition-toolbar:
      opacity var(--xeg-duration-toolbar) var(--xeg-easing-ease-out),
      transform var(--xeg-duration-toolbar) var(--xeg-easing-ease-out), visibility 0ms;

    /* ?�페?�싱 - CSS Logical Properties ?�용 */
    --xeg-spacing-gallery: clamp(var(--xeg-spacing-sm), 2.5vw, var(--xeg-spacing-lg));
    --xeg-spacing-mobile: clamp(var(--xeg-spacing-xs), 2vw, var(--xeg-spacing-md));
    --xeg-spacing-compact: clamp(0.25rem, 1.5vw, var(--xeg-spacing-sm));

    /* ?�이?�웃 */
    --xeg-toolbar-height: clamp(3.75rem, 10vh, 5rem);

    /* 블러 ?�과 */
    --xeg-backdrop-blur: 0.5rem;
  }
}

/* 메인 컨테?�너 - ?�순?�된 갤러�?컨테?�너 */
.container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: var(--xeg-z-gallery, 10000);
  background: var(--xeg-gallery-bg);

  /* 기본 ?�이?�웃 */
  display: flex;
  flex-direction: column;

  /* 블러 ?�과 */
  backdrop-filter: none;
  -webkit-backdrop-filter: none;

  /* ?�드?�어 가??최적?? */
  transform: translateZ(0);
  will-change: opacity, transform;
  contain: layout style paint;

  /* 초기 ?�태 */
  opacity: 1;
  visibility: visible;
  transition: var(--xeg-transition-normal);

  /* ?�벤??처리 - ?�크�??�벤?�는 ??�� ?�용 */
  cursor: default;
  pointer-events: auto;

  /* 컨테?�너 쿼리 ?�성?? */
  container-type: size;
  container-name: gallery-container;

  /* ?�크�?최적?? */
  scroll-behavior: smooth;
  overscroll-behavior: none; /* ?�크�?체이??방�? */

  /* 갤러�??��? ?�크롤만 ?�용 */

  /* ?�로?�션 빌드 ?�환?�을 ?�해 CSS 커스?� ?�로?�티 ?�거 */
}

/* ?�바 ?�퍼 - 기본 가?�성 보장 �?개선???�랜지?? */
.toolbarWrapper {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: auto;
  z-index: var(--xeg-z-modal);

  /* 기본 ?�태: CSS 변?�로 ?�어?�는 ?��? ?�태 */
  opacity: var(--toolbar-opacity, 0);
  visibility: var(--toolbar-visibility, hidden);
  display: block;
  transition: var(--xeg-transition-toolbar);
  will-change: transform, opacity, visibility;
  contain: layout style;

  /* 즉시 반응???�한 추�? 최적?? */
  transform: translateZ(0); /* GPU 가???�성?? */
  backface-visibility: hidden; /* ?�더�?최적?? */

  /* 툴바 전체에서 클릭 가능하도록 설정 */
  pointer-events: var(--toolbar-pointer-events, none);

  /* 그라디언트 배경 - oklch 기반 */
  background: linear-gradient(
    to bottom,
    oklch(0% 0 0deg / 80%) 0%,
    oklch(0% 0 0deg / 40%) 70%,
    transparent 100%
  );
  padding-block-end: var(--xeg-spacing-gallery);
}

/* ?�바 ?�체 ?�버 ?�에???�시 ?��? - 강화??가?�성 */
.toolbarWrapper:hover {
  --toolbar-opacity: 1;
  --toolbar-visibility: visible;
  --toolbar-pointer-events: auto;
  --toolbar-transform-y: 0;
}

/* ?�근?? ?�커???�에???�바 ?�시 - ??강력??보장 */
.toolbarWrapper:focus-within {
  --toolbar-opacity: 1;
  --toolbar-visibility: visible;
  --toolbar-pointer-events: auto;
  --toolbar-transform-y: 0;
  /* ?�커???�에????빠른 ?�랜지?? */
  transition: var(--xeg-transition-fast);
}

/* ?�바 ?��? 모든 ?�소 ?�릭 보장 */
.toolbarWrapper * {
  pointer-events: inherit;
}

/* UI ?��? ?�태 - ?�크�??�벤?�는 ?��??�되 ?�각???�소�??��? */
.container.uiHidden {
  /* UI???�기지�??�크�??�벤?�는 차단?��? ?�음 */
  cursor: none;
  /* pointer-events: none; ?�거 - ?�크�?차단 방�? */
}

/* 모든 ?�위 ?�소???�벤???�파 최적?? */
.container * {
  pointer-events: auto;
}

/* ?�이??컨테?�너 - ?�이?�브 ?�크롤만 ?�용 */
.itemsContainer {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: auto; /* 갤러�??��? ?�크롤만 ?�용 */
  position: relative;

  /* ?�능 최적?? */
  contain: layout style;
  transform: translateZ(0);

  /* ?�크�??�벤?? */
  scrollbar-gutter: stable;
  scroll-snap-type: y proximity;
  pointer-events: auto;

  /* 컨테?�너 쿼리 */
  container-type: size;
  container-name: items-list;
}

/* ?�킷 ?�크롤바 ?��??? */
.itemsContainer::-webkit-scrollbar {
  width: var(--xeg-scrollbar-width); /* 0.5rem�??�큰?�로 교체 */
}

.itemsContainer::-webkit-scrollbar-track {
  background: transparent;
}

.itemsContainer::-webkit-scrollbar-thumb {
  background: var(--xeg-color-neutral-300);
  border-radius: var(--xeg-scrollbar-border-radius); /* 0.25rem�??�큰?�로 교체 */
  transition: background-color var(--xeg-duration-normal) var(--xeg-ease-standard);
}

.itemsContainer::-webkit-scrollbar-thumb:hover {
  background: var(--xeg-color-neutral-400);
}

.container.uiHidden .toolbarWrapper,
.container.uiHidden .content > *:not([data-xeg-role='items-list']) {
  /* 개별 UI ?�소�??�벤??차단 */
  pointer-events: none;
  opacity: 0;
  transition: opacity var(--xeg-duration-fast) var(--xeg-easing-ease-out);
}

/* ?�크�?가?�한 콘텐�??�역?� ??�� ?�벤???�용 */
.container.uiHidden [data-xeg-role='items-list'],
.container.uiHidden .itemsContainer {
  pointer-events: auto;
}

/* ?�태�?최적?? */
.container.visible {
  opacity: 1;
  transform: scale3d(1, 1, 1);
}

.container.empty {
  justify-content: center;
  align-items: center;
}

/* 갤러리 아이템 기본 스타일 - 앵커형 스크롤에 최적화 */
.galleryItem {
  position: relative;
  margin-bottom: var(--xeg-spacing-md, 1rem); /* 16px = 1rem */
  border-radius: var(--xeg-radius-lg, 0.5rem);
  transition: var(--xeg-transition-normal); /* 앵커형 변단 렬 */

  /* 성능 최적화 */
  contain: layout style;
  transform: translateZ(0);

  /* 스크롤 스냅 */
  scroll-snap-align: start;
  scroll-margin-top: var(--xeg-spacing-sm);
}

/* ?�커?�된 ?�이??강조 - 2�??�두�?방�?�??�해 ?�니메이���거 */
.itemActive {
  position: relative;
  z-index: 1;
  /* 기존 itemActive::before ?�니메이???�거�?2�??�두�?방�? */
}

/* focusGlow ?�니메이???�거 - 2�??�두�?방�? */

.container:has(.itemActive) {
  /* ?�성 ?�이?�이 ?�을 ?? */
  --has-active-item: 1;
}

.container:has(.toolbarWrapper:hover) {
  /* ?�바 ?�버 ??컨테?�너 ?�태 변�? */
  --toolbar-interaction: 1;
}

/* ?�립?�인 ?�단 ?�버 감�? ?�역 - ?�장??감�? ?�역 */
.toolbarHoverZone {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: var(--xeg-hover-zone-height); /* 120px�??�큰?�로 교체 */
  z-index: calc(var(--xeg-z-modal) - 1); /* ?�바보다 ??? z-index */
  background: transparent;
  pointer-events: auto; /* ?�버 감�?�??�해 ?�벤???�용 */
}

/* ?�버 감�?�??�한 기본 ?��???- ?�로?�션 빌드 ?�환??개선 */
.toolbarHoverZone:hover {
  /* ?�버 ?�태 ?�시�??�한 ?��? ?�성 */
  z-index: calc(var(--xeg-z-modal) - 1);
}

/* Settings panel expanded: prevent hover zone from intercepting clicks
   - When the toolbar settings are expanded ([data-settings-expanded='true'] on Toolbar),
     the fixed hover zone could overlay the panel and block clicks.
   - Use :has() to detect expanded state within the container and disable pointer events.
*/
.container:has([data-settings-expanded='true']) .toolbarHoverZone {
  pointer-events: none;
}

/* ?�바가 ?�시???�태?�서???�버 ?�역 ?�전??비활?�화 (설??메뉴??열린 경우 제외) */
.container.initialToolbarVisible:not([data-settings-expanded='true']) .toolbarHoverZone,
.container:has(.toolbarWrapper:hover):not([data-settings-expanded='true']) .toolbarHoverZone {
  pointer-events: none;
}

/* :has() 미�???브라?��?�??�한 ?�?? */
@supports not (selector(:has(*))) {
  .toolbarWrapper:hover ~ .toolbarHoverZone {
    pointer-events: none;
  }
}

/* ?�바 ?�버 ?�리�??�역??마우?��? ?�라갔을 ???�바 ?�시 */
.toolbarHoverTrigger:hover + .toolbarWrapper {
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;

  --toolbar-opacity: 1;
  --toolbar-pointer-events: auto;
}

/* ?�버 ??부�?컨테?�너??CSS 변???�정 - 강화??가?�성 */
.container.initialToolbarVisible .toolbarWrapper,
.container:has(.toolbarHoverZone:hover) .toolbarWrapper {
  --toolbar-opacity: 1;
  --toolbar-visibility: visible;
  --toolbar-pointer-events: auto;
  --toolbar-transform-y: 0;
}

/* :has() 지?�하지 ?�는 브라?��?�??�한 ?�??- ?�로?�션 빌드 ?�환??개선 */
@supports not (selector(:has(*))) {
  /* ?�버 ?�리�??�역 ?�버 ??직접 ?�제 ?�소???�바 ?�퍼???�용 */
  .toolbarHoverZone:hover + .toolbarWrapper {
    --toolbar-opacity: 1;
    --toolbar-visibility: visible;
    --toolbar-pointer-events: auto;
    --toolbar-transform-y: 0;
  }

  /* 추�? ?�?? ?�반 ?�제 ?�택???�용 */
  .toolbarHoverZone:hover ~ .toolbarWrapper {
    --toolbar-opacity: 1;
    --toolbar-visibility: visible;
    --toolbar-pointer-events: auto;
    --toolbar-transform-y: 0;
  }

  /* ??견고???�?? 부�??�버 */
  .container:hover .toolbarWrapper {
    --toolbar-opacity: 1;
    --toolbar-visibility: visible;
    --toolbar-pointer-events: auto;
    --toolbar-transform-y: 0;
  }
}

/* 갤러�??�바 컴포?�트 ?�체??가?�성 보장 */
.toolbarWrapper [class*='galleryToolbar'],
.toolbarWrapper [data-testid*='toolbar'] {
  opacity: var(--toolbar-opacity, 0);
  visibility: var(--toolbar-visibility, hidden);
  display: flex;
  pointer-events: var(--toolbar-pointer-events, none);
}

/* ?�바 버튼???�벤???�파 방�? �??�릭 보장 */
.toolbarWrapper button,
.toolbarWrapper [role='button'],
.toolbarWrapper .toolbarButton {
  pointer-events: auto;
  position: relative;
  z-index: 10;
}

/* 콘텐�??�역 - 컨테?�너 쿼리 지?�과 ?�체 ?�면 ?�용 */
.content {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: clip;
  position: relative;
  /* ?�바 ?�역 ?�거 - ?�재 ?�체 ?�면 ?�용 */

  /* ?�능 최적?? */
  contain: layout style;
  transform: translateZ(0);

  /* ?�벤???�파 */
  pointer-events: auto;

  /* 컨테?�너 쿼리 */
  container-type: size;
  container-name: content-area;
}

/* ?�니메이??- GPU 가?? */
.fadeInOut {
  animation: fadeInOut var(--xeg-duration-normal) var(--xeg-easing-ease-out);
}

@keyframes fadeInOut {
  0% {
    opacity: 0;
    transform: var(--xeg-transform-translate-up) var(--xeg-transform-scale-down);
  }
  100% {
    opacity: 1;
    transform: var(--xeg-transform-translate-center) var(--xeg-transform-scale-normal);
  }
}

/* �??�태 메시지 - ?�합???�?�포그래?? */
.emptyMessage {
  text-align: center;
  color: var(--xeg-color-text-secondary);
  max-inline-size: min(25rem, 90vw); /* 400px = 25rem */
  padding: clamp(1.875rem, 5vw, 2.5rem); /* 30px-40px = 1.875rem-2.5rem */
}

.emptyMessage h3 {
  margin: 0 0 clamp(0.75rem, 2vw, 1rem); /* 10.125rem-16px = 0.75rem-1rem */
  font-size: clamp(1.25rem, 4vw, 1.5rem); /* 20px-20.25rem = 1.25rem-1.5rem */
  font-weight: 600;
  color: var(--xeg-color-text-primary);
  line-height: 1.2;
}

.emptyMessage p {
  margin: 0;
  font-size: clamp(0.875rem, 2.5vw, 1rem); /* 10.25rem-16px = 0.875rem-1rem */
  line-height: 1.5;
  color: var(--xeg-color-text-tertiary);
}
/* 컨테?�너 쿼리 기반 반응???�자?? */
@container gallery-container (max-width: 48rem) {
  .itemsContainer {
    padding: var(--xeg-spacing-mobile);
    gap: var(--xeg-spacing-mobile);
  }

  .toolbarWrapper {
    padding-block-end: var(--xeg-spacing-mobile);
  }
}

@container gallery-container (max-width: 30rem) {
  .itemsContainer {
    padding: var(--xeg-spacing-compact);
    gap: var(--xeg-spacing-compact);
  }
}

/* 기존 미디??쿼리??컨테?�너 쿼리 지?�이 ?�는 브라?��?�??�한 ?�백 */
@media (width <= 760.5rem) {
  .itemsContainer {
    padding: var(--xeg-spacing-mobile);
    gap: var(--xeg-spacing-mobile);
  }

  .toolbarWrapper {
    padding-block-end: var(--xeg-spacing-mobile);
  }
}

@media (width <= 45rem) {
  .itemsContainer {
    padding: var(--xeg-spacing-compact);
    gap: var(--xeg-spacing-compact);
  }
}
/* ?�근??- 고�?�?모드 지?? */
@media (prefers-contrast: high) {
  .itemActive::before {
    border-color: HighlightText;
    box-shadow: var(--shadow-md);
  }

  .container {
    background: Canvas;
    color: CanvasText;
  }

  .toolbarWrapper {
    background: linear-gradient(
      to bottom,
      Canvas 0%,
      color-mix(in sRGB, Canvas 80%, transparent) 70%,
      transparent 100%
    );
  }
}

/* 접근성 - 모션 감소 지원 */
@media (prefers-reduced-motion: reduce) {
  .itemsContainer {
    scroll-behavior: auto;
    will-change: auto;
    transform: none;
  }
}

/* ?�이??모드 ?�호??지?? */
@media (prefers-color-scheme: light) {
  .container {
    background: color-mix(in sRGB, white 95%, transparent);
  }
}

/* �??�태 버튼 ?��??? */
.emptyButton {
  margin-top: 1rem;
}

/* N1: ?�합 ToastContainer ?�용?�로 로컬 toastContainer ?�거?? */

/* 감소??모션 ?�용?��? ?�한 지??- 개선???�근?? */
@media (prefers-reduced-motion: reduce) {
  .toolbarWrapper {
    transition: opacity var(--xeg-duration-fast) var(--xeg-easing-ease-out);
    transform: translateY(-100%); /* Y�??�동�??�거 */
  }

  .toolbarWrapper:hover,
  .toolbarWrapper:focus-within {
    transform: translateY(0); /* ?�순??Y�??�동�? */
    transition: opacity var(--xeg-duration-toolbar) var(--xeg-easing-ease-out);
  }

  /* 컨테?�너 ?�벨?�서??모션 감소 */
  .container {
    transition: opacity var(--xeg-duration-normal) var(--xeg-easing-ease-out);
  }

  /* 모든 ?�니메이???�거 */
  .fadeInOut {
    animation: none;
  }
}

/* 고�?�?모드 지??- ?�상??가?�성 */
@media (prefers-contrast: high) {
  .toolbarWrapper {
    background: var(--xeg-color-overlay-dark); /* var(--color-overlay-backdrop)�??�큰?�로 교체 */
    border: 0.125rem solid white;
    border-radius: var(--xeg-scrollbar-border-radius); /* 0.25rem�??�큰?�로 교체 */
    margin: var(--xeg-gap-xs); /* 0.25rem�??�큰?�로 교체 */
  }

  /* 고�?�?모드?�서 ?�버 ?�역 ?�각?? */
  .toolbarHoverZone:hover {
    background: var(--xeg-color-overlay-subtle); /* var(--color-overlay-light)�??�큰?�로 교체 */
  }
}

/* ?�바 ?�버 ?�리�??�역 */
.toolbarHoverTrigger {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: var(--xeg-hover-zone-height); /* ?�장???�버 ?�역 */
  z-index: calc(var(--xeg-z-modal) - 1);
  pointer-events: auto;
  background: transparent;
}

/* ?�바 ?�체 ?�버 ?�에???�시 ?��? */
.container [class*='galleryToolbar']:hover {
  --toolbar-opacity: 1;
  --toolbar-pointer-events: auto;
}

/* 브라?��? ?�환?�을 ?�한 ?��?방법 */
@supports not (selector(:hover + *)) {
  .container:hover [class*='galleryToolbar'] {
    --toolbar-opacity: 1;
    --toolbar-pointer-events: auto;
  }
}
